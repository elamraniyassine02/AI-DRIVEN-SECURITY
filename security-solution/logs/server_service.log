2025-05-23 11:09:55,550 - __main__ - INFO - Starting server services...
2025-05-23 11:09:55,668 - __main__ - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 11:09:55,669 - __main__ - INFO - Starting anomaly detection service...
2025-05-23 11:09:57,079 - __main__ - INFO - Anomaly detection service started
2025-05-23 11:09:57,080 - __main__ - INFO - Starting risk scoring service...
2025-05-23 11:09:57,080 - anomaly_detection - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 11:09:57,080 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 11:09:57,080 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 11:09:57,086 - __main__ - INFO - Risk scoring service started
2025-05-23 11:09:57,086 - __main__ - INFO - All services started successfully
2025-05-23 11:09:57,087 - risk_scoring - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 11:09:57,087 - risk_scoring - INFO - Loading asset criticality from config/asset_criticality.json
2025-05-23 11:09:57,087 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 11:09:57,087 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 11:09:57,156 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:404 duration:0.002s]
2025-05-23 11:09:57,156 - risk_scoring - ERROR - Error loading anomalies from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-anomalies]', security-anomalies, index_or_alias)
2025-05-23 11:09:57,158 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 11:09:57,163 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 11:09:57,163 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 11:09:57,164 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 11:09:57,169 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:404 duration:0.001s]
2025-05-23 11:09:57,169 - risk_scoring - ERROR - Error loading compliance issues from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-compliance]', security-compliance, index_or_alias)
2025-05-23 11:09:57,170 - risk_scoring - INFO - Calculating risk scores
2025-05-23 11:09:57,170 - risk_scoring - WARNING - No assets found for risk scoring
2025-05-23 11:09:57,170 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 11:09:57,189 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.108s]
2025-05-23 11:09:57,527 - anomaly_detection - INFO - Loaded 5524 records from Elasticsearch
2025-05-23 11:09:57,585 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 11:09:57,687 - anomaly_detection - INFO - Detected 275 anomalies
2025-05-23 11:09:57,697 - anomaly_detection - INFO - Indexing 275 anomalies to security-anomalies
2025-05-23 11:09:57,820 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.104s]
2025-05-23 11:09:57,822 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:09:57,822 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 11:09:57,951 - anomaly_detection - INFO - Detected 275 anomalies
2025-05-23 11:09:57,951 - anomaly_detection - INFO - Indexing 275 anomalies to security-anomalies
2025-05-23 11:09:57,977 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 11:09:57,978 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:09:57,978 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 11:14:58,077 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 11:14:58,077 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 11:14:58,146 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.069s]
2025-05-23 11:14:58,437 - anomaly_detection - INFO - Loaded 6049 records from Elasticsearch
2025-05-23 11:14:58,496 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 11:14:58,592 - anomaly_detection - INFO - Detected 296 anomalies
2025-05-23 11:14:58,602 - anomaly_detection - INFO - Indexing 296 anomalies to security-anomalies
2025-05-23 11:14:58,629 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 11:14:58,630 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:14:58,630 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 11:14:58,767 - anomaly_detection - INFO - Detected 303 anomalies
2025-05-23 11:14:58,768 - anomaly_detection - INFO - Indexing 303 anomalies to security-anomalies
2025-05-23 11:14:58,793 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 11:14:58,794 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:14:58,794 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 11:19:58,885 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 11:19:58,886 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 11:19:58,993 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.107s]
2025-05-23 11:19:59,277 - anomaly_detection - INFO - Loaded 6066 records from Elasticsearch
2025-05-23 11:19:59,339 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 11:19:59,440 - anomaly_detection - INFO - Detected 297 anomalies
2025-05-23 11:19:59,451 - anomaly_detection - INFO - Indexing 297 anomalies to security-anomalies
2025-05-23 11:19:59,478 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 11:19:59,478 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:19:59,479 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 11:19:59,628 - anomaly_detection - INFO - Detected 304 anomalies
2025-05-23 11:19:59,629 - anomaly_detection - INFO - Indexing 304 anomalies to security-anomalies
2025-05-23 11:19:59,656 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 11:19:59,657 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:19:59,658 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 11:24:57,269 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 11:24:57,269 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 11:24:57,287 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.013s]
2025-05-23 11:24:57,295 - risk_scoring - INFO - Loaded 3552 anomalies from Elasticsearch
2025-05-23 11:24:57,305 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 11:24:57,308 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 11:24:57,309 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 11:24:57,309 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 11:24:57,312 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:404 duration:0.001s]
2025-05-23 11:24:57,312 - risk_scoring - ERROR - Error loading compliance issues from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-compliance]', security-compliance, index_or_alias)
2025-05-23 11:24:57,312 - risk_scoring - INFO - Calculating risk scores
2025-05-23 11:24:57,313 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-05-23 11:24:57,314 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-05-23 11:24:57,401 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.087s]
2025-05-23 11:24:57,402 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-05-23 11:24:57,402 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 11:24:59,756 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 11:24:59,757 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 11:24:59,856 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.099s]
2025-05-23 11:25:00,139 - anomaly_detection - INFO - Loaded 6058 records from Elasticsearch
2025-05-23 11:25:00,205 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 11:25:00,305 - anomaly_detection - INFO - Detected 302 anomalies
2025-05-23 11:25:00,315 - anomaly_detection - INFO - Indexing 302 anomalies to security-anomalies
2025-05-23 11:25:00,345 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-05-23 11:25:00,346 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:25:00,346 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 11:25:00,491 - anomaly_detection - INFO - Detected 303 anomalies
2025-05-23 11:25:00,491 - anomaly_detection - INFO - Indexing 303 anomalies to security-anomalies
2025-05-23 11:25:00,517 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 11:25:00,518 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:25:00,518 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 11:30:00,615 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 11:30:00,615 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 11:30:00,729 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.114s]
2025-05-23 11:30:01,007 - anomaly_detection - INFO - Loaded 6075 records from Elasticsearch
2025-05-23 11:30:01,072 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 11:30:01,171 - anomaly_detection - INFO - Detected 302 anomalies
2025-05-23 11:30:01,182 - anomaly_detection - INFO - Indexing 302 anomalies to security-anomalies
2025-05-23 11:30:01,213 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-05-23 11:30:01,213 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:30:01,214 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 11:30:01,357 - anomaly_detection - INFO - Detected 304 anomalies
2025-05-23 11:30:01,357 - anomaly_detection - INFO - Indexing 304 anomalies to security-anomalies
2025-05-23 11:30:01,385 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 11:30:01,386 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:30:01,386 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 11:35:01,485 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 11:35:01,485 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 11:35:01,710 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.224s]
2025-05-23 11:35:01,980 - anomaly_detection - INFO - Loaded 6098 records from Elasticsearch
2025-05-23 11:35:02,046 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 11:35:02,143 - anomaly_detection - INFO - Detected 305 anomalies
2025-05-23 11:35:02,153 - anomaly_detection - INFO - Indexing 305 anomalies to security-anomalies
2025-05-23 11:35:02,180 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 11:35:02,181 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:35:02,181 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 11:35:02,329 - anomaly_detection - INFO - Detected 305 anomalies
2025-05-23 11:35:02,329 - anomaly_detection - INFO - Indexing 305 anomalies to security-anomalies
2025-05-23 11:35:02,356 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 11:35:02,357 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:35:02,357 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 11:39:57,495 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 11:39:57,495 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 11:39:57,517 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.019s]
2025-05-23 11:39:57,574 - risk_scoring - INFO - Loaded 7202 anomalies from Elasticsearch
2025-05-23 11:39:57,591 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 11:39:57,595 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 11:39:57,595 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 11:39:57,596 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 11:39:57,605 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.008s]
2025-05-23 11:39:57,606 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 11:39:57,606 - risk_scoring - INFO - Calculating risk scores
2025-05-23 11:39:57,607 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 11:39:57,609 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 11:39:57,618 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.008s]
2025-05-23 11:39:57,618 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 11:39:57,619 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 11:40:02,400 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 11:40:02,401 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 11:40:02,506 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.105s]
2025-05-23 11:40:02,775 - anomaly_detection - INFO - Loaded 6141 records from Elasticsearch
2025-05-23 11:40:02,843 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 11:40:02,941 - anomaly_detection - INFO - Detected 306 anomalies
2025-05-23 11:40:02,952 - anomaly_detection - INFO - Indexing 306 anomalies to security-anomalies
2025-05-23 11:40:02,978 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 11:40:02,979 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:40:02,979 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 11:40:03,123 - anomaly_detection - INFO - Detected 307 anomalies
2025-05-23 11:40:03,123 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-05-23 11:40:03,149 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 11:40:03,150 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:40:03,150 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 11:45:03,248 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 11:45:03,248 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 11:45:03,353 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.104s]
2025-05-23 11:45:03,709 - anomaly_detection - INFO - Loaded 6153 records from Elasticsearch
2025-05-23 11:45:03,785 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 11:45:03,884 - anomaly_detection - INFO - Detected 307 anomalies
2025-05-23 11:45:03,894 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-05-23 11:45:03,921 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 11:45:03,921 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:45:03,922 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 11:45:04,067 - anomaly_detection - INFO - Detected 308 anomalies
2025-05-23 11:45:04,067 - anomaly_detection - INFO - Indexing 308 anomalies to security-anomalies
2025-05-23 11:45:04,093 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 11:45:04,094 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:45:04,094 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 11:50:04,188 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 11:50:04,188 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 11:50:04,329 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.141s]
2025-05-23 11:50:04,684 - anomaly_detection - INFO - Loaded 6185 records from Elasticsearch
2025-05-23 11:50:04,755 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 11:50:04,859 - anomaly_detection - INFO - Detected 309 anomalies
2025-05-23 11:50:04,871 - anomaly_detection - INFO - Indexing 309 anomalies to security-anomalies
2025-05-23 11:50:04,899 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 11:50:04,900 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:50:04,900 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 11:50:05,056 - anomaly_detection - INFO - Detected 310 anomalies
2025-05-23 11:50:05,056 - anomaly_detection - INFO - Indexing 310 anomalies to security-anomalies
2025-05-23 11:50:05,082 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 11:50:05,083 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:50:05,083 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 11:54:57,718 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 11:54:57,718 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 11:54:57,738 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.017s]
2025-05-23 11:54:57,761 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 11:54:57,788 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 11:54:57,792 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 11:54:57,792 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 11:54:57,793 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 11:54:57,796 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.001s]
2025-05-23 11:54:57,796 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 11:54:57,796 - risk_scoring - INFO - Calculating risk scores
2025-05-23 11:54:57,797 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 11:54:57,800 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 11:54:57,807 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.007s]
2025-05-23 11:54:57,808 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 11:54:57,808 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 11:55:01,374 - __main__ - INFO - Starting server services...
2025-05-23 11:55:01,487 - __main__ - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 11:55:01,487 - __main__ - INFO - Starting anomaly detection service...
2025-05-23 11:55:02,014 - anomaly_detection - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 11:55:02,014 - __main__ - INFO - Anomaly detection service started
2025-05-23 11:55:02,014 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 11:55:02,014 - __main__ - INFO - Starting risk scoring service...
2025-05-23 11:55:02,014 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 11:55:02,018 - __main__ - INFO - Risk scoring service started
2025-05-23 11:55:02,018 - __main__ - INFO - All services started successfully
2025-05-23 11:55:02,018 - risk_scoring - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 11:55:02,018 - risk_scoring - INFO - Loading asset criticality from config/asset_criticality.json
2025-05-23 11:55:02,018 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 11:55:02,018 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 11:55:02,114 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.027s]
2025-05-23 11:55:02,115 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.100s]
2025-05-23 11:55:02,158 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 11:55:02,535 - anomaly_detection - INFO - Loaded 6170 records from Elasticsearch
2025-05-23 11:55:02,583 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 11:55:02,600 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.011s]
2025-05-23 11:55:02,628 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 11:55:02,628 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 11:55:02,629 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 11:55:02,636 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.003s]
2025-05-23 11:55:02,637 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 11:55:02,637 - risk_scoring - INFO - Calculating risk scores
2025-05-23 11:55:02,638 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 11:55:02,642 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 11:55:02,653 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.010s]
2025-05-23 11:55:02,653 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 11:55:02,653 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 11:55:02,740 - anomaly_detection - INFO - Detected 307 anomalies
2025-05-23 11:55:02,750 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-05-23 11:55:02,779 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 11:55:02,780 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:55:02,780 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 11:55:02,930 - anomaly_detection - INFO - Detected 309 anomalies
2025-05-23 11:55:02,931 - anomaly_detection - INFO - Indexing 309 anomalies to security-anomalies
2025-05-23 11:55:02,957 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 11:55:02,958 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:55:02,958 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 11:55:05,183 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 11:55:05,183 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 11:55:05,266 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.082s]
2025-05-23 11:55:05,547 - anomaly_detection - INFO - Loaded 6170 records from Elasticsearch
2025-05-23 11:55:05,615 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 11:55:05,714 - anomaly_detection - INFO - Detected 307 anomalies
2025-05-23 11:55:05,725 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-05-23 11:55:05,751 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 11:55:05,752 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:55:05,752 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 11:55:05,899 - anomaly_detection - INFO - Detected 309 anomalies
2025-05-23 11:55:05,900 - anomaly_detection - INFO - Indexing 309 anomalies to security-anomalies
2025-05-23 11:55:05,925 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 11:55:05,926 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:55:05,926 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 11:55:08,812 - __main__ - INFO - Server shutting down gracefully...
2025-05-23 11:55:38,851 - __main__ - INFO - Starting server services...
2025-05-23 11:55:38,962 - __main__ - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 11:55:38,962 - __main__ - INFO - Starting anomaly detection service...
2025-05-23 11:55:39,510 - __main__ - INFO - Anomaly detection service started
2025-05-23 11:55:39,511 - __main__ - INFO - Starting risk scoring service...
2025-05-23 11:55:39,511 - anomaly_detection - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 11:55:39,511 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 11:55:39,512 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 11:55:39,514 - __main__ - INFO - Risk scoring service started
2025-05-23 11:55:39,515 - risk_scoring - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 11:55:39,515 - __main__ - INFO - All services started successfully
2025-05-23 11:55:39,515 - risk_scoring - INFO - Loading asset criticality from config/asset_criticality.json
2025-05-23 11:55:39,515 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 11:55:39,515 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 11:55:39,604 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.022s]
2025-05-23 11:55:39,634 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.122s]
2025-05-23 11:55:39,635 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 11:55:40,003 - anomaly_detection - INFO - Loaded 6186 records from Elasticsearch
2025-05-23 11:55:40,047 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 11:55:40,090 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 11:55:40,091 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-05-23 11:55:40,093 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 11:55:40,093 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 11:55:40,101 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.003s]
2025-05-23 11:55:40,102 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 11:55:40,102 - risk_scoring - INFO - Calculating risk scores
2025-05-23 11:55:40,104 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 11:55:40,107 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 11:55:40,117 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.009s]
2025-05-23 11:55:40,117 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 11:55:40,117 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 11:55:40,204 - anomaly_detection - INFO - Detected 308 anomalies
2025-05-23 11:55:40,215 - anomaly_detection - INFO - Indexing 308 anomalies to security-anomalies
2025-05-23 11:55:40,244 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 11:55:40,245 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:55:40,245 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 11:55:40,395 - anomaly_detection - INFO - Detected 310 anomalies
2025-05-23 11:55:40,395 - anomaly_detection - INFO - Indexing 310 anomalies to security-anomalies
2025-05-23 11:55:40,422 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 11:55:40,423 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 11:55:40,423 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 11:55:43,288 - __main__ - INFO - Server shutting down gracefully...
2025-05-23 12:01:11,160 - __main__ - INFO - Starting server services...
2025-05-23 12:01:11,293 - __main__ - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 12:01:11,293 - __main__ - INFO - Starting anomaly detection service...
2025-05-23 12:01:11,925 - __main__ - INFO - Anomaly detection service started
2025-05-23 12:01:11,926 - anomaly_detection - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 12:01:11,926 - __main__ - INFO - Starting risk scoring service...
2025-05-23 12:01:11,926 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 12:01:11,927 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 12:01:11,931 - __main__ - INFO - Risk scoring service started
2025-05-23 12:01:11,931 - risk_scoring - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 12:01:11,931 - __main__ - INFO - All services started successfully
2025-05-23 12:01:11,931 - risk_scoring - INFO - Loading asset criticality from config/asset_criticality.json
2025-05-23 12:01:11,932 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 12:01:11,932 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 12:01:12,032 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.029s]
2025-05-23 12:01:12,073 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 12:01:12,164 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 12:01:12,171 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-05-23 12:01:12,171 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 12:01:12,172 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 12:01:12,178 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 12:01:12,178 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 12:01:12,179 - risk_scoring - INFO - Calculating risk scores
2025-05-23 12:01:12,180 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 12:01:12,185 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 12:01:12,198 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.012s]
2025-05-23 12:01:12,198 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 12:01:12,198 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 12:01:12,207 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.280s]
2025-05-23 12:01:12,617 - anomaly_detection - INFO - Loaded 6137 records from Elasticsearch
2025-05-23 12:01:12,681 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 12:01:12,797 - anomaly_detection - INFO - Detected 304 anomalies
2025-05-23 12:01:12,809 - anomaly_detection - INFO - Indexing 304 anomalies to security-anomalies
2025-05-23 12:01:12,841 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-05-23 12:01:12,842 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 12:01:12,842 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 12:01:13,006 - anomaly_detection - INFO - Detected 307 anomalies
2025-05-23 12:01:13,007 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-05-23 12:01:13,039 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-05-23 12:01:13,040 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 12:01:13,040 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 12:01:19,899 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 12:01:19,899 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 12:01:20,012 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.111s]
2025-05-23 12:01:20,381 - anomaly_detection - INFO - Loaded 6127 records from Elasticsearch
2025-05-23 12:01:20,462 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 12:01:20,582 - anomaly_detection - INFO - Detected 305 anomalies
2025-05-23 12:01:20,594 - anomaly_detection - INFO - Indexing 305 anomalies to security-anomalies
2025-05-23 12:01:20,625 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 12:01:20,626 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 12:01:20,626 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 12:01:20,796 - anomaly_detection - INFO - Detected 303 anomalies
2025-05-23 12:01:20,796 - anomaly_detection - INFO - Indexing 303 anomalies to security-anomalies
2025-05-23 12:01:20,825 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 12:01:20,825 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 12:01:20,826 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 12:01:29,099 - __main__ - INFO - Server shutting down gracefully...
2025-05-23 12:06:20,916 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 12:06:20,917 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 12:06:21,032 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.115s]
2025-05-23 12:06:21,394 - anomaly_detection - INFO - Loaded 6135 records from Elasticsearch
2025-05-23 12:06:21,469 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 12:06:21,578 - anomaly_detection - INFO - Detected 299 anomalies
2025-05-23 12:06:21,589 - anomaly_detection - INFO - Indexing 299 anomalies to security-anomalies
2025-05-23 12:06:21,616 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 12:06:21,617 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 12:06:21,617 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 12:06:21,770 - anomaly_detection - INFO - Detected 307 anomalies
2025-05-23 12:06:21,771 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-05-23 12:06:21,797 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 12:06:21,797 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 12:06:21,797 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 13:59:58,096 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 13:59:58,097 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 13:59:58,176 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.062s]
2025-05-23 13:59:58,237 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 13:59:58,288 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 13:59:58,295 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-05-23 13:59:58,295 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 13:59:58,296 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 13:59:58,301 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 13:59:58,301 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 13:59:58,302 - risk_scoring - INFO - Calculating risk scores
2025-05-23 13:59:58,304 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 13:59:58,308 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 13:59:58,324 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.015s]
2025-05-23 13:59:58,324 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 13:59:58,324 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 14:00:08,212 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 14:00:08,212 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 14:00:08,288 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.075s]
2025-05-23 14:00:08,297 - anomaly_detection - INFO - Loaded 232 records from Elasticsearch
2025-05-23 14:00:08,316 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 14:00:08,421 - anomaly_detection - INFO - Detected 12 anomalies
2025-05-23 14:00:08,432 - anomaly_detection - INFO - Indexing 12 anomalies to security-anomalies
2025-05-23 14:00:08,439 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-05-23 14:00:08,440 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:00:08,440 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 14:00:08,446 - anomaly_detection - INFO - Detected 12 anomalies
2025-05-23 14:00:08,446 - anomaly_detection - INFO - Indexing 12 anomalies to security-anomalies
2025-05-23 14:00:08,455 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 14:00:08,455 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:00:08,455 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 14:05:08,536 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 14:05:08,537 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 14:05:08,662 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.124s]
2025-05-23 14:05:08,882 - anomaly_detection - INFO - Loaded 748 records from Elasticsearch
2025-05-23 14:05:08,899 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 14:05:09,007 - anomaly_detection - INFO - Detected 38 anomalies
2025-05-23 14:05:09,012 - anomaly_detection - INFO - Indexing 38 anomalies to security-anomalies
2025-05-23 14:05:09,027 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.012s]
2025-05-23 14:05:09,028 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:05:09,028 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 14:05:09,047 - anomaly_detection - INFO - Detected 38 anomalies
2025-05-23 14:05:09,047 - anomaly_detection - INFO - Indexing 38 anomalies to security-anomalies
2025-05-23 14:05:09,064 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.013s]
2025-05-23 14:05:09,064 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:05:09,065 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 14:10:09,143 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 14:10:09,143 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 14:10:09,181 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.038s]
2025-05-23 14:10:09,219 - anomaly_detection - INFO - Loaded 1253 records from Elasticsearch
2025-05-23 14:10:09,236 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 14:10:09,317 - anomaly_detection - INFO - Detected 63 anomalies
2025-05-23 14:10:09,321 - anomaly_detection - INFO - Indexing 63 anomalies to security-anomalies
2025-05-23 14:10:09,332 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 14:10:09,332 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:10:09,333 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 14:10:09,354 - anomaly_detection - INFO - Detected 63 anomalies
2025-05-23 14:10:09,354 - anomaly_detection - INFO - Indexing 63 anomalies to security-anomalies
2025-05-23 14:10:09,365 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 14:10:09,365 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:10:09,365 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 14:14:58,425 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 14:14:58,426 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 14:14:58,468 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.039s]
2025-05-23 14:14:58,537 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 14:14:58,572 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 14:14:58,577 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 14:14:58,577 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 14:14:58,578 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 14:14:58,589 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.010s]
2025-05-23 14:14:58,590 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 14:14:58,590 - risk_scoring - INFO - Calculating risk scores
2025-05-23 14:14:58,591 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 14:14:58,594 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 14:14:58,605 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.010s]
2025-05-23 14:14:58,605 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 14:14:58,605 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 14:15:09,441 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 14:15:09,441 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 14:15:09,490 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.048s]
2025-05-23 14:15:09,588 - anomaly_detection - INFO - Loaded 1765 records from Elasticsearch
2025-05-23 14:15:09,610 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 14:15:09,698 - anomaly_detection - INFO - Detected 89 anomalies
2025-05-23 14:15:09,704 - anomaly_detection - INFO - Indexing 89 anomalies to security-anomalies
2025-05-23 14:15:09,717 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 14:15:09,717 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:15:09,717 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 14:15:09,735 - anomaly_detection - INFO - Detected 89 anomalies
2025-05-23 14:15:09,735 - anomaly_detection - INFO - Indexing 89 anomalies to security-anomalies
2025-05-23 14:15:09,748 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 14:15:09,749 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:15:09,749 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 14:20:09,845 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 14:20:09,846 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 14:20:09,901 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.055s]
2025-05-23 14:20:10,072 - anomaly_detection - INFO - Loaded 2287 records from Elasticsearch
2025-05-23 14:20:10,099 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 14:20:10,184 - anomaly_detection - INFO - Detected 114 anomalies
2025-05-23 14:20:10,189 - anomaly_detection - INFO - Indexing 114 anomalies to security-anomalies
2025-05-23 14:20:10,203 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 14:20:10,204 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:20:10,204 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 14:20:10,235 - anomaly_detection - INFO - Detected 115 anomalies
2025-05-23 14:20:10,236 - anomaly_detection - INFO - Indexing 115 anomalies to security-anomalies
2025-05-23 14:20:10,252 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 14:20:10,252 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:20:10,252 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 14:24:17,081 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 14:24:17,081 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 14:24:17,132 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.050s]
2025-05-23 14:24:17,250 - anomaly_detection - INFO - Loaded 2799 records from Elasticsearch
2025-05-23 14:24:17,281 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 14:24:17,365 - anomaly_detection - INFO - Detected 138 anomalies
2025-05-23 14:24:17,371 - anomaly_detection - INFO - Indexing 138 anomalies to security-anomalies
2025-05-23 14:24:17,388 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-05-23 14:24:17,389 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:24:17,389 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 14:24:17,425 - anomaly_detection - INFO - Detected 136 anomalies
2025-05-23 14:24:17,425 - anomaly_detection - INFO - Indexing 136 anomalies to security-anomalies
2025-05-23 14:24:17,442 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 14:24:17,442 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:24:17,442 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 14:29:05,433 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 14:29:05,434 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 14:29:05,462 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.025s]
2025-05-23 14:29:05,488 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 14:29:05,525 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 14:29:05,530 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 14:29:05,530 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 14:29:05,531 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 14:29:05,536 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.003s]
2025-05-23 14:29:05,536 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 14:29:05,537 - risk_scoring - INFO - Calculating risk scores
2025-05-23 14:29:05,538 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 14:29:05,543 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 14:29:05,553 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.010s]
2025-05-23 14:29:05,554 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 14:29:05,554 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 14:29:17,543 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 14:29:17,543 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 14:29:17,610 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.066s]
2025-05-23 14:29:17,810 - anomaly_detection - INFO - Loaded 3310 records from Elasticsearch
2025-05-23 14:29:17,854 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 14:29:17,955 - anomaly_detection - INFO - Detected 166 anomalies
2025-05-23 14:29:17,962 - anomaly_detection - INFO - Indexing 166 anomalies to security-anomalies
2025-05-23 14:29:17,986 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.010s]
2025-05-23 14:29:17,987 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:29:17,988 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 14:29:18,042 - anomaly_detection - INFO - Detected 166 anomalies
2025-05-23 14:29:18,042 - anomaly_detection - INFO - Indexing 166 anomalies to security-anomalies
2025-05-23 14:29:18,061 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 14:29:18,061 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:29:18,061 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 14:34:18,142 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 14:34:18,142 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 14:34:18,210 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.067s]
2025-05-23 14:34:18,356 - anomaly_detection - INFO - Loaded 3828 records from Elasticsearch
2025-05-23 14:34:18,400 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 14:34:18,501 - anomaly_detection - INFO - Detected 192 anomalies
2025-05-23 14:34:18,509 - anomaly_detection - INFO - Indexing 192 anomalies to security-anomalies
2025-05-23 14:34:18,532 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 14:34:18,532 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:34:18,533 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 14:34:18,596 - anomaly_detection - INFO - Detected 192 anomalies
2025-05-23 14:34:18,596 - anomaly_detection - INFO - Indexing 192 anomalies to security-anomalies
2025-05-23 14:34:18,616 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 14:34:18,617 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:34:18,617 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 14:39:18,677 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 14:39:18,677 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 14:39:18,741 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.064s]
2025-05-23 14:39:18,966 - anomaly_detection - INFO - Loaded 4343 records from Elasticsearch
2025-05-23 14:39:19,017 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 14:39:19,119 - anomaly_detection - INFO - Detected 218 anomalies
2025-05-23 14:39:19,129 - anomaly_detection - INFO - Indexing 218 anomalies to security-anomalies
2025-05-23 14:39:19,153 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 14:39:19,153 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:39:19,154 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 14:39:19,251 - anomaly_detection - INFO - Detected 218 anomalies
2025-05-23 14:39:19,251 - anomaly_detection - INFO - Indexing 218 anomalies to security-anomalies
2025-05-23 14:39:19,275 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 14:39:19,276 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:39:19,276 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 14:44:05,644 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 14:44:05,644 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 14:44:05,682 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.033s]
2025-05-23 14:44:05,771 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 14:44:05,813 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 14:44:05,818 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-05-23 14:44:05,819 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 14:44:05,819 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 14:44:05,824 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 14:44:05,825 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 14:44:05,825 - risk_scoring - INFO - Calculating risk scores
2025-05-23 14:44:05,827 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 14:44:05,832 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 14:44:05,844 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.012s]
2025-05-23 14:44:05,844 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 14:44:05,844 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 14:44:19,371 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 14:44:19,371 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 14:44:19,445 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.073s]
2025-05-23 14:44:19,715 - anomaly_detection - INFO - Loaded 4862 records from Elasticsearch
2025-05-23 14:44:19,782 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 14:44:19,895 - anomaly_detection - INFO - Detected 229 anomalies
2025-05-23 14:44:19,905 - anomaly_detection - INFO - Indexing 229 anomalies to security-anomalies
2025-05-23 14:44:19,929 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 14:44:19,930 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:44:19,930 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 14:44:20,056 - anomaly_detection - INFO - Detected 244 anomalies
2025-05-23 14:44:20,056 - anomaly_detection - INFO - Indexing 244 anomalies to security-anomalies
2025-05-23 14:44:20,083 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 14:44:20,084 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:44:20,084 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 14:49:20,154 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 14:49:20,155 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 14:49:20,227 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.072s]
2025-05-23 14:49:20,503 - anomaly_detection - INFO - Loaded 5367 records from Elasticsearch
2025-05-23 14:49:20,561 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 14:49:20,657 - anomaly_detection - INFO - Detected 255 anomalies
2025-05-23 14:49:20,667 - anomaly_detection - INFO - Indexing 255 anomalies to security-anomalies
2025-05-23 14:49:20,690 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 14:49:20,691 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:49:20,691 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 14:49:20,808 - anomaly_detection - INFO - Detected 269 anomalies
2025-05-23 14:49:20,809 - anomaly_detection - INFO - Indexing 269 anomalies to security-anomalies
2025-05-23 14:49:20,833 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 14:49:20,833 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:49:20,834 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 14:54:20,923 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 14:54:20,924 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 14:54:21,004 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.080s]
2025-05-23 14:54:21,295 - anomaly_detection - INFO - Loaded 5883 records from Elasticsearch
2025-05-23 14:54:21,359 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 14:54:21,456 - anomaly_detection - INFO - Detected 294 anomalies
2025-05-23 14:54:21,466 - anomaly_detection - INFO - Indexing 294 anomalies to security-anomalies
2025-05-23 14:54:21,492 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 14:54:21,494 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:54:21,494 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 14:54:21,638 - anomaly_detection - INFO - Detected 294 anomalies
2025-05-23 14:54:21,638 - anomaly_detection - INFO - Indexing 294 anomalies to security-anomalies
2025-05-23 14:54:21,664 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 14:54:21,665 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:54:21,665 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 14:59:05,944 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 14:59:05,944 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 14:59:05,966 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.019s]
2025-05-23 14:59:05,991 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 14:59:06,027 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 14:59:06,031 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 14:59:06,031 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 14:59:06,032 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 14:59:06,036 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 14:59:06,036 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 14:59:06,036 - risk_scoring - INFO - Calculating risk scores
2025-05-23 14:59:06,037 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 14:59:06,041 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 14:59:06,051 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.010s]
2025-05-23 14:59:06,052 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 14:59:06,052 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 14:59:21,760 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 14:59:21,761 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 14:59:21,869 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.108s]
2025-05-23 14:59:22,248 - anomaly_detection - INFO - Loaded 6133 records from Elasticsearch
2025-05-23 14:59:22,327 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 14:59:22,443 - anomaly_detection - INFO - Detected 307 anomalies
2025-05-23 14:59:22,455 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-05-23 14:59:22,486 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-05-23 14:59:22,487 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:59:22,487 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 14:59:22,658 - anomaly_detection - INFO - Detected 307 anomalies
2025-05-23 14:59:22,658 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-05-23 14:59:22,689 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 14:59:22,690 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 14:59:22,691 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 15:04:22,790 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 15:04:22,790 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 15:04:22,873 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.083s]
2025-05-23 15:04:23,199 - anomaly_detection - INFO - Loaded 6115 records from Elasticsearch
2025-05-23 15:04:23,278 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 15:04:23,390 - anomaly_detection - INFO - Detected 306 anomalies
2025-05-23 15:04:23,401 - anomaly_detection - INFO - Indexing 306 anomalies to security-anomalies
2025-05-23 15:04:23,434 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 15:04:23,435 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:04:23,435 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 15:04:23,607 - anomaly_detection - INFO - Detected 306 anomalies
2025-05-23 15:04:23,607 - anomaly_detection - INFO - Indexing 306 anomalies to security-anomalies
2025-05-23 15:04:23,637 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 15:04:23,638 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:04:23,638 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 15:09:23,703 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 15:09:23,704 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 15:09:23,759 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.055s]
2025-05-23 15:09:24,041 - anomaly_detection - INFO - Loaded 6133 records from Elasticsearch
2025-05-23 15:09:24,111 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 15:09:24,211 - anomaly_detection - INFO - Detected 302 anomalies
2025-05-23 15:09:24,221 - anomaly_detection - INFO - Indexing 302 anomalies to security-anomalies
2025-05-23 15:09:24,247 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 15:09:24,248 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:09:24,248 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 15:09:24,394 - anomaly_detection - INFO - Detected 306 anomalies
2025-05-23 15:09:24,394 - anomaly_detection - INFO - Indexing 306 anomalies to security-anomalies
2025-05-23 15:09:24,421 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 15:09:24,421 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:09:24,422 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 15:14:06,124 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 15:14:06,124 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 15:14:06,149 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.023s]
2025-05-23 15:14:06,172 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 15:14:06,202 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 15:14:06,206 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 15:14:06,206 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 15:14:06,207 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 15:14:06,210 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.001s]
2025-05-23 15:14:06,210 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 15:14:06,210 - risk_scoring - INFO - Calculating risk scores
2025-05-23 15:14:06,211 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 15:14:06,216 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 15:14:06,227 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.009s]
2025-05-23 15:14:06,228 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 15:14:06,228 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 15:14:24,510 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 15:14:24,510 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 15:14:24,615 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.105s]
2025-05-23 15:14:25,005 - anomaly_detection - INFO - Loaded 6132 records from Elasticsearch
2025-05-23 15:14:25,082 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 15:14:25,183 - anomaly_detection - INFO - Detected 306 anomalies
2025-05-23 15:14:25,194 - anomaly_detection - INFO - Indexing 306 anomalies to security-anomalies
2025-05-23 15:14:25,222 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 15:14:25,223 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:14:25,224 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 15:14:25,375 - anomaly_detection - INFO - Detected 306 anomalies
2025-05-23 15:14:25,375 - anomaly_detection - INFO - Indexing 306 anomalies to security-anomalies
2025-05-23 15:14:25,403 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 15:14:25,404 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:14:25,404 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 15:19:25,500 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 15:19:25,500 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 15:19:25,585 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.085s]
2025-05-23 15:19:25,861 - anomaly_detection - INFO - Loaded 6115 records from Elasticsearch
2025-05-23 15:19:25,929 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 15:19:26,028 - anomaly_detection - INFO - Detected 306 anomalies
2025-05-23 15:19:26,040 - anomaly_detection - INFO - Indexing 306 anomalies to security-anomalies
2025-05-23 15:19:26,070 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-05-23 15:19:26,071 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:19:26,071 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 15:19:26,226 - anomaly_detection - INFO - Detected 301 anomalies
2025-05-23 15:19:26,227 - anomaly_detection - INFO - Indexing 301 anomalies to security-anomalies
2025-05-23 15:19:26,254 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 15:19:26,254 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:19:26,255 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 15:24:26,355 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 15:24:26,355 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 15:24:26,458 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.102s]
2025-05-23 15:24:26,839 - anomaly_detection - INFO - Loaded 6128 records from Elasticsearch
2025-05-23 15:24:26,909 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 15:24:27,009 - anomaly_detection - INFO - Detected 306 anomalies
2025-05-23 15:24:27,020 - anomaly_detection - INFO - Indexing 306 anomalies to security-anomalies
2025-05-23 15:24:27,051 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.010s]
2025-05-23 15:24:27,052 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:24:27,052 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 15:24:27,202 - anomaly_detection - INFO - Detected 307 anomalies
2025-05-23 15:24:27,203 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-05-23 15:24:27,229 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 15:24:27,229 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:24:27,230 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 15:29:06,324 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 15:29:06,324 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 15:29:06,354 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.026s]
2025-05-23 15:29:06,378 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 15:29:06,414 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 15:29:06,418 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 15:29:06,418 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 15:29:06,418 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 15:29:06,426 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.005s]
2025-05-23 15:29:06,427 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 15:29:06,428 - risk_scoring - INFO - Calculating risk scores
2025-05-23 15:29:06,430 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 15:29:06,435 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 15:29:06,445 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.009s]
2025-05-23 15:29:06,445 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 15:29:06,445 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 15:29:27,330 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 15:29:27,330 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 15:29:27,428 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.098s]
2025-05-23 15:29:27,759 - anomaly_detection - INFO - Loaded 6128 records from Elasticsearch
2025-05-23 15:29:27,840 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 15:29:27,964 - anomaly_detection - INFO - Detected 307 anomalies
2025-05-23 15:29:27,995 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-05-23 15:29:28,048 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.014s]
2025-05-23 15:29:28,049 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:29:28,049 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 15:29:28,236 - anomaly_detection - INFO - Detected 306 anomalies
2025-05-23 15:29:28,236 - anomaly_detection - INFO - Indexing 306 anomalies to security-anomalies
2025-05-23 15:29:28,271 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-05-23 15:29:28,272 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:29:28,272 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 15:34:28,308 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 15:34:28,308 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 15:34:28,402 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.094s]
2025-05-23 15:34:28,668 - anomaly_detection - INFO - Loaded 6113 records from Elasticsearch
2025-05-23 15:34:28,739 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 15:34:28,834 - anomaly_detection - INFO - Detected 306 anomalies
2025-05-23 15:34:28,845 - anomaly_detection - INFO - Indexing 306 anomalies to security-anomalies
2025-05-23 15:34:28,871 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 15:34:28,872 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:34:28,872 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 15:34:29,017 - anomaly_detection - INFO - Detected 305 anomalies
2025-05-23 15:34:29,018 - anomaly_detection - INFO - Indexing 305 anomalies to security-anomalies
2025-05-23 15:34:29,043 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 15:34:29,044 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:34:29,044 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 15:39:29,138 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 15:39:29,138 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 15:39:29,220 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.081s]
2025-05-23 15:39:29,548 - anomaly_detection - INFO - Loaded 6115 records from Elasticsearch
2025-05-23 15:39:29,617 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 15:39:29,713 - anomaly_detection - INFO - Detected 305 anomalies
2025-05-23 15:39:29,723 - anomaly_detection - INFO - Indexing 305 anomalies to security-anomalies
2025-05-23 15:39:29,750 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 15:39:29,751 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:39:29,751 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 15:39:29,902 - anomaly_detection - INFO - Detected 306 anomalies
2025-05-23 15:39:29,902 - anomaly_detection - INFO - Indexing 306 anomalies to security-anomalies
2025-05-23 15:39:29,928 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 15:39:29,929 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:39:29,929 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 15:44:06,545 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 15:44:06,546 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 15:44:06,570 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.022s]
2025-05-23 15:44:06,593 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 15:44:06,621 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 15:44:06,625 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 15:44:06,625 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 15:44:06,626 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 15:44:06,632 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 15:44:06,632 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 15:44:06,632 - risk_scoring - INFO - Calculating risk scores
2025-05-23 15:44:06,633 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 15:44:06,636 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 15:44:06,645 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.008s]
2025-05-23 15:44:06,645 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 15:44:06,645 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 15:44:30,003 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 15:44:30,004 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 15:44:30,087 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.083s]
2025-05-23 15:44:30,452 - anomaly_detection - INFO - Loaded 6107 records from Elasticsearch
2025-05-23 15:44:30,521 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 15:44:30,617 - anomaly_detection - INFO - Detected 306 anomalies
2025-05-23 15:44:30,627 - anomaly_detection - INFO - Indexing 306 anomalies to security-anomalies
2025-05-23 15:44:30,654 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 15:44:30,655 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:44:30,656 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 15:44:30,803 - anomaly_detection - INFO - Detected 306 anomalies
2025-05-23 15:44:30,803 - anomaly_detection - INFO - Indexing 306 anomalies to security-anomalies
2025-05-23 15:44:30,829 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 15:44:30,830 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:44:30,830 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 15:49:30,907 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 15:49:30,907 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 15:49:30,986 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.079s]
2025-05-23 15:49:31,199 - anomaly_detection - INFO - Loaded 6115 records from Elasticsearch
2025-05-23 15:49:31,366 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 15:49:31,464 - anomaly_detection - INFO - Detected 304 anomalies
2025-05-23 15:49:31,474 - anomaly_detection - INFO - Indexing 304 anomalies to security-anomalies
2025-05-23 15:49:31,501 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 15:49:31,502 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:49:31,502 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 15:49:31,647 - anomaly_detection - INFO - Detected 306 anomalies
2025-05-23 15:49:31,648 - anomaly_detection - INFO - Indexing 306 anomalies to security-anomalies
2025-05-23 15:49:31,673 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 15:49:31,674 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:49:31,674 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 15:54:31,763 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 15:54:31,763 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 15:54:31,841 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.078s]
2025-05-23 15:54:32,059 - anomaly_detection - INFO - Loaded 6137 records from Elasticsearch
2025-05-23 15:54:32,232 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 15:54:32,329 - anomaly_detection - INFO - Detected 307 anomalies
2025-05-23 15:54:32,340 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-05-23 15:54:32,367 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 15:54:32,368 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:54:32,368 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 15:54:32,508 - anomaly_detection - INFO - Detected 307 anomalies
2025-05-23 15:54:32,509 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-05-23 15:54:32,535 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 15:54:32,536 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:54:32,536 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 15:59:06,739 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 15:59:06,739 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 15:59:06,764 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.022s]
2025-05-23 15:59:06,786 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 15:59:06,814 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 15:59:06,819 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 15:59:06,819 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 15:59:06,819 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 15:59:06,823 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.001s]
2025-05-23 15:59:06,823 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 15:59:06,823 - risk_scoring - INFO - Calculating risk scores
2025-05-23 15:59:06,824 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 15:59:06,827 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 15:59:06,837 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.009s]
2025-05-23 15:59:06,837 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 15:59:06,837 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 15:59:32,590 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 15:59:32,590 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 15:59:32,662 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.072s]
2025-05-23 15:59:32,957 - anomaly_detection - INFO - Loaded 6184 records from Elasticsearch
2025-05-23 15:59:33,027 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 15:59:33,125 - anomaly_detection - INFO - Detected 310 anomalies
2025-05-23 15:59:33,136 - anomaly_detection - INFO - Indexing 310 anomalies to security-anomalies
2025-05-23 15:59:33,163 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 15:59:33,164 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:59:33,164 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 15:59:33,311 - anomaly_detection - INFO - Detected 309 anomalies
2025-05-23 15:59:33,311 - anomaly_detection - INFO - Indexing 309 anomalies to security-anomalies
2025-05-23 15:59:33,338 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 15:59:33,339 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 15:59:33,339 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 16:04:33,419 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 16:04:33,419 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 16:04:33,508 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.088s]
2025-05-23 16:04:33,873 - anomaly_detection - INFO - Loaded 6234 records from Elasticsearch
2025-05-23 16:04:33,953 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 16:04:34,062 - anomaly_detection - INFO - Detected 311 anomalies
2025-05-23 16:04:34,075 - anomaly_detection - INFO - Indexing 311 anomalies to security-anomalies
2025-05-23 16:04:34,107 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 16:04:34,107 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 16:04:34,108 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 16:04:34,275 - anomaly_detection - INFO - Detected 312 anomalies
2025-05-23 16:04:34,275 - anomaly_detection - INFO - Indexing 312 anomalies to security-anomalies
2025-05-23 16:04:34,306 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 16:04:34,307 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 16:04:34,308 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 16:09:34,408 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 16:09:34,408 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 16:09:34,492 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.084s]
2025-05-23 16:09:34,834 - anomaly_detection - INFO - Loaded 6298 records from Elasticsearch
2025-05-23 16:09:34,907 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 16:09:35,004 - anomaly_detection - INFO - Detected 315 anomalies
2025-05-23 16:09:35,015 - anomaly_detection - INFO - Indexing 315 anomalies to security-anomalies
2025-05-23 16:09:35,041 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 16:09:35,042 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 16:09:35,042 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 16:09:35,186 - anomaly_detection - INFO - Detected 315 anomalies
2025-05-23 16:09:35,187 - anomaly_detection - INFO - Indexing 315 anomalies to security-anomalies
2025-05-23 16:09:35,212 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 16:09:35,213 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 16:09:35,213 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 16:14:06,937 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 16:14:06,937 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 16:14:06,971 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.031s]
2025-05-23 16:14:06,994 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 16:14:07,027 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 16:14:07,031 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 16:14:07,032 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 16:14:07,032 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 16:14:07,035 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 16:14:07,035 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 16:14:07,036 - risk_scoring - INFO - Calculating risk scores
2025-05-23 16:14:07,037 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 16:14:07,042 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 16:14:07,052 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.009s]
2025-05-23 16:14:07,052 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 16:14:07,052 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 16:14:35,309 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 16:14:35,310 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 16:14:35,397 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.087s]
2025-05-23 16:14:35,749 - anomaly_detection - INFO - Loaded 6356 records from Elasticsearch
2025-05-23 16:14:35,825 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 16:14:35,924 - anomaly_detection - INFO - Detected 316 anomalies
2025-05-23 16:14:35,934 - anomaly_detection - INFO - Indexing 316 anomalies to security-anomalies
2025-05-23 16:14:35,961 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 16:14:35,962 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 16:14:35,962 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 16:14:36,113 - anomaly_detection - INFO - Detected 318 anomalies
2025-05-23 16:14:36,113 - anomaly_detection - INFO - Indexing 318 anomalies to security-anomalies
2025-05-23 16:14:36,140 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 16:14:36,141 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 16:14:36,141 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 16:48:04,306 - __main__ - INFO - Starting server services...
2025-05-23 16:48:04,622 - __main__ - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 16:48:04,622 - __main__ - INFO - Starting anomaly detection service...
2025-05-23 16:48:07,355 - __main__ - INFO - Anomaly detection service started
2025-05-23 16:48:07,356 - __main__ - INFO - Starting risk scoring service...
2025-05-23 16:48:07,359 - anomaly_detection - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 16:48:07,359 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 16:48:07,359 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 16:48:07,366 - risk_scoring - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 16:48:07,366 - __main__ - INFO - Risk scoring service started
2025-05-23 16:48:07,371 - risk_scoring - INFO - Loading asset criticality from config/asset_criticality.json
2025-05-23 16:48:07,371 - __main__ - INFO - All services started successfully
2025-05-23 16:48:07,371 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 16:48:07,371 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 16:48:07,528 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:503 duration:0.168s]
2025-05-23 16:48:07,528 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 1 times in a row, putting on 1 second timeout
2025-05-23 16:48:07,529 - elastic_transport.transport - WARNING - Retrying request after non-successful status 503 (attempt 0 of 3)
2025-05-23 16:48:07,600 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:503 duration:0.070s]
2025-05-23 16:48:07,600 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 2 times in a row, putting on 2 second timeout
2025-05-23 16:48:07,600 - elastic_transport.transport - WARNING - Retrying request after non-successful status 503 (attempt 1 of 3)
2025-05-23 16:48:07,642 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:503 duration:0.042s]
2025-05-23 16:48:07,643 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 3 times in a row, putting on 4 second timeout
2025-05-23 16:48:07,643 - elastic_transport.transport - WARNING - Retrying request after non-successful status 503 (attempt 2 of 3)
2025-05-23 16:48:07,676 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:503 duration:0.033s]
2025-05-23 16:48:07,676 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 4 times in a row, putting on 8 second timeout
2025-05-23 16:48:07,677 - anomaly_detection - ERROR - Error loading data from Elasticsearch: ApiError(503, 'search_phase_execution_exception', '[ubuntu][192.168.43.144:9300][indices:data/read/search[phase/query]]')
2025-05-23 16:48:07,677 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 16:48:08,256 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.751s]
2025-05-23 16:48:08,357 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 16:48:08,437 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 16:48:08,447 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.007s]
2025-05-23 16:48:08,447 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 16:48:08,448 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 16:48:08,490 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.039s]
2025-05-23 16:48:08,491 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 16:48:08,491 - risk_scoring - INFO - Calculating risk scores
2025-05-23 16:48:08,500 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 16:48:08,514 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 16:48:08,659 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.144s]
2025-05-23 16:48:08,660 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 16:48:08,660 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 16:53:07,775 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 16:53:07,776 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 16:53:07,777 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 16:53:07,826 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.049s]
2025-05-23 16:53:07,967 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has been marked alive after a successful request
2025-05-23 16:53:07,968 - anomaly_detection - INFO - Loaded 2470 records from Elasticsearch
2025-05-23 16:53:08,024 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 16:53:08,128 - anomaly_detection - INFO - Detected 124 anomalies
2025-05-23 16:53:08,134 - anomaly_detection - INFO - Indexing 124 anomalies to security-anomalies
2025-05-23 16:53:08,144 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 16:53:08,156 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.012s]
2025-05-23 16:53:08,156 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 16:53:08,156 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 16:53:08,187 - anomaly_detection - INFO - Detected 124 anomalies
2025-05-23 16:53:08,187 - anomaly_detection - INFO - Indexing 124 anomalies to security-anomalies
2025-05-23 16:53:08,197 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 16:53:08,207 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.010s]
2025-05-23 16:53:08,208 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 16:53:08,208 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 16:58:08,298 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 16:58:08,298 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 16:58:08,299 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 16:58:08,325 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.026s]
2025-05-23 16:58:08,376 - anomaly_detection - INFO - Loaded 1936 records from Elasticsearch
2025-05-23 16:58:08,400 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 16:58:08,533 - anomaly_detection - INFO - Detected 97 anomalies
2025-05-23 16:58:08,538 - anomaly_detection - INFO - Indexing 97 anomalies to security-anomalies
2025-05-23 16:58:08,553 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 16:58:08,553 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 16:58:08,554 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 16:58:08,578 - anomaly_detection - INFO - Detected 97 anomalies
2025-05-23 16:58:08,578 - anomaly_detection - INFO - Indexing 97 anomalies to security-anomalies
2025-05-23 16:58:08,594 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 16:58:08,595 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 16:58:08,595 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:03:08,683 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:03:08,684 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:03:08,704 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.020s]
2025-05-23 17:03:08,734 - anomaly_detection - INFO - Loaded 1388 records from Elasticsearch
2025-05-23 17:03:08,752 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 17:03:08,755 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 17:03:08,755 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 17:03:08,807 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.041s]
2025-05-23 17:03:08,896 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 17:03:08,934 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 17:03:08,941 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-05-23 17:03:08,942 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 17:03:08,942 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 17:03:08,951 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.005s]
2025-05-23 17:03:08,951 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 17:03:08,952 - risk_scoring - INFO - Calculating risk scores
2025-05-23 17:03:08,954 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 17:03:08,961 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 17:03:08,977 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.015s]
2025-05-23 17:03:08,979 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 17:03:08,979 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 17:03:09,011 - anomaly_detection - INFO - Detected 70 anomalies
2025-05-23 17:03:09,016 - anomaly_detection - INFO - Indexing 70 anomalies to security-anomalies
2025-05-23 17:03:09,030 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 17:03:09,030 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 17:03:09,030 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 17:03:09,044 - anomaly_detection - INFO - Detected 70 anomalies
2025-05-23 17:03:09,044 - anomaly_detection - INFO - Indexing 70 anomalies to security-anomalies
2025-05-23 17:03:09,057 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 17:03:09,057 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 17:03:09,057 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:08:09,140 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:08:09,140 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:08:09,153 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.013s]
2025-05-23 17:08:09,171 - anomaly_detection - INFO - Loaded 814 records from Elasticsearch
2025-05-23 17:08:09,181 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 17:08:09,260 - anomaly_detection - INFO - Detected 40 anomalies
2025-05-23 17:08:09,264 - anomaly_detection - INFO - Indexing 40 anomalies to security-anomalies
2025-05-23 17:08:09,273 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 17:08:09,273 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 17:08:09,273 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 17:08:09,279 - anomaly_detection - INFO - Detected 40 anomalies
2025-05-23 17:08:09,279 - anomaly_detection - INFO - Indexing 40 anomalies to security-anomalies
2025-05-23 17:08:09,285 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.003s]
2025-05-23 17:08:09,286 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 17:08:09,286 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:08:40,670 - __main__ - INFO - Starting server services...
2025-05-23 17:08:40,782 - __main__ - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 17:08:40,782 - __main__ - INFO - Starting anomaly detection service...
2025-05-23 17:08:41,665 - __main__ - INFO - Anomaly detection service started
2025-05-23 17:08:41,665 - __main__ - INFO - Starting risk scoring service...
2025-05-23 17:08:41,666 - anomaly_detection - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 17:08:41,666 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:08:41,666 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:08:41,669 - __main__ - INFO - Risk scoring service started
2025-05-23 17:08:41,669 - __main__ - INFO - All services started successfully
2025-05-23 17:08:41,669 - risk_scoring - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 17:08:41,670 - risk_scoring - INFO - Loading asset criticality from config/asset_criticality.json
2025-05-23 17:08:41,670 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 17:08:41,670 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 17:08:41,684 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.017s]
2025-05-23 17:08:41,744 - anomaly_detection - INFO - Loaded 753 records from Elasticsearch
2025-05-23 17:08:41,754 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 17:08:41,896 - anomaly_detection - INFO - Detected 38 anomalies
2025-05-23 17:08:41,908 - anomaly_detection - INFO - Indexing 38 anomalies to security-anomalies
2025-05-23 17:08:41,914 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.004s]
2025-05-23 17:08:41,915 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 17:08:41,915 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 17:08:41,922 - anomaly_detection - INFO - Detected 38 anomalies
2025-05-23 17:08:41,922 - anomaly_detection - INFO - Indexing 38 anomalies to security-anomalies
2025-05-23 17:08:41,928 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.003s]
2025-05-23 17:08:41,928 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 17:08:41,928 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:08:41,986 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.026s]
2025-05-23 17:08:42,009 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 17:08:42,034 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 17:08:42,039 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 17:08:42,039 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 17:08:42,039 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 17:08:42,044 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 17:08:42,044 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 17:08:42,045 - risk_scoring - INFO - Calculating risk scores
2025-05-23 17:08:42,046 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 17:08:42,050 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 17:08:42,059 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.009s]
2025-05-23 17:08:42,059 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 17:08:42,060 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 17:13:42,020 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:13:42,021 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:13:42,026 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.004s]
2025-05-23 17:13:42,030 - anomaly_detection - INFO - Loaded 170 records from Elasticsearch
2025-05-23 17:13:42,035 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 17:13:42,124 - anomaly_detection - INFO - Detected 9 anomalies
2025-05-23 17:13:42,127 - anomaly_detection - INFO - Indexing 9 anomalies to security-anomalies
2025-05-23 17:13:42,133 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-05-23 17:13:42,133 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 17:13:42,133 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 17:13:42,137 - anomaly_detection - INFO - Detected 9 anomalies
2025-05-23 17:13:42,137 - anomaly_detection - INFO - Indexing 9 anomalies to security-anomalies
2025-05-23 17:13:42,141 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.003s]
2025-05-23 17:13:42,141 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 17:13:42,141 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:18:42,229 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:18:42,230 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:18:42,232 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.002s]
2025-05-23 17:18:42,232 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:18:42,232 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:18:42,232 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:23:42,121 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 17:23:42,122 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 17:23:42,146 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.020s]
2025-05-23 17:23:42,171 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 17:23:42,256 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 17:23:42,261 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-05-23 17:23:42,262 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 17:23:42,262 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 17:23:42,267 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 17:23:42,267 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 17:23:42,268 - risk_scoring - INFO - Calculating risk scores
2025-05-23 17:23:42,269 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 17:23:42,272 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 17:23:42,282 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.010s]
2025-05-23 17:23:42,283 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 17:23:42,283 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 17:23:42,325 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:23:42,325 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:23:42,327 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.002s]
2025-05-23 17:23:42,327 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:23:42,328 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:23:42,328 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:27:23,912 - __main__ - INFO - Starting server services...
2025-05-23 17:27:24,081 - __main__ - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 17:27:24,081 - __main__ - INFO - Starting anomaly detection service...
2025-05-23 17:27:24,880 - anomaly_detection - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 17:27:24,881 - __main__ - INFO - Anomaly detection service started
2025-05-23 17:27:24,881 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:27:24,881 - __main__ - INFO - Starting risk scoring service...
2025-05-23 17:27:24,881 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:27:24,886 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.004s]
2025-05-23 17:27:24,886 - __main__ - INFO - Risk scoring service started
2025-05-23 17:27:24,887 - risk_scoring - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 17:27:24,887 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:27:24,887 - __main__ - INFO - All services started successfully
2025-05-23 17:27:24,888 - risk_scoring - INFO - Loading asset criticality from config/asset_criticality.json
2025-05-23 17:27:24,888 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:27:24,888 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 17:27:24,888 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:27:24,889 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 17:27:25,013 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.034s]
2025-05-23 17:27:25,055 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 17:27:25,132 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 17:27:25,137 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-05-23 17:27:25,137 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 17:27:25,138 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 17:27:25,142 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 17:27:25,142 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 17:27:25,142 - risk_scoring - INFO - Calculating risk scores
2025-05-23 17:27:25,143 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 17:27:25,147 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 17:27:25,164 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.016s]
2025-05-23 17:27:25,164 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 17:27:25,164 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 17:28:42,426 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:28:42,427 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:28:42,431 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.004s]
2025-05-23 17:28:42,431 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:28:42,431 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:28:42,431 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:32:24,988 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:32:24,988 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:32:24,992 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.004s]
2025-05-23 17:32:24,993 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:32:24,993 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:32:24,993 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:33:42,522 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:33:42,523 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:33:42,525 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.002s]
2025-05-23 17:33:42,526 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:33:42,526 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:33:42,526 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:37:25,091 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:37:25,091 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:37:25,095 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 17:37:25,095 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:37:25,095 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:37:25,095 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:38:42,350 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 17:38:42,350 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 17:38:42,383 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.028s]
2025-05-23 17:38:42,417 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 17:38:42,456 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 17:38:42,462 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-05-23 17:38:42,463 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 17:38:42,463 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 17:38:42,468 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 17:38:42,468 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 17:38:42,469 - risk_scoring - INFO - Calculating risk scores
2025-05-23 17:38:42,471 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 17:38:42,476 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 17:38:42,491 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.014s]
2025-05-23 17:38:42,491 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 17:38:42,491 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 17:38:42,623 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:38:42,624 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:38:42,627 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 17:38:42,627 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:38:42,627 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:38:42,627 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:42:25,177 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:42:25,178 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:42:25,182 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.004s]
2025-05-23 17:42:25,183 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:42:25,183 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:42:25,183 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:42:25,262 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 17:42:25,262 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 17:42:25,301 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.034s]
2025-05-23 17:42:25,340 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 17:42:25,385 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 17:42:25,393 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-05-23 17:42:25,393 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 17:42:25,394 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 17:42:25,401 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.004s]
2025-05-23 17:42:25,402 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 17:42:25,403 - risk_scoring - INFO - Calculating risk scores
2025-05-23 17:42:25,405 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 17:42:25,410 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 17:42:25,433 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.021s]
2025-05-23 17:42:25,433 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 17:42:25,434 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 17:43:42,708 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:43:42,708 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:43:42,712 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 17:43:42,712 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:43:42,712 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:43:42,712 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:47:25,211 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:47:25,211 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:47:25,215 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 17:47:25,215 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:47:25,215 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:47:25,215 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:48:42,813 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:48:42,814 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:48:42,817 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 17:48:42,817 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:48:42,817 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:48:42,817 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:52:25,278 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:52:25,279 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:52:25,282 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 17:52:25,282 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:52:25,282 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:52:25,282 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:53:42,572 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 17:53:42,572 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 17:53:42,617 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.037s]
2025-05-23 17:53:42,668 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 17:53:42,725 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 17:53:42,733 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-05-23 17:53:42,733 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 17:53:42,734 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 17:53:42,739 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 17:53:42,740 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 17:53:42,740 - risk_scoring - INFO - Calculating risk scores
2025-05-23 17:53:42,743 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 17:53:42,748 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 17:53:42,766 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.016s]
2025-05-23 17:53:42,766 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 17:53:42,766 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 17:53:42,910 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:53:42,910 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:53:42,914 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 17:53:42,914 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:53:42,914 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:53:42,914 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:57:25,379 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:57:25,379 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:57:25,381 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.002s]
2025-05-23 17:57:25,382 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:57:25,382 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:57:25,382 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 17:57:25,534 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 17:57:25,534 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 17:57:25,564 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.026s]
2025-05-23 17:57:25,597 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 17:57:25,636 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 17:57:25,641 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 17:57:25,641 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 17:57:25,642 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 17:57:25,646 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 17:57:25,646 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 17:57:25,646 - risk_scoring - INFO - Calculating risk scores
2025-05-23 17:57:25,648 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 17:57:25,651 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 17:57:25,664 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.012s]
2025-05-23 17:57:25,664 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 17:57:25,664 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 17:58:42,992 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 17:58:42,993 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 17:58:42,995 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.002s]
2025-05-23 17:58:42,995 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 17:58:42,995 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 17:58:42,995 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:02:25,465 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:02:25,466 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:02:25,469 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 18:02:25,470 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 18:02:25,470 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 18:02:25,470 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:03:43,104 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:03:43,105 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:03:43,112 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.004s]
2025-05-23 18:03:43,112 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 18:03:43,112 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 18:03:43,112 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:07:25,555 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:07:25,555 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:07:25,559 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 18:07:25,560 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 18:07:25,560 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 18:07:25,560 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:08:42,865 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 18:08:42,865 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 18:08:42,900 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.029s]
2025-05-23 18:08:43,036 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 18:08:43,085 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 18:08:43,092 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-05-23 18:08:43,092 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 18:08:43,093 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 18:08:43,097 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 18:08:43,097 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 18:08:43,098 - risk_scoring - INFO - Calculating risk scores
2025-05-23 18:08:43,100 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 18:08:43,104 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 18:08:43,117 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.012s]
2025-05-23 18:08:43,118 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 18:08:43,118 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 18:08:43,211 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:08:43,211 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:08:43,214 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 18:08:43,215 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 18:08:43,215 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 18:08:43,215 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:12:25,649 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:12:25,649 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:12:25,653 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 18:12:25,653 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 18:12:25,653 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 18:12:25,653 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:12:25,761 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 18:12:25,761 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 18:12:25,808 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.036s]
2025-05-23 18:12:25,985 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 18:12:26,045 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 18:12:26,053 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.003s]
2025-05-23 18:12:26,053 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 18:12:26,054 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 18:12:26,065 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.004s]
2025-05-23 18:12:26,065 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 18:12:26,067 - risk_scoring - INFO - Calculating risk scores
2025-05-23 18:12:26,069 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 18:12:26,074 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 18:12:26,094 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.019s]
2025-05-23 18:12:26,095 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 18:12:26,095 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 18:13:43,277 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:13:43,277 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:13:43,280 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.002s]
2025-05-23 18:13:43,280 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 18:13:43,280 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 18:13:43,280 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:17:25,754 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:17:25,755 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:17:25,758 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 18:17:25,758 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 18:17:25,759 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 18:17:25,759 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:18:43,379 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:18:43,380 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:18:43,386 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.005s]
2025-05-23 18:18:43,387 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 18:18:43,387 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 18:18:43,387 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:22:25,859 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:22:25,859 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:22:25,863 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.004s]
2025-05-23 18:22:25,864 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 18:22:25,864 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 18:22:25,864 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:23:43,204 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 18:23:43,204 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 18:23:43,237 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.028s]
2025-05-23 18:23:43,286 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 18:23:43,346 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 18:23:43,355 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-05-23 18:23:43,356 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 18:23:43,356 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 18:23:43,365 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.004s]
2025-05-23 18:23:43,365 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 18:23:43,366 - risk_scoring - INFO - Calculating risk scores
2025-05-23 18:23:43,368 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 18:23:43,373 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 18:23:43,393 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.019s]
2025-05-23 18:23:43,394 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 18:23:43,394 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 18:23:43,465 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:23:43,465 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:23:43,469 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 18:23:43,469 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 18:23:43,469 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 18:23:43,469 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:27:25,966 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:27:25,966 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:27:25,970 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 18:27:25,970 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 18:27:25,970 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 18:27:25,970 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:27:26,196 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 18:27:26,198 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 18:27:26,264 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.057s]
2025-05-23 18:27:26,307 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 18:27:26,350 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 18:27:26,355 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 18:27:26,355 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 18:27:26,356 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 18:27:26,363 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 18:27:26,364 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 18:27:26,364 - risk_scoring - INFO - Calculating risk scores
2025-05-23 18:27:26,366 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 18:27:26,371 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 18:27:26,384 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.012s]
2025-05-23 18:27:26,385 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 18:27:26,385 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 18:28:43,561 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:28:43,561 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:28:43,564 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.002s]
2025-05-23 18:28:43,564 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 18:28:43,564 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 18:28:43,564 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:32:26,060 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:32:26,060 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:32:26,064 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-23 18:32:26,064 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 18:32:26,064 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 18:32:26,064 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:33:43,664 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:33:43,664 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:33:43,667 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.002s]
2025-05-23 18:33:43,667 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-23 18:33:43,667 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-23 18:33:43,667 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:37:26,157 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:37:26,158 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:37:26,202 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.043s]
2025-05-23 18:37:26,209 - anomaly_detection - INFO - Loaded 182 records from Elasticsearch
2025-05-23 18:37:26,244 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 18:37:26,366 - anomaly_detection - INFO - Detected 10 anomalies
2025-05-23 18:37:26,370 - anomaly_detection - INFO - Indexing 10 anomalies to security-anomalies
2025-05-23 18:37:26,379 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 18:37:26,380 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:37:26,380 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 18:37:26,388 - anomaly_detection - INFO - Detected 10 anomalies
2025-05-23 18:37:26,389 - anomaly_detection - INFO - Indexing 10 anomalies to security-anomalies
2025-05-23 18:37:26,396 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 18:37:26,397 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:37:26,397 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:38:43,491 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 18:38:43,492 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 18:38:43,537 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.038s]
2025-05-23 18:38:43,639 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 18:38:43,679 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 18:38:43,688 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.005s]
2025-05-23 18:38:43,688 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 18:38:43,689 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 18:38:43,699 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.006s]
2025-05-23 18:38:43,699 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 18:38:43,700 - risk_scoring - INFO - Calculating risk scores
2025-05-23 18:38:43,702 - risk_scoring - INFO - Calculating risk scores for 3 assets
2025-05-23 18:38:43,709 - risk_scoring - INFO - Indexing 3 risk scores to security-risk-scores
2025-05-23 18:38:43,733 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.023s]
2025-05-23 18:38:43,733 - risk_scoring - INFO - Successfully indexed 3 risk scores, errors: []
2025-05-23 18:38:43,733 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 18:38:43,767 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:38:43,767 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:38:43,823 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.055s]
2025-05-23 18:38:43,835 - anomaly_detection - INFO - Loaded 301 records from Elasticsearch
2025-05-23 18:38:43,845 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 18:38:43,964 - anomaly_detection - INFO - Detected 15 anomalies
2025-05-23 18:38:43,968 - anomaly_detection - INFO - Indexing 15 anomalies to security-anomalies
2025-05-23 18:38:43,973 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.004s]
2025-05-23 18:38:43,974 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:38:43,974 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 18:38:43,978 - anomaly_detection - INFO - Detected 15 anomalies
2025-05-23 18:38:43,978 - anomaly_detection - INFO - Indexing 15 anomalies to security-anomalies
2025-05-23 18:38:43,986 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-05-23 18:38:43,986 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:38:43,986 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:42:26,482 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 18:42:26,482 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 18:42:26,497 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:42:26,497 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:42:26,506 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.021s]
2025-05-23 18:42:26,584 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 18:42:26,619 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 18:42:26,623 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.126s]
2025-05-23 18:42:26,641 - anomaly_detection - INFO - Loaded 659 records from Elasticsearch
2025-05-23 18:42:26,649 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 18:42:26,654 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 18:42:26,655 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 18:42:26,659 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 18:42:26,670 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.007s]
2025-05-23 18:42:26,672 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 18:42:26,673 - risk_scoring - INFO - Calculating risk scores
2025-05-23 18:42:26,678 - risk_scoring - INFO - Calculating risk scores for 3 assets
2025-05-23 18:42:26,689 - risk_scoring - INFO - Indexing 3 risk scores to security-risk-scores
2025-05-23 18:42:26,702 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.013s]
2025-05-23 18:42:26,703 - risk_scoring - INFO - Successfully indexed 3 risk scores, errors: []
2025-05-23 18:42:26,703 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 18:42:26,780 - anomaly_detection - INFO - Detected 33 anomalies
2025-05-23 18:42:26,784 - anomaly_detection - INFO - Indexing 33 anomalies to security-anomalies
2025-05-23 18:42:26,791 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.004s]
2025-05-23 18:42:26,792 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:42:26,792 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 18:42:26,799 - anomaly_detection - INFO - Detected 33 anomalies
2025-05-23 18:42:26,800 - anomaly_detection - INFO - Indexing 33 anomalies to security-anomalies
2025-05-23 18:42:26,807 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.004s]
2025-05-23 18:42:26,807 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:42:26,807 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:43:44,077 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:43:44,078 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:43:44,147 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.069s]
2025-05-23 18:43:44,180 - anomaly_detection - INFO - Loaded 770 records from Elasticsearch
2025-05-23 18:43:44,201 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 18:43:44,317 - anomaly_detection - INFO - Detected 39 anomalies
2025-05-23 18:43:44,323 - anomaly_detection - INFO - Indexing 39 anomalies to security-anomalies
2025-05-23 18:43:44,333 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 18:43:44,333 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:43:44,333 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 18:43:44,344 - anomaly_detection - INFO - Detected 39 anomalies
2025-05-23 18:43:44,344 - anomaly_detection - INFO - Indexing 39 anomalies to security-anomalies
2025-05-23 18:43:44,356 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 18:43:44,357 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:43:44,357 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:51:23,645 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:51:23,646 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:51:23,735 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.089s]
2025-05-23 18:51:23,823 - anomaly_detection - INFO - Loaded 999 records from Elasticsearch
2025-05-23 18:51:23,843 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 18:51:23,960 - anomaly_detection - INFO - Detected 50 anomalies
2025-05-23 18:51:23,966 - anomaly_detection - INFO - Indexing 50 anomalies to security-anomalies
2025-05-23 18:51:23,976 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-05-23 18:51:23,977 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:51:23,977 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 18:51:23,988 - anomaly_detection - INFO - Detected 50 anomalies
2025-05-23 18:51:23,988 - anomaly_detection - INFO - Indexing 50 anomalies to security-anomalies
2025-05-23 18:51:24,001 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 18:51:24,002 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:51:24,002 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:52:41,255 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:52:41,256 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:52:41,300 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.043s]
2025-05-23 18:52:41,452 - anomaly_detection - INFO - Loaded 1015 records from Elasticsearch
2025-05-23 18:52:41,481 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 18:52:41,591 - anomaly_detection - INFO - Detected 51 anomalies
2025-05-23 18:52:41,596 - anomaly_detection - INFO - Indexing 51 anomalies to security-anomalies
2025-05-23 18:52:41,607 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-05-23 18:52:41,607 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:52:41,607 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 18:52:41,618 - anomaly_detection - INFO - Detected 51 anomalies
2025-05-23 18:52:41,619 - anomaly_detection - INFO - Indexing 51 anomalies to security-anomalies
2025-05-23 18:52:41,630 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 18:52:41,630 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:52:41,630 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:56:24,038 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:56:24,038 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:56:24,114 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.075s]
2025-05-23 18:56:24,194 - anomaly_detection - INFO - Loaded 1419 records from Elasticsearch
2025-05-23 18:56:24,236 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 18:56:24,361 - anomaly_detection - INFO - Detected 71 anomalies
2025-05-23 18:56:24,368 - anomaly_detection - INFO - Indexing 71 anomalies to security-anomalies
2025-05-23 18:56:24,386 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.011s]
2025-05-23 18:56:24,387 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:56:24,388 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 18:56:24,407 - anomaly_detection - INFO - Detected 70 anomalies
2025-05-23 18:56:24,407 - anomaly_detection - INFO - Indexing 70 anomalies to security-anomalies
2025-05-23 18:56:24,423 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 18:56:24,423 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:56:24,423 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 18:57:40,630 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 18:57:40,630 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 18:57:40,711 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.069s]
2025-05-23 18:57:40,753 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 18:57:40,799 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 18:57:40,804 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 18:57:40,804 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 18:57:40,805 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 18:57:40,810 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 18:57:40,810 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 18:57:40,811 - risk_scoring - INFO - Calculating risk scores
2025-05-23 18:57:40,812 - risk_scoring - INFO - Calculating risk scores for 3 assets
2025-05-23 18:57:40,819 - risk_scoring - INFO - Indexing 3 risk scores to security-risk-scores
2025-05-23 18:57:40,833 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.013s]
2025-05-23 18:57:40,833 - risk_scoring - INFO - Successfully indexed 3 risk scores, errors: []
2025-05-23 18:57:40,833 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 18:57:41,730 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 18:57:41,730 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 18:57:41,750 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.019s]
2025-05-23 18:57:41,877 - anomaly_detection - INFO - Loaded 1550 records from Elasticsearch
2025-05-23 18:57:41,902 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 18:57:42,025 - anomaly_detection - INFO - Detected 78 anomalies
2025-05-23 18:57:42,032 - anomaly_detection - INFO - Indexing 78 anomalies to security-anomalies
2025-05-23 18:57:42,045 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-05-23 18:57:42,045 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:57:42,045 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 18:57:42,064 - anomaly_detection - INFO - Detected 78 anomalies
2025-05-23 18:57:42,064 - anomaly_detection - INFO - Indexing 78 anomalies to security-anomalies
2025-05-23 18:57:42,077 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-05-23 18:57:42,077 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 18:57:42,077 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:01:23,602 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 19:01:23,603 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 19:01:23,726 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.053s]
2025-05-23 19:01:23,996 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 19:01:24,045 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 19:01:24,050 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-23 19:01:24,050 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 19:01:24,050 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 19:01:24,068 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.015s]
2025-05-23 19:01:24,068 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 19:01:24,069 - risk_scoring - INFO - Calculating risk scores
2025-05-23 19:01:24,070 - risk_scoring - INFO - Calculating risk scores for 3 assets
2025-05-23 19:01:24,076 - risk_scoring - INFO - Indexing 3 risk scores to security-risk-scores
2025-05-23 19:01:24,094 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.017s]
2025-05-23 19:01:24,094 - risk_scoring - INFO - Successfully indexed 3 risk scores, errors: []
2025-05-23 19:01:24,094 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 19:01:24,523 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:01:24,524 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:01:24,581 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.057s]
2025-05-23 19:01:24,723 - anomaly_detection - INFO - Loaded 1898 records from Elasticsearch
2025-05-23 19:01:24,763 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 19:01:24,887 - anomaly_detection - INFO - Detected 95 anomalies
2025-05-23 19:01:24,894 - anomaly_detection - INFO - Indexing 95 anomalies to security-anomalies
2025-05-23 19:01:24,912 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 19:01:24,913 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:01:24,913 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 19:01:24,938 - anomaly_detection - INFO - Detected 95 anomalies
2025-05-23 19:01:24,938 - anomaly_detection - INFO - Indexing 95 anomalies to security-anomalies
2025-05-23 19:01:24,958 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-05-23 19:01:24,958 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:01:24,959 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:02:42,169 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:02:42,169 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:02:42,215 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.046s]
2025-05-23 19:02:42,366 - anomaly_detection - INFO - Loaded 2023 records from Elasticsearch
2025-05-23 19:02:42,400 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 19:02:42,516 - anomaly_detection - INFO - Detected 102 anomalies
2025-05-23 19:02:42,524 - anomaly_detection - INFO - Indexing 102 anomalies to security-anomalies
2025-05-23 19:02:42,540 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-05-23 19:02:42,540 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:02:42,540 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 19:02:42,567 - anomaly_detection - INFO - Detected 102 anomalies
2025-05-23 19:02:42,567 - anomaly_detection - INFO - Indexing 102 anomalies to security-anomalies
2025-05-23 19:02:42,581 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-05-23 19:02:42,582 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:02:42,582 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:06:41,851 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:06:41,915 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:06:42,497 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.459s]
2025-05-23 19:06:47,066 - anomaly_detection - INFO - Loaded 2411 records from Elasticsearch
2025-05-23 19:06:47,143 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 19:06:47,308 - anomaly_detection - INFO - Detected 121 anomalies
2025-05-23 19:06:47,318 - anomaly_detection - INFO - Indexing 121 anomalies to security-anomalies
2025-05-23 19:06:47,357 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.025s]
2025-05-23 19:06:47,359 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:06:47,360 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 19:06:47,415 - anomaly_detection - INFO - Detected 121 anomalies
2025-05-23 19:06:47,416 - anomaly_detection - INFO - Indexing 121 anomalies to security-anomalies
2025-05-23 19:06:47,453 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.025s]
2025-05-23 19:06:47,454 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:06:47,455 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:07:59,504 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:07:59,584 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:08:00,092 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.363s]
2025-05-23 19:08:03,676 - anomaly_detection - INFO - Loaded 2527 records from Elasticsearch
2025-05-23 19:08:03,719 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 19:08:03,849 - anomaly_detection - INFO - Detected 126 anomalies
2025-05-23 19:08:03,857 - anomaly_detection - INFO - Indexing 126 anomalies to security-anomalies
2025-05-23 19:08:03,881 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.012s]
2025-05-23 19:08:03,882 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:08:03,882 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 19:08:03,922 - anomaly_detection - INFO - Detected 126 anomalies
2025-05-23 19:08:03,922 - anomaly_detection - INFO - Indexing 126 anomalies to security-anomalies
2025-05-23 19:08:03,946 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.012s]
2025-05-23 19:08:03,947 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:08:03,947 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:13:54,098 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:13:54,100 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:13:54,578 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.477s]
2025-05-23 19:13:54,895 - anomaly_detection - INFO - Loaded 3086 records from Elasticsearch
2025-05-23 19:13:54,965 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 19:13:55,198 - anomaly_detection - INFO - Detected 155 anomalies
2025-05-23 19:13:55,222 - anomaly_detection - INFO - Indexing 155 anomalies to security-anomalies
2025-05-23 19:13:55,274 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.023s]
2025-05-23 19:13:55,275 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:13:55,275 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 19:13:55,366 - anomaly_detection - INFO - Detected 155 anomalies
2025-05-23 19:13:55,367 - anomaly_detection - INFO - Indexing 155 anomalies to security-anomalies
2025-05-23 19:13:55,421 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.028s]
2025-05-23 19:13:55,423 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:13:55,423 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:15:40,417 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 19:15:40,435 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 19:15:41,069 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.041s]
2025-05-23 19:15:41,074 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 1 times in a row, putting on 1 second timeout
2025-05-23 19:15:41,078 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e903f9b40>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e903f9b40>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:15:41,153 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.002s]
2025-05-23 19:15:41,153 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 2 times in a row, putting on 2 second timeout
2025-05-23 19:15:41,153 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041ac80>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041ac80>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:15:41,155 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.001s]
2025-05-23 19:15:41,155 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 3 times in a row, putting on 4 second timeout
2025-05-23 19:15:41,155 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e90418a30>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e90418a30>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:15:41,157 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.002s]
2025-05-23 19:15:41,157 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 4 times in a row, putting on 8 second timeout
2025-05-23 19:15:41,158 - risk_scoring - ERROR - Error loading anomalies from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e903f9b40>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:15:41,363 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 19:15:41,368 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.001s]
2025-05-23 19:15:41,369 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 5 times in a row, putting on 16 second timeout
2025-05-23 19:15:41,369 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e904197b0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e904197b0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:15:41,370 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.001s]
2025-05-23 19:15:41,370 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 6 times in a row, putting on 30 second timeout
2025-05-23 19:15:41,370 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041b160>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041b160>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:15:41,371 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.000s]
2025-05-23 19:15:41,371 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 7 times in a row, putting on 30 second timeout
2025-05-23 19:15:41,371 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e90418eb0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e90418eb0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:15:41,372 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.001s]
2025-05-23 19:15:41,372 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 8 times in a row, putting on 30 second timeout
2025-05-23 19:15:41,372 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e904197b0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:15:41,373 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 19:15:41,377 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.001s]
2025-05-23 19:15:41,377 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 9 times in a row, putting on 30 second timeout
2025-05-23 19:15:41,377 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041b220>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041b220>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:15:41,378 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.000s]
2025-05-23 19:15:41,379 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 10 times in a row, putting on 30 second timeout
2025-05-23 19:15:41,379 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041a6e0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041a6e0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:15:41,380 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.002s]
2025-05-23 19:15:41,381 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 11 times in a row, putting on 30 second timeout
2025-05-23 19:15:41,381 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041b4f0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041b4f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:15:41,382 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.000s]
2025-05-23 19:15:41,382 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 12 times in a row, putting on 30 second timeout
2025-05-23 19:15:41,382 - risk_scoring - ERROR - Error loading compliance issues from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041b220>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:15:41,384 - risk_scoring - INFO - Calculating risk scores
2025-05-23 19:15:41,385 - risk_scoring - WARNING - No assets found for risk scoring
2025-05-23 19:15:41,386 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 19:15:46,750 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:15:46,754 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:15:46,997 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.242s]
2025-05-23 19:15:48,378 - anomaly_detection - INFO - Loaded 3189 records from Elasticsearch
2025-05-23 19:15:48,435 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 19:15:48,584 - anomaly_detection - INFO - Detected 158 anomalies
2025-05-23 19:15:48,594 - anomaly_detection - INFO - Indexing 158 anomalies to security-anomalies
2025-05-23 19:15:48,681 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.073s]
2025-05-23 19:15:48,681 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:15:48,681 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 19:15:48,738 - anomaly_detection - INFO - Detected 160 anomalies
2025-05-23 19:15:48,738 - anomaly_detection - INFO - Indexing 160 anomalies to security-anomalies
2025-05-23 19:15:48,813 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.060s]
2025-05-23 19:15:48,813 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:15:48,814 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:19:23,688 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 19:19:23,721 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 19:19:24,971 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.165s]
2025-05-23 19:19:25,555 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 19:19:25,928 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 19:19:25,935 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.003s]
2025-05-23 19:19:25,939 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 19:19:25,994 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 19:19:26,016 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.017s]
2025-05-23 19:19:26,016 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 19:19:26,020 - risk_scoring - INFO - Calculating risk scores
2025-05-23 19:19:26,051 - risk_scoring - INFO - Calculating risk scores for 3 assets
2025-05-23 19:19:26,094 - risk_scoring - INFO - Indexing 3 risk scores to security-risk-scores
2025-05-23 19:19:26,133 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.017s]
2025-05-23 19:19:26,133 - risk_scoring - INFO - Successfully indexed 3 risk scores, errors: []
2025-05-23 19:19:26,133 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 19:19:31,690 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:19:31,693 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:19:31,967 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.273s]
2025-05-23 19:19:34,694 - anomaly_detection - INFO - Loaded 3611 records from Elasticsearch
2025-05-23 19:19:34,767 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 19:19:34,917 - anomaly_detection - INFO - Detected 181 anomalies
2025-05-23 19:19:34,927 - anomaly_detection - INFO - Indexing 181 anomalies to security-anomalies
2025-05-23 19:19:34,962 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.015s]
2025-05-23 19:19:34,963 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:19:34,963 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 19:19:35,038 - anomaly_detection - INFO - Detected 181 anomalies
2025-05-23 19:19:35,039 - anomaly_detection - INFO - Indexing 181 anomalies to security-anomalies
2025-05-23 19:19:35,072 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.014s]
2025-05-23 19:19:35,073 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:19:35,073 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:20:48,908 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:20:48,912 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:20:49,139 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.212s]
2025-05-23 19:20:49,923 - anomaly_detection - INFO - Loaded 3728 records from Elasticsearch
2025-05-23 19:20:49,994 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 19:20:50,121 - anomaly_detection - INFO - Detected 187 anomalies
2025-05-23 19:20:50,131 - anomaly_detection - INFO - Indexing 187 anomalies to security-anomalies
2025-05-23 19:20:50,162 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.013s]
2025-05-23 19:20:50,163 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:20:50,163 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 19:20:50,235 - anomaly_detection - INFO - Detected 187 anomalies
2025-05-23 19:20:50,236 - anomaly_detection - INFO - Indexing 187 anomalies to security-anomalies
2025-05-23 19:20:50,267 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.013s]
2025-05-23 19:20:50,268 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:20:50,268 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:24:35,159 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:24:35,179 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:24:35,411 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.209s]
2025-05-23 19:24:36,245 - anomaly_detection - INFO - Loaded 4094 records from Elasticsearch
2025-05-23 19:24:36,353 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 19:24:36,491 - anomaly_detection - INFO - Detected 205 anomalies
2025-05-23 19:24:36,503 - anomaly_detection - INFO - Indexing 205 anomalies to security-anomalies
2025-05-23 19:24:36,544 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.020s]
2025-05-23 19:24:36,546 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:24:36,546 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 19:24:36,648 - anomaly_detection - INFO - Detected 205 anomalies
2025-05-23 19:24:36,649 - anomaly_detection - INFO - Indexing 205 anomalies to security-anomalies
2025-05-23 19:24:36,684 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.015s]
2025-05-23 19:24:36,685 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:24:36,685 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:25:50,391 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:25:50,437 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:25:50,962 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.428s]
2025-05-23 19:25:53,330 - anomaly_detection - INFO - Loaded 4225 records from Elasticsearch
2025-05-23 19:25:53,406 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 19:25:53,537 - anomaly_detection - INFO - Detected 211 anomalies
2025-05-23 19:25:53,547 - anomaly_detection - INFO - Indexing 211 anomalies to security-anomalies
2025-05-23 19:25:53,586 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.020s]
2025-05-23 19:25:53,587 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:25:53,587 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 19:25:53,683 - anomaly_detection - INFO - Detected 212 anomalies
2025-05-23 19:25:53,683 - anomaly_detection - INFO - Indexing 212 anomalies to security-anomalies
2025-05-23 19:25:53,712 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.011s]
2025-05-23 19:25:53,712 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:25:53,713 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:29:36,625 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:29:36,639 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:29:37,076 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.407s]
2025-05-23 19:29:37,488 - anomaly_detection - INFO - Loaded 4593 records from Elasticsearch
2025-05-23 19:29:37,564 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 19:29:37,708 - anomaly_detection - INFO - Detected 229 anomalies
2025-05-23 19:29:37,720 - anomaly_detection - INFO - Indexing 229 anomalies to security-anomalies
2025-05-23 19:29:37,756 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.013s]
2025-05-23 19:29:37,757 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:29:37,757 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 19:29:37,877 - anomaly_detection - INFO - Detected 230 anomalies
2025-05-23 19:29:37,878 - anomaly_detection - INFO - Indexing 230 anomalies to security-anomalies
2025-05-23 19:29:37,909 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 19:29:37,909 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:29:37,910 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:30:41,340 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 19:30:41,346 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 19:30:41,465 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:30:42,069 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.604s]
2025-05-23 19:30:42,483 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has been marked alive after a successful request
2025-05-23 19:30:42,485 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 19:30:42,544 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 19:30:42,552 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:30:42,557 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.005s]
2025-05-23 19:30:42,557 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 19:30:42,561 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 19:30:42,566 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:30:42,591 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.025s]
2025-05-23 19:30:42,592 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 19:30:42,595 - risk_scoring - INFO - Calculating risk scores
2025-05-23 19:30:42,603 - risk_scoring - INFO - Calculating risk scores for 3 assets
2025-05-23 19:30:42,621 - risk_scoring - INFO - Indexing 3 risk scores to security-risk-scores
2025-05-23 19:30:42,623 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:30:42,641 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.018s]
2025-05-23 19:30:42,642 - risk_scoring - INFO - Successfully indexed 3 risk scores, errors: []
2025-05-23 19:30:42,642 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 19:30:53,676 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:30:53,687 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:30:54,160 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.469s]
2025-05-23 19:30:55,871 - anomaly_detection - INFO - Loaded 4737 records from Elasticsearch
2025-05-23 19:30:56,068 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 19:30:56,324 - anomaly_detection - INFO - Detected 237 anomalies
2025-05-23 19:30:56,336 - anomaly_detection - INFO - Indexing 237 anomalies to security-anomalies
2025-05-23 19:30:56,372 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-05-23 19:30:56,373 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:30:56,373 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 19:30:56,519 - anomaly_detection - INFO - Detected 237 anomalies
2025-05-23 19:30:56,519 - anomaly_detection - INFO - Indexing 237 anomalies to security-anomalies
2025-05-23 19:30:56,579 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.031s]
2025-05-23 19:30:56,580 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:30:56,580 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:34:26,067 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 19:34:26,090 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 19:34:26,365 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.024s]
2025-05-23 19:34:26,366 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 1 times in a row, putting on 1 second timeout
2025-05-23 19:34:26,366 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b6113c0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b6113c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:34:26,408 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.002s]
2025-05-23 19:34:26,409 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 2 times in a row, putting on 2 second timeout
2025-05-23 19:34:26,409 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b6127d0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b6127d0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:34:26,411 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.001s]
2025-05-23 19:34:26,411 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 3 times in a row, putting on 4 second timeout
2025-05-23 19:34:26,412 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b612d70>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b612d70>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:34:26,414 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.001s]
2025-05-23 19:34:26,414 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 4 times in a row, putting on 8 second timeout
2025-05-23 19:34:26,414 - risk_scoring - ERROR - Error loading anomalies from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b6113c0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:34:26,621 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 19:34:26,631 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.001s]
2025-05-23 19:34:26,632 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 5 times in a row, putting on 16 second timeout
2025-05-23 19:34:26,632 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b613130>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b613130>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:34:26,633 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.000s]
2025-05-23 19:34:26,633 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 6 times in a row, putting on 30 second timeout
2025-05-23 19:34:26,633 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b6131c0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b6131c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:34:26,633 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.000s]
2025-05-23 19:34:26,633 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 7 times in a row, putting on 30 second timeout
2025-05-23 19:34:26,633 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b611ae0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b611ae0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:34:26,635 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.001s]
2025-05-23 19:34:26,635 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 8 times in a row, putting on 30 second timeout
2025-05-23 19:34:26,635 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b613130>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:34:26,636 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 19:34:26,643 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.001s]
2025-05-23 19:34:26,643 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 9 times in a row, putting on 30 second timeout
2025-05-23 19:34:26,643 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b6127a0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b6127a0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:34:26,645 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.001s]
2025-05-23 19:34:26,645 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 10 times in a row, putting on 30 second timeout
2025-05-23 19:34:26,645 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b6136a0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b6136a0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:34:26,647 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.001s]
2025-05-23 19:34:26,647 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 11 times in a row, putting on 30 second timeout
2025-05-23 19:34:26,647 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b611db0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b611db0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:34:26,648 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.000s]
2025-05-23 19:34:26,648 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 12 times in a row, putting on 30 second timeout
2025-05-23 19:34:26,648 - risk_scoring - ERROR - Error loading compliance issues from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b6127a0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:34:26,650 - risk_scoring - INFO - Calculating risk scores
2025-05-23 19:34:26,650 - risk_scoring - WARNING - No assets found for risk scoring
2025-05-23 19:34:26,652 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 19:34:37,994 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:34:37,995 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:34:37,997 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.002s]
2025-05-23 19:34:37,997 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 1 times in a row, putting on 1 second timeout
2025-05-23 19:34:37,998 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b5e5870>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b5e5870>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:34:37,998 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:34:37,998 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 2 times in a row, putting on 2 second timeout
2025-05-23 19:34:37,999 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b612380>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b612380>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:34:38,000 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.001s]
2025-05-23 19:34:38,000 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 3 times in a row, putting on 4 second timeout
2025-05-23 19:34:38,000 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b611270>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b611270>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:34:38,004 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.002s]
2025-05-23 19:34:38,004 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 4 times in a row, putting on 8 second timeout
2025-05-23 19:34:38,004 - anomaly_detection - ERROR - Error loading data from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b5e5870>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:34:38,191 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:35:56,678 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:35:56,678 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:35:56,702 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.003s]
2025-05-23 19:35:56,702 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 1 times in a row, putting on 1 second timeout
2025-05-23 19:35:56,702 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e903f9300>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e903f9300>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:35:56,704 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:35:56,704 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 2 times in a row, putting on 2 second timeout
2025-05-23 19:35:56,705 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041b550>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041b550>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:35:56,706 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.001s]
2025-05-23 19:35:56,706 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 3 times in a row, putting on 4 second timeout
2025-05-23 19:35:56,706 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041a710>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041a710>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:35:56,706 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:35:56,706 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 4 times in a row, putting on 8 second timeout
2025-05-23 19:35:56,707 - anomaly_detection - ERROR - Error loading data from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e903f9300>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:35:56,737 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:39:38,266 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:39:38,266 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:39:38,267 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:39:38,267 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:39:38,267 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 5 times in a row, putting on 16 second timeout
2025-05-23 19:39:38,267 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b6137f0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b6137f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:39:38,268 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:39:38,268 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:39:38,268 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 6 times in a row, putting on 30 second timeout
2025-05-23 19:39:38,268 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b612c50>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b612c50>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:39:38,268 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:39:38,268 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:39:38,268 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 7 times in a row, putting on 30 second timeout
2025-05-23 19:39:38,268 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b6129e0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b6129e0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:39:38,269 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:39:38,269 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:39:38,269 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 8 times in a row, putting on 30 second timeout
2025-05-23 19:39:38,269 - anomaly_detection - ERROR - Error loading data from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b6137f0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:39:38,269 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:40:56,838 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:40:56,838 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:40:56,839 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:40:56,839 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:40:56,839 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 5 times in a row, putting on 16 second timeout
2025-05-23 19:40:56,839 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041aec0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041aec0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:40:56,840 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:40:56,841 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.001s]
2025-05-23 19:40:56,841 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 6 times in a row, putting on 30 second timeout
2025-05-23 19:40:56,841 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e90419db0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e90419db0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:40:56,841 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:40:56,842 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.001s]
2025-05-23 19:40:56,842 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 7 times in a row, putting on 30 second timeout
2025-05-23 19:40:56,842 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e90418bb0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e90418bb0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:40:56,842 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:40:56,842 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:40:56,842 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 8 times in a row, putting on 30 second timeout
2025-05-23 19:40:56,842 - anomaly_detection - ERROR - Error loading data from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041aec0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:40:56,842 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:44:38,370 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:44:38,370 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:44:38,370 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:44:38,371 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.001s]
2025-05-23 19:44:38,371 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 9 times in a row, putting on 30 second timeout
2025-05-23 19:44:38,371 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b6113c0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b6113c0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:44:38,371 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:44:38,372 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:44:38,372 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 10 times in a row, putting on 30 second timeout
2025-05-23 19:44:38,372 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b613fd0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b613fd0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:44:38,372 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:44:38,372 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:44:38,372 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 11 times in a row, putting on 30 second timeout
2025-05-23 19:44:38,372 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7084391342b0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7084391342b0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:44:38,372 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:44:38,373 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:44:38,373 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 12 times in a row, putting on 30 second timeout
2025-05-23 19:44:38,373 - anomaly_detection - ERROR - Error loading data from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b6113c0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:44:38,373 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:45:42,713 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 19:45:42,713 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 19:45:42,748 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:45:42,749 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.000s]
2025-05-23 19:45:42,749 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 1 times in a row, putting on 1 second timeout
2025-05-23 19:45:42,749 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e903fa410>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e903fa410>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:45:42,749 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:45:42,749 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.000s]
2025-05-23 19:45:42,749 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 2 times in a row, putting on 2 second timeout
2025-05-23 19:45:42,749 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e90419060>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e90419060>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:45:42,750 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:45:42,750 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.000s]
2025-05-23 19:45:42,750 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 3 times in a row, putting on 4 second timeout
2025-05-23 19:45:42,750 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041b640>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041b640>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:45:42,750 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:45:42,750 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.000s]
2025-05-23 19:45:42,750 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 4 times in a row, putting on 8 second timeout
2025-05-23 19:45:42,750 - risk_scoring - ERROR - Error loading anomalies from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e903fa410>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:45:42,764 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 19:45:42,768 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:45:42,769 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.000s]
2025-05-23 19:45:42,769 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 5 times in a row, putting on 16 second timeout
2025-05-23 19:45:42,769 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e903fa680>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e903fa680>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:45:42,769 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:45:42,769 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.000s]
2025-05-23 19:45:42,769 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 6 times in a row, putting on 30 second timeout
2025-05-23 19:45:42,770 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041b1f0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041b1f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:45:42,770 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:45:42,770 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.000s]
2025-05-23 19:45:42,770 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 7 times in a row, putting on 30 second timeout
2025-05-23 19:45:42,770 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e90419f30>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e90419f30>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:45:42,770 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:45:42,770 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.000s]
2025-05-23 19:45:42,771 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 8 times in a row, putting on 30 second timeout
2025-05-23 19:45:42,771 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e903fa680>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:45:42,771 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 19:45:42,775 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.000s]
2025-05-23 19:45:42,775 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 9 times in a row, putting on 30 second timeout
2025-05-23 19:45:42,775 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041b340>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041b340>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:45:42,775 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.000s]
2025-05-23 19:45:42,775 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 10 times in a row, putting on 30 second timeout
2025-05-23 19:45:42,775 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041a500>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041a500>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:45:42,776 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.000s]
2025-05-23 19:45:42,776 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 11 times in a row, putting on 30 second timeout
2025-05-23 19:45:42,776 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e90418760>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e90418760>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:45:42,776 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.000s]
2025-05-23 19:45:42,776 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 12 times in a row, putting on 30 second timeout
2025-05-23 19:45:42,776 - risk_scoring - ERROR - Error loading compliance issues from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041b340>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:45:42,777 - risk_scoring - INFO - Calculating risk scores
2025-05-23 19:45:42,777 - risk_scoring - WARNING - No assets found for risk scoring
2025-05-23 19:45:42,778 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 19:45:56,892 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:45:56,892 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:45:56,892 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:45:56,893 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.001s]
2025-05-23 19:45:56,893 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 9 times in a row, putting on 30 second timeout
2025-05-23 19:45:56,893 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e90418e20>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e90418e20>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:45:56,893 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:45:56,893 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:45:56,893 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 10 times in a row, putting on 30 second timeout
2025-05-23 19:45:56,893 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041ac20>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041ac20>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:45:56,894 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:45:56,894 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:45:56,894 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 11 times in a row, putting on 30 second timeout
2025-05-23 19:45:56,894 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041bb50>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041bb50>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:45:56,894 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:45:56,894 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:45:56,894 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 12 times in a row, putting on 30 second timeout
2025-05-23 19:45:56,894 - anomaly_detection - ERROR - Error loading data from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e90418e20>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:45:56,894 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:49:26,727 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 19:49:26,728 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 19:49:26,731 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:26,732 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.001s]
2025-05-23 19:49:26,732 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 13 times in a row, putting on 30 second timeout
2025-05-23 19:49:26,732 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7084391348e0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7084391348e0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:49:26,733 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:26,733 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.000s]
2025-05-23 19:49:26,733 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 14 times in a row, putting on 30 second timeout
2025-05-23 19:49:26,733 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b5e70d0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b5e70d0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:49:26,734 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:26,734 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.000s]
2025-05-23 19:49:26,734 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 15 times in a row, putting on 30 second timeout
2025-05-23 19:49:26,734 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b5e5570>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b5e5570>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:49:26,734 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:26,734 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:N/A duration:0.000s]
2025-05-23 19:49:26,734 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 16 times in a row, putting on 30 second timeout
2025-05-23 19:49:26,734 - risk_scoring - ERROR - Error loading anomalies from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7084391348e0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:49:26,735 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 19:49:26,737 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:26,737 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.000s]
2025-05-23 19:49:26,737 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 17 times in a row, putting on 30 second timeout
2025-05-23 19:49:26,737 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b613fd0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b613fd0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:49:26,738 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:26,738 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.000s]
2025-05-23 19:49:26,738 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 18 times in a row, putting on 30 second timeout
2025-05-23 19:49:26,738 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b613af0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b613af0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:49:26,738 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:26,739 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.000s]
2025-05-23 19:49:26,739 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 19 times in a row, putting on 30 second timeout
2025-05-23 19:49:26,739 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b613d30>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b613d30>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:49:26,739 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:26,739 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:N/A duration:0.000s]
2025-05-23 19:49:26,739 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 20 times in a row, putting on 30 second timeout
2025-05-23 19:49:26,739 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b613fd0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:49:26,740 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 19:49:26,741 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:26,742 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.000s]
2025-05-23 19:49:26,742 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 21 times in a row, putting on 30 second timeout
2025-05-23 19:49:26,742 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b613d90>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b613d90>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:49:26,742 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:26,742 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.000s]
2025-05-23 19:49:26,742 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 22 times in a row, putting on 30 second timeout
2025-05-23 19:49:26,742 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b613460>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b613460>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:49:26,743 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:26,743 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.000s]
2025-05-23 19:49:26,743 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 23 times in a row, putting on 30 second timeout
2025-05-23 19:49:26,744 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b6117e0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b6117e0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:49:26,744 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:26,744 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:N/A duration:0.000s]
2025-05-23 19:49:26,744 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 24 times in a row, putting on 30 second timeout
2025-05-23 19:49:26,744 - risk_scoring - ERROR - Error loading compliance issues from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b613d90>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:49:26,745 - risk_scoring - INFO - Calculating risk scores
2025-05-23 19:49:26,745 - risk_scoring - WARNING - No assets found for risk scoring
2025-05-23 19:49:26,745 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 19:49:38,428 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:49:38,428 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:49:38,428 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:38,429 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:49:38,429 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 13 times in a row, putting on 30 second timeout
2025-05-23 19:49:38,429 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b611450>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b611450>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:49:38,429 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:38,429 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:49:38,429 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 14 times in a row, putting on 30 second timeout
2025-05-23 19:49:38,430 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b612830>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b612830>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:49:38,430 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:38,430 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.001s]
2025-05-23 19:49:38,431 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 15 times in a row, putting on 30 second timeout
2025-05-23 19:49:38,431 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b612950>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b612950>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:49:38,431 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:49:38,431 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:49:38,431 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 16 times in a row, putting on 30 second timeout
2025-05-23 19:49:38,431 - anomaly_detection - ERROR - Error loading data from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b611450>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:49:38,431 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:50:56,972 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:50:56,972 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:50:56,972 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:50:56,973 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.001s]
2025-05-23 19:50:56,973 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 13 times in a row, putting on 30 second timeout
2025-05-23 19:50:56,973 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e90494190>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e90494190>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:50:56,973 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:50:56,974 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:50:56,974 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 14 times in a row, putting on 30 second timeout
2025-05-23 19:50:56,974 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041bdc0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041bdc0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:50:56,974 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:50:56,974 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:50:56,974 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 15 times in a row, putting on 30 second timeout
2025-05-23 19:50:56,974 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041bb50>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041bb50>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:50:56,974 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:50:56,975 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:50:56,975 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 16 times in a row, putting on 30 second timeout
2025-05-23 19:50:56,975 - anomaly_detection - ERROR - Error loading data from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e90494190>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:50:56,975 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:54:38,438 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:54:38,438 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:54:38,439 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:54:38,440 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.001s]
2025-05-23 19:54:38,440 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 17 times in a row, putting on 30 second timeout
2025-05-23 19:54:38,440 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b5e69b0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b5e69b0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:54:38,441 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:54:38,441 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:54:38,441 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 18 times in a row, putting on 30 second timeout
2025-05-23 19:54:38,441 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b611630>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b611630>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:54:38,441 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:54:38,441 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:54:38,441 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 19 times in a row, putting on 30 second timeout
2025-05-23 19:54:38,441 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x70843b613eb0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b613eb0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:54:38,442 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:54:38,442 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:54:38,442 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 20 times in a row, putting on 30 second timeout
2025-05-23 19:54:38,442 - anomaly_detection - ERROR - Error loading data from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x70843b5e69b0>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:54:38,442 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:55:57,068 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:55:57,068 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:55:57,068 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:55:57,069 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:55:57,069 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 17 times in a row, putting on 30 second timeout
2025-05-23 19:55:57,069 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041ad70>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041ad70>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:55:57,069 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:55:57,069 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:55:57,069 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 18 times in a row, putting on 30 second timeout
2025-05-23 19:55:57,070 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041a1a0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041a1a0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:55:57,070 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:55:57,070 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:55:57,070 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 19 times in a row, putting on 30 second timeout
2025-05-23 19:55:57,070 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041b220>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041b220>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-05-23 19:55:57,070 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:55:57,070 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.000s]
2025-05-23 19:55:57,070 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 20 times in a row, putting on 30 second timeout
2025-05-23 19:55:57,071 - anomaly_detection - ERROR - Error loading data from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041ad70>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-05-23 19:55:57,071 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 19:59:38,552 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 19:59:38,572 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 19:59:38,652 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:59:39,719 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:1.066s]
2025-05-23 19:59:42,079 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has been marked alive after a successful request
2025-05-23 19:59:42,079 - anomaly_detection - INFO - Loaded 3110 records from Elasticsearch
2025-05-23 19:59:42,212 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 19:59:42,366 - anomaly_detection - INFO - Detected 156 anomalies
2025-05-23 19:59:42,374 - anomaly_detection - INFO - Indexing 156 anomalies to security-anomalies
2025-05-23 19:59:42,387 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:59:42,468 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.081s]
2025-05-23 19:59:42,469 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:59:42,470 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 19:59:42,546 - anomaly_detection - INFO - Detected 156 anomalies
2025-05-23 19:59:42,548 - anomaly_detection - INFO - Indexing 156 anomalies to security-anomalies
2025-05-23 19:59:42,574 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 19:59:42,616 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.042s]
2025-05-23 19:59:42,617 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 19:59:42,617 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 20:00:42,889 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 20:00:42,929 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 20:00:43,550 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 20:00:43,892 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.331s]
2025-05-23 20:00:44,413 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has been marked alive after a successful request
2025-05-23 20:00:44,418 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 20:00:44,658 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 20:00:44,667 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 20:00:44,673 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.006s]
2025-05-23 20:00:44,676 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 20:00:44,693 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 20:00:44,697 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 20:00:44,785 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.087s]
2025-05-23 20:00:44,785 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 20:00:44,790 - risk_scoring - INFO - Calculating risk scores
2025-05-23 20:00:44,808 - risk_scoring - INFO - Calculating risk scores for 3 assets
2025-05-23 20:00:44,863 - risk_scoring - INFO - Indexing 3 risk scores to security-risk-scores
2025-05-23 20:00:44,887 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 20:00:44,926 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.039s]
2025-05-23 20:00:44,927 - risk_scoring - INFO - Successfully indexed 3 risk scores, errors: []
2025-05-23 20:00:44,927 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 20:00:57,171 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 20:00:57,171 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 20:00:57,172 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 20:00:57,492 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.320s]
2025-05-23 20:00:59,959 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has been marked alive after a successful request
2025-05-23 20:00:59,961 - anomaly_detection - INFO - Loaded 5798 records from Elasticsearch
2025-05-23 20:01:00,085 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 20:01:00,272 - anomaly_detection - INFO - Detected 290 anomalies
2025-05-23 20:01:00,291 - anomaly_detection - INFO - Indexing 290 anomalies to security-anomalies
2025-05-23 20:01:00,323 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 20:01:00,487 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.164s]
2025-05-23 20:01:00,488 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:01:00,489 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 20:01:00,665 - anomaly_detection - INFO - Detected 289 anomalies
2025-05-23 20:01:00,666 - anomaly_detection - INFO - Indexing 289 anomalies to security-anomalies
2025-05-23 20:01:00,690 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 20:01:00,717 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.026s]
2025-05-23 20:01:00,718 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:01:00,719 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 20:03:35,115 - __main__ - INFO - Server shutting down gracefully...
2025-05-23 20:03:40,605 - __main__ - INFO - Starting server services...
2025-05-23 20:03:40,726 - __main__ - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 20:03:40,726 - __main__ - INFO - Starting anomaly detection service...
2025-05-23 20:03:41,257 - __main__ - INFO - Anomaly detection service started
2025-05-23 20:03:41,257 - anomaly_detection - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 20:03:41,257 - __main__ - INFO - Starting risk scoring service...
2025-05-23 20:03:41,258 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 20:03:41,258 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 20:03:41,261 - __main__ - INFO - Risk scoring service started
2025-05-23 20:03:41,261 - __main__ - INFO - All services started successfully
2025-05-23 20:03:41,262 - risk_scoring - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-05-23 20:03:41,262 - risk_scoring - INFO - Loading asset criticality from config/asset_criticality.json
2025-05-23 20:03:41,262 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 20:03:41,263 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 20:03:41,330 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.072s]
2025-05-23 20:03:41,671 - anomaly_detection - INFO - Loaded 5812 records from Elasticsearch
2025-05-23 20:03:41,732 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 20:03:41,856 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.032s]
2025-05-23 20:03:41,889 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 20:03:41,927 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 20:03:41,933 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-05-23 20:03:41,933 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 20:03:41,934 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 20:03:41,941 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.003s]
2025-05-23 20:03:41,941 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 20:03:41,942 - risk_scoring - INFO - Calculating risk scores
2025-05-23 20:03:41,943 - risk_scoring - INFO - Calculating risk scores for 3 assets
2025-05-23 20:03:41,948 - risk_scoring - INFO - Indexing 3 risk scores to security-risk-scores
2025-05-23 20:03:41,962 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.013s]
2025-05-23 20:03:41,962 - risk_scoring - INFO - Successfully indexed 3 risk scores, errors: []
2025-05-23 20:03:41,962 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 20:03:41,969 - anomaly_detection - INFO - Detected 286 anomalies
2025-05-23 20:03:41,979 - anomaly_detection - INFO - Indexing 286 anomalies to security-anomalies
2025-05-23 20:03:42,007 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 20:03:42,008 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:03:42,008 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 20:03:42,142 - anomaly_detection - INFO - Detected 289 anomalies
2025-05-23 20:03:42,142 - anomaly_detection - INFO - Indexing 289 anomalies to security-anomalies
2025-05-23 20:03:42,170 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 20:03:42,170 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:03:42,170 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 20:06:00,806 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 20:06:00,807 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 20:06:00,807 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 20:06:00,872 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.064s]
2025-05-23 20:06:01,174 - anomaly_detection - INFO - Loaded 5821 records from Elasticsearch
2025-05-23 20:06:01,235 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 20:06:01,331 - anomaly_detection - INFO - Detected 289 anomalies
2025-05-23 20:06:01,341 - anomaly_detection - INFO - Indexing 289 anomalies to security-anomalies
2025-05-23 20:06:01,366 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 20:06:01,367 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:06:01,367 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 20:06:01,498 - anomaly_detection - INFO - Detected 287 anomalies
2025-05-23 20:06:01,498 - anomaly_detection - INFO - Indexing 287 anomalies to security-anomalies
2025-05-23 20:06:01,523 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 20:06:01,524 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:06:01,524 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 20:08:42,213 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 20:08:42,213 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 20:08:42,341 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.128s]
2025-05-23 20:08:42,688 - anomaly_detection - INFO - Loaded 5842 records from Elasticsearch
2025-05-23 20:08:42,771 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 20:08:42,896 - anomaly_detection - INFO - Detected 293 anomalies
2025-05-23 20:08:42,909 - anomaly_detection - INFO - Indexing 293 anomalies to security-anomalies
2025-05-23 20:08:42,946 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.010s]
2025-05-23 20:08:42,947 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:08:42,948 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 20:08:43,102 - anomaly_detection - INFO - Detected 293 anomalies
2025-05-23 20:08:43,102 - anomaly_detection - INFO - Indexing 293 anomalies to security-anomalies
2025-05-23 20:08:43,134 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 20:08:43,134 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:08:43,135 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 20:11:01,622 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 20:11:01,622 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 20:11:01,697 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.075s]
2025-05-23 20:11:01,894 - anomaly_detection - INFO - Loaded 5855 records from Elasticsearch
2025-05-23 20:11:01,957 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 20:11:02,053 - anomaly_detection - INFO - Detected 293 anomalies
2025-05-23 20:11:02,063 - anomaly_detection - INFO - Indexing 293 anomalies to security-anomalies
2025-05-23 20:11:02,089 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 20:11:02,089 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:11:02,090 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 20:11:02,221 - anomaly_detection - INFO - Detected 293 anomalies
2025-05-23 20:11:02,222 - anomaly_detection - INFO - Indexing 293 anomalies to security-anomalies
2025-05-23 20:11:02,282 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 20:11:02,283 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:11:02,283 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 20:13:43,236 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 20:13:43,237 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 20:13:43,506 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.268s]
2025-05-23 20:13:43,913 - anomaly_detection - INFO - Loaded 5852 records from Elasticsearch
2025-05-23 20:13:43,998 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 20:13:44,117 - anomaly_detection - INFO - Detected 292 anomalies
2025-05-23 20:13:44,130 - anomaly_detection - INFO - Indexing 292 anomalies to security-anomalies
2025-05-23 20:13:44,165 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.011s]
2025-05-23 20:13:44,238 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:13:44,238 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 20:13:44,404 - anomaly_detection - INFO - Detected 293 anomalies
2025-05-23 20:13:44,404 - anomaly_detection - INFO - Indexing 293 anomalies to security-anomalies
2025-05-23 20:13:44,453 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.019s]
2025-05-23 20:13:44,454 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:13:44,454 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 20:15:44,984 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 20:15:44,985 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 20:15:44,991 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 20:15:45,278 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.287s]
2025-05-23 20:15:45,303 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 20:15:45,344 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 20:15:45,348 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 20:15:45,351 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.003s]
2025-05-23 20:15:45,351 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 20:15:45,352 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 20:15:45,354 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 20:15:45,358 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.004s]
2025-05-23 20:15:45,358 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 20:15:45,359 - risk_scoring - INFO - Calculating risk scores
2025-05-23 20:15:45,360 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 20:15:45,366 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 20:15:45,367 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-23 20:15:45,398 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.032s]
2025-05-23 20:15:45,399 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 20:15:45,399 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 20:16:02,377 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 20:16:02,378 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 20:16:03,074 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.696s]
2025-05-23 20:16:03,369 - anomaly_detection - INFO - Loaded 5916 records from Elasticsearch
2025-05-23 20:16:03,440 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 20:16:03,544 - anomaly_detection - INFO - Detected 292 anomalies
2025-05-23 20:16:03,555 - anomaly_detection - INFO - Indexing 292 anomalies to security-anomalies
2025-05-23 20:16:03,616 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.040s]
2025-05-23 20:16:03,617 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:16:03,617 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 20:16:03,760 - anomaly_detection - INFO - Detected 296 anomalies
2025-05-23 20:16:03,760 - anomaly_detection - INFO - Indexing 296 anomalies to security-anomalies
2025-05-23 20:16:03,823 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.043s]
2025-05-23 20:16:03,824 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:16:03,824 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 20:18:42,063 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-23 20:18:42,064 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-23 20:18:42,101 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.021s]
2025-05-23 20:18:42,133 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-23 20:18:42,180 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-23 20:18:42,186 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-05-23 20:18:42,187 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-23 20:18:42,187 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-23 20:18:42,194 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-05-23 20:18:42,194 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-23 20:18:42,195 - risk_scoring - INFO - Calculating risk scores
2025-05-23 20:18:42,196 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-23 20:18:42,202 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-23 20:18:42,212 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.010s]
2025-05-23 20:18:42,212 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-23 20:18:42,212 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-23 20:18:44,543 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 20:18:44,543 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 20:18:44,621 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.078s]
2025-05-23 20:18:44,883 - anomaly_detection - INFO - Loaded 5941 records from Elasticsearch
2025-05-23 20:18:44,949 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 20:18:45,048 - anomaly_detection - INFO - Detected 296 anomalies
2025-05-23 20:18:45,058 - anomaly_detection - INFO - Indexing 296 anomalies to security-anomalies
2025-05-23 20:18:45,086 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 20:18:45,087 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:18:45,087 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 20:18:45,226 - anomaly_detection - INFO - Detected 297 anomalies
2025-05-23 20:18:45,226 - anomaly_detection - INFO - Indexing 297 anomalies to security-anomalies
2025-05-23 20:18:45,253 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 20:18:45,254 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:18:45,254 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 20:21:03,924 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 20:21:03,925 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 20:21:04,014 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.088s]
2025-05-23 20:21:04,452 - anomaly_detection - INFO - Loaded 5960 records from Elasticsearch
2025-05-23 20:21:04,530 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 20:21:04,645 - anomaly_detection - INFO - Detected 297 anomalies
2025-05-23 20:21:04,657 - anomaly_detection - INFO - Indexing 297 anomalies to security-anomalies
2025-05-23 20:21:04,692 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.011s]
2025-05-23 20:21:04,693 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:21:04,693 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 20:21:04,860 - anomaly_detection - INFO - Detected 298 anomalies
2025-05-23 20:21:04,860 - anomaly_detection - INFO - Indexing 298 anomalies to security-anomalies
2025-05-23 20:21:04,890 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-05-23 20:21:04,890 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:21:04,891 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 20:23:45,357 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 20:23:45,357 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 20:23:45,478 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.121s]
2025-05-23 20:23:45,866 - anomaly_detection - INFO - Loaded 5982 records from Elasticsearch
2025-05-23 20:23:45,961 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 20:23:46,074 - anomaly_detection - INFO - Detected 299 anomalies
2025-05-23 20:23:46,085 - anomaly_detection - INFO - Indexing 299 anomalies to security-anomalies
2025-05-23 20:23:46,115 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-05-23 20:23:46,116 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:23:46,116 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 20:23:46,270 - anomaly_detection - INFO - Detected 300 anomalies
2025-05-23 20:23:46,271 - anomaly_detection - INFO - Indexing 300 anomalies to security-anomalies
2025-05-23 20:23:46,301 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-05-23 20:23:46,302 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:23:46,302 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 20:26:04,991 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 20:26:04,991 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 20:26:05,064 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.073s]
2025-05-23 20:26:05,399 - anomaly_detection - INFO - Loaded 5999 records from Elasticsearch
2025-05-23 20:26:05,476 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 20:26:05,581 - anomaly_detection - INFO - Detected 297 anomalies
2025-05-23 20:26:05,593 - anomaly_detection - INFO - Indexing 297 anomalies to security-anomalies
2025-05-23 20:26:05,623 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-05-23 20:26:05,624 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:26:05,624 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 20:26:05,776 - anomaly_detection - INFO - Detected 298 anomalies
2025-05-23 20:26:05,777 - anomaly_detection - INFO - Indexing 298 anomalies to security-anomalies
2025-05-23 20:26:05,803 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-05-23 20:26:05,804 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:26:05,804 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-23 20:30:05,776 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-23 20:30:05,778 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-23 20:30:05,966 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.181s]
2025-05-23 20:30:06,669 - anomaly_detection - INFO - Loaded 5772 records from Elasticsearch
2025-05-23 20:30:06,820 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-05-23 20:30:06,967 - anomaly_detection - INFO - Detected 289 anomalies
2025-05-23 20:30:06,982 - anomaly_detection - INFO - Indexing 289 anomalies to security-anomalies
2025-05-23 20:30:07,032 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.019s]
2025-05-23 20:30:07,034 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:30:07,034 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-05-23 20:30:07,217 - anomaly_detection - INFO - Detected 289 anomalies
2025-05-23 20:30:07,217 - anomaly_detection - INFO - Indexing 289 anomalies to security-anomalies
2025-05-23 20:30:07,258 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.011s]
2025-05-23 20:30:07,260 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-05-23 20:30:07,260 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-24 10:52:14,662 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-24 10:52:14,677 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-24 10:52:14,772 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-24 10:52:14,950 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.177s]
2025-05-24 10:52:15,083 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-24 10:52:15,515 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-24 10:52:15,520 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-24 10:52:15,523 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.003s]
2025-05-24 10:52:15,523 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-24 10:52:15,525 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-24 10:52:15,527 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-24 10:52:15,531 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.004s]
2025-05-24 10:52:15,531 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-24 10:52:15,532 - risk_scoring - INFO - Calculating risk scores
2025-05-24 10:52:15,535 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-24 10:52:15,542 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-24 10:52:15,543 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-05-24 10:52:15,591 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.047s]
2025-05-24 10:52:15,591 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-24 10:52:15,591 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-24 10:52:35,071 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-24 10:52:35,071 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-24 10:52:35,078 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.007s]
2025-05-24 10:52:35,079 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-24 10:52:35,079 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-24 10:52:35,171 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-24 10:55:11,454 - risk_scoring - INFO - Starting risk scoring cycle
2025-05-24 10:55:11,454 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-05-24 10:55:11,518 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.053s]
2025-05-24 10:55:11,560 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-05-24 10:55:11,684 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-05-24 10:55:11,689 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-05-24 10:55:11,689 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-05-24 10:55:11,690 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-05-24 10:55:11,695 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.003s]
2025-05-24 10:55:11,696 - risk_scoring - INFO - Loaded 1 compliance issues from Elasticsearch
2025-05-24 10:55:11,696 - risk_scoring - INFO - Calculating risk scores
2025-05-24 10:55:11,699 - risk_scoring - INFO - Calculating risk scores for 2 assets
2025-05-24 10:55:11,707 - risk_scoring - INFO - Indexing 2 risk scores to security-risk-scores
2025-05-24 10:55:11,731 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.023s]
2025-05-24 10:55:11,731 - risk_scoring - INFO - Successfully indexed 2 risk scores, errors: []
2025-05-24 10:55:11,731 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-05-24 10:55:17,094 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-24 10:55:17,094 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-24 10:55:17,097 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.002s]
2025-05-24 10:55:17,097 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-24 10:55:17,097 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-24 10:55:17,105 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-24 10:57:35,270 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-24 10:57:35,271 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-24 10:57:35,274 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.003s]
2025-05-24 10:57:35,274 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-24 10:57:35,275 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-24 10:57:35,275 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-24 11:00:17,206 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-24 11:00:17,206 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-24 11:00:17,212 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.006s]
2025-05-24 11:00:17,214 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-24 11:00:17,214 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-24 11:00:17,214 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-05-24 11:02:35,375 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-05-24 11:02:35,375 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-05-24 11:02:35,380 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.004s]
2025-05-24 11:02:35,380 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-05-24 11:02:35,380 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-05-24 11:02:35,380 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:00:21,344 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:00:21,356 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:00:21,376 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.019s]
2025-06-01 10:00:21,386 - anomaly_detection - INFO - Loaded 242 records from Elasticsearch
2025-06-01 10:00:21,398 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:00:21,481 - anomaly_detection - INFO - Detected 13 anomalies
2025-06-01 10:00:21,490 - anomaly_detection - INFO - Indexing 13 anomalies to security-anomalies
2025-06-01 10:00:21,497 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 10:00:21,497 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:00:21,497 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:00:21,502 - anomaly_detection - INFO - Detected 13 anomalies
2025-06-01 10:00:21,502 - anomaly_detection - INFO - Indexing 13 anomalies to security-anomalies
2025-06-01 10:00:21,507 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.004s]
2025-06-01 10:00:21,507 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:00:21,507 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:02:19,725 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 10:02:19,726 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 10:02:19,828 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.009s]
2025-06-01 10:02:19,828 - risk_scoring - INFO - Loaded 66 anomalies from Elasticsearch
2025-06-01 10:02:19,844 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 10:02:19,849 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 10:02:19,850 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 10:02:19,853 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 10:02:19,858 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-06-01 10:02:19,858 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 10:02:19,860 - risk_scoring - INFO - Calculating risk scores
2025-06-01 10:02:19,862 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 10:02:19,865 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 10:02:19,885 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.017s]
2025-06-01 10:02:19,885 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 10:02:19,885 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 10:02:39,525 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:02:39,550 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:02:39,649 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.054s]
2025-06-01 10:02:39,653 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 1 times in a row, putting on 1 second timeout
2025-06-01 10:02:39,654 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e90418a90>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e90418a90>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-06-01 10:02:39,683 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.004s]
2025-06-01 10:02:39,684 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 2 times in a row, putting on 2 second timeout
2025-06-01 10:02:39,684 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e9041b7f0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e9041b7f0>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-06-01 10:02:39,685 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.001s]
2025-06-01 10:02:39,685 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 3 times in a row, putting on 4 second timeout
2025-06-01 10:02:39,686 - elastic_transport.transport - WARNING - Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7d2e90419270>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
  File "/home/ubuntu/security-venv/lib/python3.10/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e90419270>: Failed to establish a new connection: [Errno 111] Connection refused)
2025-06-01 10:02:39,690 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:N/A duration:0.004s]
2025-06-01 10:02:39,690 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has failed for 4 times in a row, putting on 8 second timeout
2025-06-01 10:02:39,690 - anomaly_detection - ERROR - Error loading data from Elasticsearch: Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7d2e90418a90>: Failed to establish a new connection: [Errno 111] Connection refused))
2025-06-01 10:02:39,690 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:05:15,887 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 10:05:15,930 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 10:05:16,855 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.074s]
2025-06-01 10:05:16,863 - risk_scoring - INFO - Loaded 66 anomalies from Elasticsearch
2025-06-01 10:05:17,122 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 10:05:17,131 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-06-01 10:05:17,133 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 10:05:17,160 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 10:05:17,167 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.003s]
2025-06-01 10:05:17,167 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 10:05:17,174 - risk_scoring - INFO - Calculating risk scores
2025-06-01 10:05:17,183 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 10:05:17,196 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 10:05:17,238 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.015s]
2025-06-01 10:05:17,238 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 10:05:17,238 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 10:05:21,606 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:05:21,608 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:05:21,744 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.136s]
2025-06-01 10:05:22,111 - anomaly_detection - INFO - Loaded 767 records from Elasticsearch
2025-06-01 10:05:22,207 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:05:22,367 - anomaly_detection - INFO - Detected 39 anomalies
2025-06-01 10:05:22,373 - anomaly_detection - INFO - Indexing 39 anomalies to security-anomalies
2025-06-01 10:05:22,390 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.013s]
2025-06-01 10:05:22,390 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:05:22,391 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:05:22,415 - anomaly_detection - INFO - Detected 39 anomalies
2025-06-01 10:05:22,415 - anomaly_detection - INFO - Indexing 39 anomalies to security-anomalies
2025-06-01 10:05:22,425 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 10:05:22,425 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:05:22,425 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:07:39,783 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:07:39,784 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:07:39,786 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-06-01 10:07:39,933 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.147s]
2025-06-01 10:07:40,618 - elastic_transport.node_pool - WARNING - Node <Urllib3HttpNode(http://localhost:9200)> has been marked alive after a successful request
2025-06-01 10:07:40,620 - anomaly_detection - INFO - Loaded 994 records from Elasticsearch
2025-06-01 10:07:40,855 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:07:41,111 - anomaly_detection - INFO - Detected 50 anomalies
2025-06-01 10:07:41,133 - anomaly_detection - INFO - Indexing 50 anomalies to security-anomalies
2025-06-01 10:07:41,141 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-06-01 10:07:41,147 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 10:07:41,148 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:07:41,149 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:07:41,197 - anomaly_detection - INFO - Detected 50 anomalies
2025-06-01 10:07:41,198 - anomaly_detection - INFO - Indexing 50 anomalies to security-anomalies
2025-06-01 10:07:41,204 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-06-01 10:07:41,211 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 10:07:41,211 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:07:41,211 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:07:49,667 - __main__ - INFO - Server shutting down gracefully...
2025-06-01 10:08:33,313 - __main__ - INFO - Starting server services...
2025-06-01 10:08:33,430 - __main__ - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-06-01 10:08:33,430 - __main__ - INFO - Starting anomaly detection service...
2025-06-01 10:08:33,986 - __main__ - INFO - Anomaly detection service started
2025-06-01 10:08:33,986 - anomaly_detection - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-06-01 10:08:33,987 - __main__ - INFO - Starting risk scoring service...
2025-06-01 10:08:33,987 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:08:33,987 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:08:33,991 - __main__ - INFO - Risk scoring service started
2025-06-01 10:08:33,992 - risk_scoring - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-06-01 10:08:33,992 - __main__ - INFO - All services started successfully
2025-06-01 10:08:33,992 - risk_scoring - INFO - Loading asset criticality from config/asset_criticality.json
2025-06-01 10:08:33,992 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 10:08:33,992 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 10:08:34,051 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.064s]
2025-06-01 10:08:34,144 - anomaly_detection - INFO - Loaded 1087 records from Elasticsearch
2025-06-01 10:08:34,158 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:08:34,269 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.013s]
2025-06-01 10:08:34,270 - risk_scoring - INFO - Loaded 333 anomalies from Elasticsearch
2025-06-01 10:08:34,271 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 10:08:34,278 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-06-01 10:08:34,278 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 10:08:34,279 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 10:08:34,288 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.004s]
2025-06-01 10:08:34,290 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 10:08:34,290 - risk_scoring - INFO - Calculating risk scores
2025-06-01 10:08:34,291 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 10:08:34,293 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 10:08:34,310 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.015s]
2025-06-01 10:08:34,310 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 10:08:34,310 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 10:08:34,313 - anomaly_detection - INFO - Detected 55 anomalies
2025-06-01 10:08:34,318 - anomaly_detection - INFO - Indexing 55 anomalies to security-anomalies
2025-06-01 10:08:34,330 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 10:08:34,330 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:08:34,331 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:08:34,342 - anomaly_detection - INFO - Detected 55 anomalies
2025-06-01 10:08:34,342 - anomaly_detection - INFO - Indexing 55 anomalies to security-anomalies
2025-06-01 10:08:34,352 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-06-01 10:08:34,352 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:08:34,352 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:12:41,295 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:12:41,295 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:12:41,297 - elastic_transport.node_pool - INFO - Resurrected node <Urllib3HttpNode(http://localhost:9200)> (force=False)
2025-06-01 10:12:41,596 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.298s]
2025-06-01 10:12:43,073 - anomaly_detection - INFO - Loaded 1514 records from Elasticsearch
2025-06-01 10:12:43,106 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:12:43,195 - anomaly_detection - INFO - Detected 76 anomalies
2025-06-01 10:12:43,200 - anomaly_detection - INFO - Indexing 76 anomalies to security-anomalies
2025-06-01 10:12:43,221 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.015s]
2025-06-01 10:12:43,221 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:12:43,221 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:12:43,240 - anomaly_detection - INFO - Detected 76 anomalies
2025-06-01 10:12:43,240 - anomaly_detection - INFO - Indexing 76 anomalies to security-anomalies
2025-06-01 10:12:43,266 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.019s]
2025-06-01 10:12:43,267 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:12:43,267 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:13:34,444 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:13:34,444 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:13:34,489 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.044s]
2025-06-01 10:13:34,533 - anomaly_detection - INFO - Loaded 1604 records from Elasticsearch
2025-06-01 10:13:34,610 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:13:34,698 - anomaly_detection - INFO - Detected 80 anomalies
2025-06-01 10:13:34,703 - anomaly_detection - INFO - Indexing 80 anomalies to security-anomalies
2025-06-01 10:13:34,726 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.017s]
2025-06-01 10:13:34,726 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:13:34,727 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:13:34,741 - anomaly_detection - INFO - Detected 81 anomalies
2025-06-01 10:13:34,741 - anomaly_detection - INFO - Indexing 81 anomalies to security-anomalies
2025-06-01 10:13:34,751 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-06-01 10:13:34,751 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:13:34,751 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:17:19,987 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 10:17:19,988 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 10:17:20,027 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.029s]
2025-06-01 10:17:20,030 - risk_scoring - INFO - Loaded 1090 anomalies from Elasticsearch
2025-06-01 10:17:20,035 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 10:17:20,041 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 10:17:20,041 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 10:17:20,042 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 10:17:20,057 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.007s]
2025-06-01 10:17:20,057 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 10:17:20,058 - risk_scoring - INFO - Calculating risk scores
2025-06-01 10:17:20,058 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 10:17:20,059 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 10:17:20,081 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.018s]
2025-06-01 10:17:20,081 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 10:17:20,081 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 10:16:43,682 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:16:43,682 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:16:43,749 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.066s]
2025-06-01 10:16:44,027 - anomaly_detection - INFO - Loaded 2043 records from Elasticsearch
2025-06-01 10:16:44,062 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:16:44,152 - anomaly_detection - INFO - Detected 101 anomalies
2025-06-01 10:16:44,157 - anomaly_detection - INFO - Indexing 101 anomalies to security-anomalies
2025-06-01 10:16:44,170 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 10:16:44,171 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:16:44,171 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:16:44,196 - anomaly_detection - INFO - Detected 102 anomalies
2025-06-01 10:16:44,197 - anomaly_detection - INFO - Indexing 102 anomalies to security-anomalies
2025-06-01 10:16:44,210 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 10:16:44,211 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:16:44,211 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:17:35,188 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:17:35,188 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:17:35,212 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.024s]
2025-06-01 10:17:35,271 - anomaly_detection - INFO - Loaded 2132 records from Elasticsearch
2025-06-01 10:17:35,297 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:17:35,404 - anomaly_detection - INFO - Detected 107 anomalies
2025-06-01 10:17:35,411 - anomaly_detection - INFO - Indexing 107 anomalies to security-anomalies
2025-06-01 10:17:35,427 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 10:17:35,427 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:17:35,427 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:17:35,457 - anomaly_detection - INFO - Detected 107 anomalies
2025-06-01 10:17:35,457 - anomaly_detection - INFO - Indexing 107 anomalies to security-anomalies
2025-06-01 10:17:35,472 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-06-01 10:17:35,472 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:17:35,473 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:21:44,306 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:21:44,306 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:21:44,334 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.028s]
2025-06-01 10:21:44,644 - anomaly_detection - INFO - Loaded 2569 records from Elasticsearch
2025-06-01 10:21:44,700 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:21:44,805 - anomaly_detection - INFO - Detected 129 anomalies
2025-06-01 10:21:44,813 - anomaly_detection - INFO - Indexing 129 anomalies to security-anomalies
2025-06-01 10:21:44,830 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 10:21:44,831 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:21:44,832 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:21:44,870 - anomaly_detection - INFO - Detected 128 anomalies
2025-06-01 10:21:44,870 - anomaly_detection - INFO - Indexing 128 anomalies to security-anomalies
2025-06-01 10:21:44,887 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 10:21:44,888 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:21:44,888 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:22:34,725 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 10:22:34,725 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 10:22:34,747 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.014s]
2025-06-01 10:22:34,793 - risk_scoring - INFO - Loaded 2010 anomalies from Elasticsearch
2025-06-01 10:22:34,797 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 10:22:34,801 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 10:22:34,801 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 10:22:34,801 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 10:22:34,806 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.003s]
2025-06-01 10:22:34,807 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 10:22:34,807 - risk_scoring - INFO - Calculating risk scores
2025-06-01 10:22:34,808 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 10:22:34,809 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 10:22:34,836 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.026s]
2025-06-01 10:22:34,836 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 10:22:34,836 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 10:22:35,568 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:22:35,568 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:22:35,622 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.053s]
2025-06-01 10:22:35,749 - anomaly_detection - INFO - Loaded 2658 records from Elasticsearch
2025-06-01 10:22:35,781 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:22:35,875 - anomaly_detection - INFO - Detected 133 anomalies
2025-06-01 10:22:35,882 - anomaly_detection - INFO - Indexing 133 anomalies to security-anomalies
2025-06-01 10:22:35,904 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.012s]
2025-06-01 10:22:35,905 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:22:35,905 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:22:35,943 - anomaly_detection - INFO - Detected 133 anomalies
2025-06-01 10:22:35,943 - anomaly_detection - INFO - Indexing 133 anomalies to security-anomalies
2025-06-01 10:22:35,959 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-06-01 10:22:35,960 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:22:35,960 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:26:44,987 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:26:44,988 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:26:45,039 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.051s]
2025-06-01 10:26:45,364 - anomaly_detection - INFO - Loaded 3099 records from Elasticsearch
2025-06-01 10:26:45,421 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:26:45,510 - anomaly_detection - INFO - Detected 155 anomalies
2025-06-01 10:26:45,517 - anomaly_detection - INFO - Indexing 155 anomalies to security-anomalies
2025-06-01 10:26:45,534 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 10:26:45,535 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:26:45,535 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:26:45,580 - anomaly_detection - INFO - Detected 155 anomalies
2025-06-01 10:26:45,580 - anomaly_detection - INFO - Indexing 155 anomalies to security-anomalies
2025-06-01 10:26:45,597 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-06-01 10:26:45,597 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:26:45,598 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:27:36,059 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:27:36,060 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:27:36,110 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.050s]
2025-06-01 10:27:36,244 - anomaly_detection - INFO - Loaded 3188 records from Elasticsearch
2025-06-01 10:27:36,282 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:27:36,381 - anomaly_detection - INFO - Detected 160 anomalies
2025-06-01 10:27:36,389 - anomaly_detection - INFO - Indexing 160 anomalies to security-anomalies
2025-06-01 10:27:36,406 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 10:27:36,407 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:27:36,407 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:27:36,454 - anomaly_detection - INFO - Detected 159 anomalies
2025-06-01 10:27:36,454 - anomaly_detection - INFO - Indexing 159 anomalies to security-anomalies
2025-06-01 10:27:36,470 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-06-01 10:27:36,471 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:27:36,471 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:31:20,514 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 10:31:20,514 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 10:31:20,559 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.041s]
2025-06-01 10:31:20,590 - risk_scoring - INFO - Loaded 3556 anomalies from Elasticsearch
2025-06-01 10:31:20,597 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 10:31:20,601 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 10:31:20,601 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 10:31:20,602 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 10:31:20,605 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.001s]
2025-06-01 10:31:20,605 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 10:31:20,605 - risk_scoring - INFO - Calculating risk scores
2025-06-01 10:31:20,606 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 10:31:20,607 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 10:31:20,615 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.008s]
2025-06-01 10:31:20,616 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 10:31:20,616 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 10:31:45,672 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:31:45,672 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:31:45,716 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.044s]
2025-06-01 10:31:46,138 - anomaly_detection - INFO - Loaded 3638 records from Elasticsearch
2025-06-01 10:31:46,215 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:31:46,303 - anomaly_detection - INFO - Detected 182 anomalies
2025-06-01 10:31:46,310 - anomaly_detection - INFO - Indexing 182 anomalies to security-anomalies
2025-06-01 10:31:46,327 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-06-01 10:31:46,328 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:31:46,328 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:31:46,396 - anomaly_detection - INFO - Detected 182 anomalies
2025-06-01 10:31:46,396 - anomaly_detection - INFO - Indexing 182 anomalies to security-anomalies
2025-06-01 10:31:46,415 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 10:31:46,415 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:31:46,415 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:32:36,555 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:32:36,555 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:32:36,631 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.075s]
2025-06-01 10:32:36,870 - anomaly_detection - INFO - Loaded 3732 records from Elasticsearch
2025-06-01 10:32:36,914 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:32:37,030 - anomaly_detection - INFO - Detected 186 anomalies
2025-06-01 10:32:37,041 - anomaly_detection - INFO - Indexing 186 anomalies to security-anomalies
2025-06-01 10:32:37,087 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.030s]
2025-06-01 10:32:37,088 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:32:37,088 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:32:37,193 - anomaly_detection - INFO - Detected 187 anomalies
2025-06-01 10:32:37,194 - anomaly_detection - INFO - Indexing 187 anomalies to security-anomalies
2025-06-01 10:32:37,224 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.014s]
2025-06-01 10:32:37,226 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:32:37,226 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:36:46,506 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:36:46,506 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:36:46,568 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.062s]
2025-06-01 10:36:47,011 - anomaly_detection - INFO - Loaded 4199 records from Elasticsearch
2025-06-01 10:36:47,106 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:36:47,205 - anomaly_detection - INFO - Detected 210 anomalies
2025-06-01 10:36:47,214 - anomaly_detection - INFO - Indexing 210 anomalies to security-anomalies
2025-06-01 10:36:47,235 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 10:36:47,235 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:36:47,235 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:36:47,322 - anomaly_detection - INFO - Detected 210 anomalies
2025-06-01 10:36:47,322 - anomaly_detection - INFO - Indexing 210 anomalies to security-anomalies
2025-06-01 10:36:47,342 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-06-01 10:36:47,343 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:36:47,343 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:37:34,927 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 10:37:34,927 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 10:37:34,948 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.017s]
2025-06-01 10:37:34,961 - risk_scoring - INFO - Loaded 5123 anomalies from Elasticsearch
2025-06-01 10:37:34,978 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 10:37:34,982 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 10:37:34,982 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 10:37:34,982 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 10:37:34,986 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-06-01 10:37:34,986 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 10:37:34,987 - risk_scoring - INFO - Calculating risk scores
2025-06-01 10:37:34,987 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 10:37:34,989 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 10:37:34,998 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.009s]
2025-06-01 10:37:34,999 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 10:37:34,999 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 10:37:37,327 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:37:37,328 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:37:37,398 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.070s]
2025-06-01 10:37:37,618 - anomaly_detection - INFO - Loaded 4301 records from Elasticsearch
2025-06-01 10:37:37,669 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:37:37,772 - anomaly_detection - INFO - Detected 215 anomalies
2025-06-01 10:37:37,780 - anomaly_detection - INFO - Indexing 215 anomalies to security-anomalies
2025-06-01 10:37:37,801 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 10:37:37,802 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:37:37,802 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:37:37,891 - anomaly_detection - INFO - Detected 215 anomalies
2025-06-01 10:37:37,891 - anomaly_detection - INFO - Indexing 215 anomalies to security-anomalies
2025-06-01 10:37:37,913 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 10:37:37,913 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:37:37,914 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:41:47,444 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:41:47,444 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:41:47,505 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.061s]
2025-06-01 10:41:48,098 - anomaly_detection - INFO - Loaded 4766 records from Elasticsearch
2025-06-01 10:41:48,197 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:41:48,311 - anomaly_detection - INFO - Detected 239 anomalies
2025-06-01 10:41:48,322 - anomaly_detection - INFO - Indexing 239 anomalies to security-anomalies
2025-06-01 10:41:48,350 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-06-01 10:41:48,350 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:41:48,351 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:41:48,474 - anomaly_detection - INFO - Detected 237 anomalies
2025-06-01 10:41:48,474 - anomaly_detection - INFO - Indexing 237 anomalies to security-anomalies
2025-06-01 10:41:48,499 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 10:41:48,500 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:41:48,500 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:42:38,013 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:42:38,014 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:42:38,062 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.048s]
2025-06-01 10:42:38,305 - anomaly_detection - INFO - Loaded 4860 records from Elasticsearch
2025-06-01 10:42:38,359 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:42:38,466 - anomaly_detection - INFO - Detected 243 anomalies
2025-06-01 10:42:38,476 - anomaly_detection - INFO - Indexing 243 anomalies to security-anomalies
2025-06-01 10:42:38,500 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-06-01 10:42:38,501 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:42:38,501 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:42:38,616 - anomaly_detection - INFO - Detected 243 anomalies
2025-06-01 10:42:38,616 - anomaly_detection - INFO - Indexing 243 anomalies to security-anomalies
2025-06-01 10:42:38,639 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-06-01 10:42:38,640 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:42:38,640 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:46:20,715 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 10:46:20,716 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 10:46:20,844 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.106s]
2025-06-01 10:46:20,870 - risk_scoring - INFO - Loaded 7499 anomalies from Elasticsearch
2025-06-01 10:46:20,906 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 10:46:20,912 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-06-01 10:46:20,912 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 10:46:20,913 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 10:46:20,919 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.003s]
2025-06-01 10:46:20,919 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 10:46:20,920 - risk_scoring - INFO - Calculating risk scores
2025-06-01 10:46:20,921 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 10:46:20,924 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 10:46:20,937 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.012s]
2025-06-01 10:46:20,937 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 10:46:20,937 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 10:46:48,601 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:46:48,602 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:46:48,708 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.106s]
2025-06-01 10:46:49,467 - anomaly_detection - INFO - Loaded 5326 records from Elasticsearch
2025-06-01 10:46:49,561 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:46:49,676 - anomaly_detection - INFO - Detected 266 anomalies
2025-06-01 10:46:49,687 - anomaly_detection - INFO - Indexing 266 anomalies to security-anomalies
2025-06-01 10:46:49,717 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 10:46:49,717 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:46:49,718 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:46:49,873 - anomaly_detection - INFO - Detected 267 anomalies
2025-06-01 10:46:49,874 - anomaly_detection - INFO - Indexing 267 anomalies to security-anomalies
2025-06-01 10:46:49,905 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.010s]
2025-06-01 10:46:49,906 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:46:49,906 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:47:38,729 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:47:38,730 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:47:38,803 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.072s]
2025-06-01 10:47:39,166 - anomaly_detection - INFO - Loaded 5420 records from Elasticsearch
2025-06-01 10:47:39,232 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:47:39,348 - anomaly_detection - INFO - Detected 269 anomalies
2025-06-01 10:47:39,359 - anomaly_detection - INFO - Indexing 269 anomalies to security-anomalies
2025-06-01 10:47:39,388 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 10:47:39,389 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:47:39,389 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:47:39,535 - anomaly_detection - INFO - Detected 269 anomalies
2025-06-01 10:47:39,535 - anomaly_detection - INFO - Indexing 269 anomalies to security-anomalies
2025-06-01 10:47:39,563 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 10:47:39,564 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:47:39,564 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:51:50,006 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:51:50,006 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:51:50,085 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.079s]
2025-06-01 10:51:50,515 - anomaly_detection - INFO - Loaded 5885 records from Elasticsearch
2025-06-01 10:51:50,585 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:51:50,694 - anomaly_detection - INFO - Detected 295 anomalies
2025-06-01 10:51:50,705 - anomaly_detection - INFO - Indexing 295 anomalies to security-anomalies
2025-06-01 10:51:50,734 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 10:51:50,735 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:51:50,735 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:51:50,897 - anomaly_detection - INFO - Detected 294 anomalies
2025-06-01 10:51:50,897 - anomaly_detection - INFO - Indexing 294 anomalies to security-anomalies
2025-06-01 10:51:50,925 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 10:51:50,926 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:51:50,926 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:52:35,095 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 10:52:35,095 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 10:52:35,143 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.043s]
2025-06-01 10:52:35,167 - risk_scoring - INFO - Loaded 9737 anomalies from Elasticsearch
2025-06-01 10:52:35,202 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 10:52:35,208 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-06-01 10:52:35,208 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 10:52:35,209 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 10:52:35,213 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-06-01 10:52:35,213 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 10:52:35,214 - risk_scoring - INFO - Calculating risk scores
2025-06-01 10:52:35,215 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 10:52:35,217 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 10:52:35,227 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.010s]
2025-06-01 10:52:35,228 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 10:52:35,229 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 10:52:39,665 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:52:39,665 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:52:39,749 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.083s]
2025-06-01 10:52:40,079 - anomaly_detection - INFO - Loaded 5979 records from Elasticsearch
2025-06-01 10:52:40,155 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:52:40,275 - anomaly_detection - INFO - Detected 299 anomalies
2025-06-01 10:52:40,287 - anomaly_detection - INFO - Indexing 299 anomalies to security-anomalies
2025-06-01 10:52:40,322 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.010s]
2025-06-01 10:52:40,325 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:52:40,327 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:52:40,515 - anomaly_detection - INFO - Detected 299 anomalies
2025-06-01 10:52:40,515 - anomaly_detection - INFO - Indexing 299 anomalies to security-anomalies
2025-06-01 10:52:40,544 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 10:52:40,545 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:52:40,545 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:56:51,027 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:56:51,027 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:56:51,129 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.101s]
2025-06-01 10:56:51,596 - anomaly_detection - INFO - Loaded 6446 records from Elasticsearch
2025-06-01 10:56:51,675 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:56:51,788 - anomaly_detection - INFO - Detected 323 anomalies
2025-06-01 10:56:51,800 - anomaly_detection - INFO - Indexing 323 anomalies to security-anomalies
2025-06-01 10:56:51,831 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 10:56:51,832 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:56:51,832 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:56:52,009 - anomaly_detection - INFO - Detected 323 anomalies
2025-06-01 10:56:52,009 - anomaly_detection - INFO - Indexing 323 anomalies to security-anomalies
2025-06-01 10:56:52,039 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 10:56:52,040 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:56:52,040 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 10:57:40,629 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 10:57:40,629 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 10:57:40,729 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.099s]
2025-06-01 10:57:41,220 - anomaly_detection - INFO - Loaded 6535 records from Elasticsearch
2025-06-01 10:57:41,304 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 10:57:41,423 - anomaly_detection - INFO - Detected 327 anomalies
2025-06-01 10:57:41,434 - anomaly_detection - INFO - Indexing 327 anomalies to security-anomalies
2025-06-01 10:57:41,467 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-06-01 10:57:41,468 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:57:41,468 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 10:57:41,666 - anomaly_detection - INFO - Detected 327 anomalies
2025-06-01 10:57:41,667 - anomaly_detection - INFO - Indexing 327 anomalies to security-anomalies
2025-06-01 10:57:41,697 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 10:57:41,698 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 10:57:41,698 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:01:21,036 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 11:01:21,037 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 11:01:21,104 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.064s]
2025-06-01 11:01:21,184 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 11:01:21,214 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 11:01:21,218 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 11:01:21,219 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 11:01:21,219 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 11:01:21,223 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-06-01 11:01:21,223 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 11:01:21,223 - risk_scoring - INFO - Calculating risk scores
2025-06-01 11:01:21,224 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 11:01:21,226 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 11:01:21,235 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.008s]
2025-06-01 11:01:21,235 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 11:01:21,235 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 11:01:52,130 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:01:52,130 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:01:52,226 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.095s]
2025-06-01 11:01:52,534 - anomaly_detection - INFO - Loaded 6467 records from Elasticsearch
2025-06-01 11:01:52,609 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:01:52,718 - anomaly_detection - INFO - Detected 324 anomalies
2025-06-01 11:01:52,729 - anomaly_detection - INFO - Indexing 324 anomalies to security-anomalies
2025-06-01 11:01:52,770 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.019s]
2025-06-01 11:01:52,771 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:01:52,772 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:01:52,951 - anomaly_detection - INFO - Detected 323 anomalies
2025-06-01 11:01:52,951 - anomaly_detection - INFO - Indexing 323 anomalies to security-anomalies
2025-06-01 11:01:52,980 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:01:52,981 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:01:52,981 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:02:41,782 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:02:41,783 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:02:41,853 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.070s]
2025-06-01 11:02:42,187 - anomaly_detection - INFO - Loaded 6467 records from Elasticsearch
2025-06-01 11:02:42,262 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:02:42,376 - anomaly_detection - INFO - Detected 324 anomalies
2025-06-01 11:02:42,389 - anomaly_detection - INFO - Indexing 324 anomalies to security-anomalies
2025-06-01 11:02:42,431 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.018s]
2025-06-01 11:02:42,432 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:02:42,432 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:02:42,628 - anomaly_detection - INFO - Detected 324 anomalies
2025-06-01 11:02:42,628 - anomaly_detection - INFO - Indexing 324 anomalies to security-anomalies
2025-06-01 11:02:42,669 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.018s]
2025-06-01 11:02:42,670 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:02:42,670 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:06:53,069 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:06:53,070 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:06:53,151 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.081s]
2025-06-01 11:06:53,511 - anomaly_detection - INFO - Loaded 6481 records from Elasticsearch
2025-06-01 11:06:53,585 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:06:53,689 - anomaly_detection - INFO - Detected 324 anomalies
2025-06-01 11:06:53,700 - anomaly_detection - INFO - Indexing 324 anomalies to security-anomalies
2025-06-01 11:06:53,730 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-06-01 11:06:53,731 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:06:53,731 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:06:53,916 - anomaly_detection - INFO - Detected 323 anomalies
2025-06-01 11:06:53,916 - anomaly_detection - INFO - Indexing 323 anomalies to security-anomalies
2025-06-01 11:06:53,946 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:06:53,947 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:06:53,947 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:07:35,330 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 11:07:35,331 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 11:07:35,364 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.031s]
2025-06-01 11:07:35,387 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 11:07:35,419 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 11:07:35,424 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 11:07:35,424 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 11:07:35,425 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 11:07:35,428 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.001s]
2025-06-01 11:07:35,428 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 11:07:35,429 - risk_scoring - INFO - Calculating risk scores
2025-06-01 11:07:35,430 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 11:07:35,432 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 11:07:35,443 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.011s]
2025-06-01 11:07:35,444 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 11:07:35,444 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 11:07:42,771 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:07:42,771 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:07:42,857 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.085s]
2025-06-01 11:07:43,247 - anomaly_detection - INFO - Loaded 6485 records from Elasticsearch
2025-06-01 11:07:43,324 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:07:43,429 - anomaly_detection - INFO - Detected 325 anomalies
2025-06-01 11:07:43,440 - anomaly_detection - INFO - Indexing 325 anomalies to security-anomalies
2025-06-01 11:07:43,470 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:07:43,471 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:07:43,471 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:07:43,656 - anomaly_detection - INFO - Detected 324 anomalies
2025-06-01 11:07:43,657 - anomaly_detection - INFO - Indexing 324 anomalies to security-anomalies
2025-06-01 11:07:43,686 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:07:43,687 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:07:43,687 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:11:54,043 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:11:54,044 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:11:54,149 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.105s]
2025-06-01 11:11:54,646 - anomaly_detection - INFO - Loaded 6496 records from Elasticsearch
2025-06-01 11:11:54,734 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:11:54,863 - anomaly_detection - INFO - Detected 324 anomalies
2025-06-01 11:11:54,876 - anomaly_detection - INFO - Indexing 324 anomalies to security-anomalies
2025-06-01 11:11:54,912 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 11:11:54,913 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:11:54,914 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:11:55,115 - anomaly_detection - INFO - Detected 323 anomalies
2025-06-01 11:11:55,115 - anomaly_detection - INFO - Indexing 323 anomalies to security-anomalies
2025-06-01 11:11:55,150 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 11:11:55,151 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:11:55,151 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:12:43,785 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:12:43,785 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:12:44,532 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.746s]
2025-06-01 11:12:44,966 - anomaly_detection - INFO - Loaded 6495 records from Elasticsearch
2025-06-01 11:12:45,055 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:12:45,198 - anomaly_detection - INFO - Detected 324 anomalies
2025-06-01 11:12:45,213 - anomaly_detection - INFO - Indexing 324 anomalies to security-anomalies
2025-06-01 11:12:45,263 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.018s]
2025-06-01 11:12:45,264 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:12:45,264 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:12:45,482 - anomaly_detection - INFO - Detected 323 anomalies
2025-06-01 11:12:45,482 - anomaly_detection - INFO - Indexing 323 anomalies to security-anomalies
2025-06-01 11:12:45,517 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:12:45,518 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:12:45,518 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:16:21,337 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 11:16:21,337 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 11:16:21,370 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.030s]
2025-06-01 11:16:21,394 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 11:16:21,422 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 11:16:21,426 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 11:16:21,426 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 11:16:21,427 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 11:16:21,430 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.001s]
2025-06-01 11:16:21,430 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 11:16:21,431 - risk_scoring - INFO - Calculating risk scores
2025-06-01 11:16:21,432 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 11:16:21,434 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 11:16:21,443 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.009s]
2025-06-01 11:16:21,443 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 11:16:21,443 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 11:16:55,251 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:16:55,251 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:16:55,332 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.080s]
2025-06-01 11:16:55,638 - anomaly_detection - INFO - Loaded 6487 records from Elasticsearch
2025-06-01 11:16:55,715 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:16:55,832 - anomaly_detection - INFO - Detected 325 anomalies
2025-06-01 11:16:55,843 - anomaly_detection - INFO - Indexing 325 anomalies to security-anomalies
2025-06-01 11:16:55,872 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:16:55,872 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:16:55,873 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:16:56,055 - anomaly_detection - INFO - Detected 322 anomalies
2025-06-01 11:16:56,055 - anomaly_detection - INFO - Indexing 322 anomalies to security-anomalies
2025-06-01 11:16:56,084 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:16:56,085 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:16:56,085 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:17:45,609 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:17:45,609 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:17:45,687 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.078s]
2025-06-01 11:17:46,004 - anomaly_detection - INFO - Loaded 6488 records from Elasticsearch
2025-06-01 11:17:46,085 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:17:46,199 - anomaly_detection - INFO - Detected 325 anomalies
2025-06-01 11:17:46,210 - anomaly_detection - INFO - Indexing 325 anomalies to security-anomalies
2025-06-01 11:17:46,241 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:17:46,242 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:17:46,242 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:17:46,443 - anomaly_detection - INFO - Detected 323 anomalies
2025-06-01 11:17:46,443 - anomaly_detection - INFO - Indexing 323 anomalies to security-anomalies
2025-06-01 11:17:46,475 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:17:46,476 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:17:46,476 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:21:56,175 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:21:56,175 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:21:56,247 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.072s]
2025-06-01 11:21:56,608 - anomaly_detection - INFO - Loaded 6470 records from Elasticsearch
2025-06-01 11:21:56,686 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:21:56,791 - anomaly_detection - INFO - Detected 321 anomalies
2025-06-01 11:21:56,802 - anomaly_detection - INFO - Indexing 321 anomalies to security-anomalies
2025-06-01 11:21:56,841 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.016s]
2025-06-01 11:21:56,842 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:21:56,842 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:21:57,035 - anomaly_detection - INFO - Detected 323 anomalies
2025-06-01 11:21:57,035 - anomaly_detection - INFO - Indexing 323 anomalies to security-anomalies
2025-06-01 11:21:57,091 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.034s]
2025-06-01 11:21:57,091 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:21:57,092 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:22:35,542 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 11:22:35,542 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 11:22:35,571 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.024s]
2025-06-01 11:22:35,641 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 11:22:35,676 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 11:22:35,680 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 11:22:35,680 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 11:22:35,681 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 11:22:35,683 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.001s]
2025-06-01 11:22:35,683 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 11:22:35,684 - risk_scoring - INFO - Calculating risk scores
2025-06-01 11:22:35,685 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 11:22:35,687 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 11:22:35,696 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.008s]
2025-06-01 11:22:35,696 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 11:22:35,696 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 11:22:46,567 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:22:46,567 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:22:46,637 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.070s]
2025-06-01 11:22:47,052 - anomaly_detection - INFO - Loaded 6467 records from Elasticsearch
2025-06-01 11:22:47,133 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:22:47,253 - anomaly_detection - INFO - Detected 324 anomalies
2025-06-01 11:22:47,265 - anomaly_detection - INFO - Indexing 324 anomalies to security-anomalies
2025-06-01 11:22:47,297 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 11:22:47,298 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:22:47,298 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:22:47,493 - anomaly_detection - INFO - Detected 324 anomalies
2025-06-01 11:22:47,493 - anomaly_detection - INFO - Indexing 324 anomalies to security-anomalies
2025-06-01 11:22:47,534 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.018s]
2025-06-01 11:22:47,535 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:22:47,535 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:26:57,179 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:26:57,179 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:26:57,267 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.087s]
2025-06-01 11:26:57,662 - anomaly_detection - INFO - Loaded 6468 records from Elasticsearch
2025-06-01 11:26:57,741 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:26:57,853 - anomaly_detection - INFO - Detected 323 anomalies
2025-06-01 11:26:57,865 - anomaly_detection - INFO - Indexing 323 anomalies to security-anomalies
2025-06-01 11:26:57,896 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:26:57,897 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:26:57,897 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:26:58,088 - anomaly_detection - INFO - Detected 324 anomalies
2025-06-01 11:26:58,088 - anomaly_detection - INFO - Indexing 324 anomalies to security-anomalies
2025-06-01 11:26:58,117 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:26:58,118 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:26:58,119 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:27:47,622 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:27:47,622 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:27:47,726 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.104s]
2025-06-01 11:27:48,078 - anomaly_detection - INFO - Loaded 6469 records from Elasticsearch
2025-06-01 11:27:48,161 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:27:48,276 - anomaly_detection - INFO - Detected 321 anomalies
2025-06-01 11:27:48,288 - anomaly_detection - INFO - Indexing 321 anomalies to security-anomalies
2025-06-01 11:27:48,320 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:27:48,320 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:27:48,321 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:27:48,508 - anomaly_detection - INFO - Detected 324 anomalies
2025-06-01 11:27:48,508 - anomaly_detection - INFO - Indexing 324 anomalies to security-anomalies
2025-06-01 11:27:48,538 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:27:48,539 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:27:48,539 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:31:21,535 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 11:31:21,535 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 11:31:21,562 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.024s]
2025-06-01 11:31:21,586 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 11:31:21,619 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 11:31:21,623 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 11:31:21,623 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 11:31:21,624 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 11:31:21,627 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.001s]
2025-06-01 11:31:21,627 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 11:31:21,627 - risk_scoring - INFO - Calculating risk scores
2025-06-01 11:31:21,628 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 11:31:21,630 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 11:31:21,639 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.008s]
2025-06-01 11:31:21,639 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 11:31:21,639 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 11:31:58,219 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:31:58,219 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:31:58,316 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.097s]
2025-06-01 11:31:58,674 - anomaly_detection - INFO - Loaded 6463 records from Elasticsearch
2025-06-01 11:31:58,758 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:31:58,886 - anomaly_detection - INFO - Detected 323 anomalies
2025-06-01 11:31:58,899 - anomaly_detection - INFO - Indexing 323 anomalies to security-anomalies
2025-06-01 11:31:58,935 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 11:31:58,937 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:31:58,938 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:31:59,153 - anomaly_detection - INFO - Detected 323 anomalies
2025-06-01 11:31:59,154 - anomaly_detection - INFO - Indexing 323 anomalies to security-anomalies
2025-06-01 11:31:59,188 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 11:31:59,189 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:31:59,189 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:32:48,620 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:32:48,620 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:32:48,715 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.094s]
2025-06-01 11:32:49,067 - anomaly_detection - INFO - Loaded 6459 records from Elasticsearch
2025-06-01 11:32:49,150 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:32:49,263 - anomaly_detection - INFO - Detected 323 anomalies
2025-06-01 11:32:49,275 - anomaly_detection - INFO - Indexing 323 anomalies to security-anomalies
2025-06-01 11:32:49,309 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 11:32:49,310 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:32:49,310 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:32:49,503 - anomaly_detection - INFO - Detected 323 anomalies
2025-06-01 11:32:49,503 - anomaly_detection - INFO - Indexing 323 anomalies to security-anomalies
2025-06-01 11:32:49,533 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:32:49,534 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:32:49,534 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:36:59,271 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:36:59,272 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:36:59,362 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.089s]
2025-06-01 11:36:59,749 - anomaly_detection - INFO - Loaded 6398 records from Elasticsearch
2025-06-01 11:36:59,833 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:36:59,963 - anomaly_detection - INFO - Detected 320 anomalies
2025-06-01 11:36:59,977 - anomaly_detection - INFO - Indexing 320 anomalies to security-anomalies
2025-06-01 11:37:00,019 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.012s]
2025-06-01 11:37:00,020 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:37:00,020 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:37:00,227 - anomaly_detection - INFO - Detected 320 anomalies
2025-06-01 11:37:00,227 - anomaly_detection - INFO - Indexing 320 anomalies to security-anomalies
2025-06-01 11:37:00,260 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:37:00,261 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:37:00,261 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:37:35,794 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 11:37:35,794 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 11:37:35,829 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.030s]
2025-06-01 11:37:35,860 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 11:37:35,903 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 11:37:35,907 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 11:37:35,907 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 11:37:35,908 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 11:37:35,912 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-06-01 11:37:35,912 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 11:37:35,913 - risk_scoring - INFO - Calculating risk scores
2025-06-01 11:37:35,919 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 11:37:35,926 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 11:37:35,938 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.011s]
2025-06-01 11:37:35,938 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 11:37:35,938 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 11:37:49,614 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:37:49,614 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:37:49,712 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.097s]
2025-06-01 11:37:50,161 - anomaly_detection - INFO - Loaded 6393 records from Elasticsearch
2025-06-01 11:37:50,249 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:37:50,383 - anomaly_detection - INFO - Detected 317 anomalies
2025-06-01 11:37:50,399 - anomaly_detection - INFO - Indexing 317 anomalies to security-anomalies
2025-06-01 11:37:50,437 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 11:37:50,438 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:37:50,438 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:37:50,681 - anomaly_detection - INFO - Detected 318 anomalies
2025-06-01 11:37:50,681 - anomaly_detection - INFO - Indexing 318 anomalies to security-anomalies
2025-06-01 11:37:50,721 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 11:37:50,722 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:37:50,723 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:42:00,335 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:42:00,335 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:42:00,405 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.069s]
2025-06-01 11:42:00,802 - anomaly_detection - INFO - Loaded 6368 records from Elasticsearch
2025-06-01 11:42:00,890 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:42:00,998 - anomaly_detection - INFO - Detected 318 anomalies
2025-06-01 11:42:01,009 - anomaly_detection - INFO - Indexing 318 anomalies to security-anomalies
2025-06-01 11:42:01,039 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:42:01,040 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:42:01,040 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:42:01,224 - anomaly_detection - INFO - Detected 318 anomalies
2025-06-01 11:42:01,224 - anomaly_detection - INFO - Indexing 318 anomalies to security-anomalies
2025-06-01 11:42:01,253 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:42:01,254 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:42:01,254 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:42:50,765 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:42:50,765 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:42:50,830 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.064s]
2025-06-01 11:42:51,133 - anomaly_detection - INFO - Loaded 6364 records from Elasticsearch
2025-06-01 11:42:51,212 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:42:51,325 - anomaly_detection - INFO - Detected 319 anomalies
2025-06-01 11:42:51,336 - anomaly_detection - INFO - Indexing 319 anomalies to security-anomalies
2025-06-01 11:42:51,366 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 11:42:51,367 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:42:51,367 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:42:51,549 - anomaly_detection - INFO - Detected 315 anomalies
2025-06-01 11:42:51,549 - anomaly_detection - INFO - Indexing 315 anomalies to security-anomalies
2025-06-01 11:42:51,579 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 11:42:51,579 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:42:51,580 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:43:30,342 - __main__ - INFO - Server shutting down gracefully...
2025-06-01 11:45:02,003 - __main__ - INFO - Starting server services...
2025-06-01 11:45:02,127 - __main__ - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-06-01 11:45:02,127 - __main__ - INFO - Starting anomaly detection service...
2025-06-01 11:45:02,725 - __main__ - INFO - Anomaly detection service started
2025-06-01 11:45:02,726 - anomaly_detection - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-06-01 11:45:02,726 - __main__ - INFO - Starting risk scoring service...
2025-06-01 11:45:02,726 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:45:02,726 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:45:02,730 - __main__ - INFO - Risk scoring service started
2025-06-01 11:45:02,730 - __main__ - INFO - All services started successfully
2025-06-01 11:45:02,731 - risk_scoring - INFO - Connected to Elasticsearch at ['http://localhost:9200']
2025-06-01 11:45:02,731 - risk_scoring - INFO - Loading asset criticality from config/asset_criticality.json
2025-06-01 11:45:02,731 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 11:45:02,731 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 11:45:02,799 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.072s]
2025-06-01 11:45:03,177 - anomaly_detection - INFO - Loaded 6342 records from Elasticsearch
2025-06-01 11:45:03,242 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:45:03,359 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.024s]
2025-06-01 11:45:03,384 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 11:45:03,416 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 11:45:03,425 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.003s]
2025-06-01 11:45:03,425 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 11:45:03,426 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 11:45:03,429 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.001s]
2025-06-01 11:45:03,430 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 11:45:03,430 - risk_scoring - INFO - Calculating risk scores
2025-06-01 11:45:03,432 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 11:45:03,435 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 11:45:03,445 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.008s]
2025-06-01 11:45:03,445 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 11:45:03,446 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 11:45:03,473 - anomaly_detection - INFO - Detected 318 anomalies
2025-06-01 11:45:03,485 - anomaly_detection - INFO - Indexing 318 anomalies to security-anomalies
2025-06-01 11:45:03,519 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 11:45:03,519 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:45:03,520 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:45:03,711 - anomaly_detection - INFO - Detected 317 anomalies
2025-06-01 11:45:03,711 - anomaly_detection - INFO - Indexing 317 anomalies to security-anomalies
2025-06-01 11:45:03,741 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 11:45:03,742 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:45:03,742 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:46:21,745 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 11:46:21,746 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 11:46:22,009 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.242s]
2025-06-01 11:46:22,084 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 11:46:22,131 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 11:46:22,137 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-06-01 11:46:22,137 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 11:46:22,138 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 11:46:22,144 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.004s]
2025-06-01 11:46:22,144 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 11:46:22,145 - risk_scoring - INFO - Calculating risk scores
2025-06-01 11:46:22,146 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 11:46:22,149 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 11:46:22,170 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.021s]
2025-06-01 11:46:22,171 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 11:46:22,171 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 11:47:01,354 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:47:01,357 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:47:01,644 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.286s]
2025-06-01 11:47:02,012 - anomaly_detection - INFO - Loaded 6320 records from Elasticsearch
2025-06-01 11:47:02,106 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:47:02,239 - anomaly_detection - INFO - Detected 316 anomalies
2025-06-01 11:47:02,252 - anomaly_detection - INFO - Indexing 316 anomalies to security-anomalies
2025-06-01 11:47:02,321 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.042s]
2025-06-01 11:47:02,322 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:47:02,322 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:47:02,547 - anomaly_detection - INFO - Detected 316 anomalies
2025-06-01 11:47:02,547 - anomaly_detection - INFO - Indexing 316 anomalies to security-anomalies
2025-06-01 11:47:02,604 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.030s]
2025-06-01 11:47:02,605 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:47:02,605 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:50:03,843 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:50:03,855 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:50:04,002 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.125s]
2025-06-01 11:50:05,153 - anomaly_detection - INFO - Loaded 6298 records from Elasticsearch
2025-06-01 11:50:05,232 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:50:05,351 - anomaly_detection - INFO - Detected 315 anomalies
2025-06-01 11:50:05,362 - anomaly_detection - INFO - Indexing 315 anomalies to security-anomalies
2025-06-01 11:50:05,401 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.015s]
2025-06-01 11:50:05,401 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:50:05,402 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:50:05,624 - anomaly_detection - INFO - Detected 315 anomalies
2025-06-01 11:50:05,624 - anomaly_detection - INFO - Indexing 315 anomalies to security-anomalies
2025-06-01 11:50:05,659 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.012s]
2025-06-01 11:50:05,660 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:50:05,660 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:52:02,686 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:52:02,686 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:52:02,807 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.120s]
2025-06-01 11:52:03,217 - anomaly_detection - INFO - Loaded 6288 records from Elasticsearch
2025-06-01 11:52:03,298 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:52:03,413 - anomaly_detection - INFO - Detected 314 anomalies
2025-06-01 11:52:03,425 - anomaly_detection - INFO - Indexing 314 anomalies to security-anomalies
2025-06-01 11:52:03,464 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.014s]
2025-06-01 11:52:03,466 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:52:03,466 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:52:03,675 - anomaly_detection - INFO - Detected 315 anomalies
2025-06-01 11:52:03,675 - anomaly_detection - INFO - Indexing 315 anomalies to security-anomalies
2025-06-01 11:52:03,715 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.015s]
2025-06-01 11:52:03,716 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:52:03,716 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:55:05,758 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:55:05,758 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:55:05,896 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.138s]
2025-06-01 11:55:06,237 - anomaly_detection - INFO - Loaded 6268 records from Elasticsearch
2025-06-01 11:55:06,313 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:55:06,431 - anomaly_detection - INFO - Detected 314 anomalies
2025-06-01 11:55:06,443 - anomaly_detection - INFO - Indexing 314 anomalies to security-anomalies
2025-06-01 11:55:06,478 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-06-01 11:55:06,479 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:55:06,479 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:55:06,675 - anomaly_detection - INFO - Detected 309 anomalies
2025-06-01 11:55:06,675 - anomaly_detection - INFO - Indexing 309 anomalies to security-anomalies
2025-06-01 11:55:06,708 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-06-01 11:55:06,709 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:55:06,709 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 11:57:03,799 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 11:57:03,799 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 11:57:03,893 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.093s]
2025-06-01 11:57:04,215 - anomaly_detection - INFO - Loaded 6256 records from Elasticsearch
2025-06-01 11:57:04,297 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 11:57:04,405 - anomaly_detection - INFO - Detected 312 anomalies
2025-06-01 11:57:04,416 - anomaly_detection - INFO - Indexing 312 anomalies to security-anomalies
2025-06-01 11:57:04,446 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 11:57:04,447 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:57:04,447 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 11:57:04,631 - anomaly_detection - INFO - Detected 313 anomalies
2025-06-01 11:57:04,631 - anomaly_detection - INFO - Indexing 313 anomalies to security-anomalies
2025-06-01 11:57:04,663 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 11:57:04,664 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 11:57:04,664 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:00:03,463 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 12:00:03,464 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 12:00:03,637 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.165s]
2025-06-01 12:00:03,756 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 12:00:03,797 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 12:00:03,801 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 12:00:03,801 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 12:00:03,801 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 12:00:03,805 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.001s]
2025-06-01 12:00:03,805 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 12:00:03,805 - risk_scoring - INFO - Calculating risk scores
2025-06-01 12:00:03,806 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 12:00:03,809 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 12:00:03,819 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.009s]
2025-06-01 12:00:03,819 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 12:00:03,819 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 12:00:06,784 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:00:06,785 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:00:06,885 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.100s]
2025-06-01 12:00:07,198 - anomaly_detection - INFO - Loaded 6236 records from Elasticsearch
2025-06-01 12:00:07,270 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:00:07,381 - anomaly_detection - INFO - Detected 308 anomalies
2025-06-01 12:00:07,393 - anomaly_detection - INFO - Indexing 308 anomalies to security-anomalies
2025-06-01 12:00:07,423 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 12:00:07,424 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:00:07,424 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:00:07,597 - anomaly_detection - INFO - Detected 312 anomalies
2025-06-01 12:00:07,597 - anomaly_detection - INFO - Indexing 312 anomalies to security-anomalies
2025-06-01 12:00:07,627 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 12:00:07,628 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:00:07,629 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:01:22,271 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 12:01:22,271 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 12:01:22,374 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.095s]
2025-06-01 12:01:22,469 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 12:01:22,515 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 12:01:22,519 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 12:01:22,520 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 12:01:22,520 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 12:01:22,524 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-06-01 12:01:22,524 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 12:01:22,525 - risk_scoring - INFO - Calculating risk scores
2025-06-01 12:01:22,526 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 12:01:22,528 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 12:01:22,540 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.011s]
2025-06-01 12:01:22,541 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 12:01:22,541 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 12:02:04,762 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:02:04,762 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:02:04,846 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.084s]
2025-06-01 12:02:05,164 - anomaly_detection - INFO - Loaded 6235 records from Elasticsearch
2025-06-01 12:02:05,267 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:02:05,379 - anomaly_detection - INFO - Detected 312 anomalies
2025-06-01 12:02:05,391 - anomaly_detection - INFO - Indexing 312 anomalies to security-anomalies
2025-06-01 12:02:05,425 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.012s]
2025-06-01 12:02:05,426 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:02:05,426 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:02:05,605 - anomaly_detection - INFO - Detected 310 anomalies
2025-06-01 12:02:05,605 - anomaly_detection - INFO - Indexing 310 anomalies to security-anomalies
2025-06-01 12:02:05,640 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.013s]
2025-06-01 12:02:05,640 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:02:05,641 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:05:07,726 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:05:07,726 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:05:07,856 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.130s]
2025-06-01 12:05:08,318 - anomaly_detection - INFO - Loaded 6223 records from Elasticsearch
2025-06-01 12:05:08,415 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:05:08,552 - anomaly_detection - INFO - Detected 312 anomalies
2025-06-01 12:05:08,566 - anomaly_detection - INFO - Indexing 312 anomalies to security-anomalies
2025-06-01 12:05:08,612 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.019s]
2025-06-01 12:05:08,613 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:05:08,614 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:05:08,805 - anomaly_detection - INFO - Detected 308 anomalies
2025-06-01 12:05:08,805 - anomaly_detection - INFO - Indexing 308 anomalies to security-anomalies
2025-06-01 12:05:08,854 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.023s]
2025-06-01 12:05:08,855 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:05:08,856 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:07:05,739 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:07:05,740 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:07:05,826 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.086s]
2025-06-01 12:07:06,333 - anomaly_detection - INFO - Loaded 6213 records from Elasticsearch
2025-06-01 12:07:06,444 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:07:06,566 - anomaly_detection - INFO - Detected 307 anomalies
2025-06-01 12:07:06,578 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-06-01 12:07:06,614 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.013s]
2025-06-01 12:07:06,616 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:07:06,617 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:07:06,827 - anomaly_detection - INFO - Detected 311 anomalies
2025-06-01 12:07:06,827 - anomaly_detection - INFO - Indexing 311 anomalies to security-anomalies
2025-06-01 12:07:06,861 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-06-01 12:07:06,862 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:07:06,862 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:10:08,956 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:10:08,956 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:10:09,050 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.094s]
2025-06-01 12:10:09,374 - anomaly_detection - INFO - Loaded 6192 records from Elasticsearch
2025-06-01 12:10:09,462 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:10:09,619 - anomaly_detection - INFO - Detected 307 anomalies
2025-06-01 12:10:09,634 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-06-01 12:10:09,677 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.010s]
2025-06-01 12:10:09,678 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:10:09,679 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:10:09,880 - anomaly_detection - INFO - Detected 310 anomalies
2025-06-01 12:10:09,880 - anomaly_detection - INFO - Indexing 310 anomalies to security-anomalies
2025-06-01 12:10:09,912 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 12:10:09,913 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:10:09,913 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:12:06,959 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:12:06,960 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:12:07,044 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.084s]
2025-06-01 12:12:07,348 - anomaly_detection - INFO - Loaded 6182 records from Elasticsearch
2025-06-01 12:12:07,421 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:12:07,522 - anomaly_detection - INFO - Detected 309 anomalies
2025-06-01 12:12:07,533 - anomaly_detection - INFO - Indexing 309 anomalies to security-anomalies
2025-06-01 12:12:07,560 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 12:12:07,561 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:12:07,562 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:12:07,723 - anomaly_detection - INFO - Detected 310 anomalies
2025-06-01 12:12:07,724 - anomaly_detection - INFO - Indexing 310 anomalies to security-anomalies
2025-06-01 12:12:07,754 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.010s]
2025-06-01 12:12:07,755 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:12:07,755 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:15:03,909 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 12:15:03,909 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 12:15:03,932 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.019s]
2025-06-01 12:15:04,005 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 12:15:04,039 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 12:15:04,043 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 12:15:04,044 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 12:15:04,044 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 12:15:04,047 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.001s]
2025-06-01 12:15:04,047 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 12:15:04,048 - risk_scoring - INFO - Calculating risk scores
2025-06-01 12:15:04,049 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 12:15:04,051 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 12:15:04,060 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.009s]
2025-06-01 12:15:04,060 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 12:15:04,060 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 12:15:10,011 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:15:10,011 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:15:10,103 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.092s]
2025-06-01 12:15:10,413 - anomaly_detection - INFO - Loaded 6174 records from Elasticsearch
2025-06-01 12:15:10,490 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:15:10,606 - anomaly_detection - INFO - Detected 308 anomalies
2025-06-01 12:15:10,618 - anomaly_detection - INFO - Indexing 308 anomalies to security-anomalies
2025-06-01 12:15:10,652 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.010s]
2025-06-01 12:15:10,652 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:15:10,653 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:15:10,825 - anomaly_detection - INFO - Detected 309 anomalies
2025-06-01 12:15:10,825 - anomaly_detection - INFO - Indexing 309 anomalies to security-anomalies
2025-06-01 12:15:10,853 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 12:15:10,853 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:15:10,854 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:16:22,638 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 12:16:22,638 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 12:16:22,664 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.021s]
2025-06-01 12:16:22,695 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 12:16:22,728 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 12:16:22,732 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 12:16:22,732 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 12:16:22,733 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 12:16:22,738 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-06-01 12:16:22,738 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 12:16:22,740 - risk_scoring - INFO - Calculating risk scores
2025-06-01 12:16:22,741 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 12:16:22,743 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 12:16:22,753 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.009s]
2025-06-01 12:16:22,754 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 12:16:22,754 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 12:17:07,855 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:17:07,855 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:17:07,956 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.100s]
2025-06-01 12:17:08,354 - anomaly_detection - INFO - Loaded 6182 records from Elasticsearch
2025-06-01 12:17:08,441 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:17:08,560 - anomaly_detection - INFO - Detected 310 anomalies
2025-06-01 12:17:08,572 - anomaly_detection - INFO - Indexing 310 anomalies to security-anomalies
2025-06-01 12:17:08,608 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.012s]
2025-06-01 12:17:08,609 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:17:08,610 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:17:08,786 - anomaly_detection - INFO - Detected 310 anomalies
2025-06-01 12:17:08,786 - anomaly_detection - INFO - Indexing 310 anomalies to security-anomalies
2025-06-01 12:17:08,819 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.010s]
2025-06-01 12:17:08,820 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:17:08,820 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:20:10,954 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:20:10,954 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:20:11,159 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.205s]
2025-06-01 12:20:11,574 - anomaly_detection - INFO - Loaded 6183 records from Elasticsearch
2025-06-01 12:20:11,661 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:20:11,777 - anomaly_detection - INFO - Detected 310 anomalies
2025-06-01 12:20:11,792 - anomaly_detection - INFO - Indexing 310 anomalies to security-anomalies
2025-06-01 12:20:11,823 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 12:20:11,824 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:20:11,825 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:20:12,002 - anomaly_detection - INFO - Detected 310 anomalies
2025-06-01 12:20:12,002 - anomaly_detection - INFO - Indexing 310 anomalies to security-anomalies
2025-06-01 12:20:12,036 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.011s]
2025-06-01 12:20:12,037 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:20:12,038 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:22:08,913 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:22:08,913 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:22:08,991 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.077s]
2025-06-01 12:22:09,290 - anomaly_detection - INFO - Loaded 6182 records from Elasticsearch
2025-06-01 12:22:09,372 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:22:09,489 - anomaly_detection - INFO - Detected 308 anomalies
2025-06-01 12:22:09,500 - anomaly_detection - INFO - Indexing 308 anomalies to security-anomalies
2025-06-01 12:22:09,529 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 12:22:09,529 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:22:09,530 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:22:09,689 - anomaly_detection - INFO - Detected 309 anomalies
2025-06-01 12:22:09,690 - anomaly_detection - INFO - Indexing 309 anomalies to security-anomalies
2025-06-01 12:22:09,716 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 12:22:09,717 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:22:09,717 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:25:12,134 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:25:12,135 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:25:12,235 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.100s]
2025-06-01 12:25:12,572 - anomaly_detection - INFO - Loaded 6213 records from Elasticsearch
2025-06-01 12:25:12,646 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:25:12,751 - anomaly_detection - INFO - Detected 311 anomalies
2025-06-01 12:25:12,762 - anomaly_detection - INFO - Indexing 311 anomalies to security-anomalies
2025-06-01 12:25:12,793 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 12:25:12,793 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:25:12,794 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:25:12,970 - anomaly_detection - INFO - Detected 307 anomalies
2025-06-01 12:25:12,970 - anomaly_detection - INFO - Indexing 307 anomalies to security-anomalies
2025-06-01 12:25:12,998 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 12:25:12,999 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:25:12,999 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:27:09,799 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:27:09,800 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:27:09,886 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.086s]
2025-06-01 12:27:10,286 - anomaly_detection - INFO - Loaded 6212 records from Elasticsearch
2025-06-01 12:27:10,397 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:27:10,517 - anomaly_detection - INFO - Detected 310 anomalies
2025-06-01 12:27:10,530 - anomaly_detection - INFO - Indexing 310 anomalies to security-anomalies
2025-06-01 12:27:10,566 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.011s]
2025-06-01 12:27:10,567 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:27:10,567 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:27:10,741 - anomaly_detection - INFO - Detected 308 anomalies
2025-06-01 12:27:10,741 - anomaly_detection - INFO - Indexing 308 anomalies to security-anomalies
2025-06-01 12:27:10,774 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 12:27:10,775 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:27:10,775 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:30:04,159 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 12:30:04,159 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 12:30:04,181 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.019s]
2025-06-01 12:30:04,207 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 12:30:04,239 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 12:30:04,243 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 12:30:04,243 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 12:30:04,244 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 12:30:04,247 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.001s]
2025-06-01 12:30:04,247 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 12:30:04,248 - risk_scoring - INFO - Calculating risk scores
2025-06-01 12:30:04,249 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 12:30:04,251 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 12:30:04,260 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.009s]
2025-06-01 12:30:04,260 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 12:30:04,260 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 12:30:13,098 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:30:13,098 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:30:13,177 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.079s]
2025-06-01 12:30:13,555 - anomaly_detection - INFO - Loaded 6236 records from Elasticsearch
2025-06-01 12:30:13,624 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:30:13,723 - anomaly_detection - INFO - Detected 312 anomalies
2025-06-01 12:30:13,733 - anomaly_detection - INFO - Indexing 312 anomalies to security-anomalies
2025-06-01 12:30:13,760 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 12:30:13,760 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:30:13,761 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:30:13,920 - anomaly_detection - INFO - Detected 311 anomalies
2025-06-01 12:30:13,920 - anomaly_detection - INFO - Indexing 311 anomalies to security-anomalies
2025-06-01 12:30:13,949 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 12:30:13,950 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:30:13,950 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:31:22,845 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 12:31:22,845 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 12:31:22,870 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.021s]
2025-06-01 12:31:22,896 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 12:31:22,936 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 12:31:22,940 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 12:31:22,940 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 12:31:22,941 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 12:31:22,945 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-06-01 12:31:22,946 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 12:31:22,948 - risk_scoring - INFO - Calculating risk scores
2025-06-01 12:31:22,951 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 12:31:22,954 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 12:31:22,964 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.010s]
2025-06-01 12:31:22,964 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 12:31:22,965 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 12:32:10,854 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:32:10,854 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:32:10,922 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.068s]
2025-06-01 12:32:11,300 - anomaly_detection - INFO - Loaded 6237 records from Elasticsearch
2025-06-01 12:32:11,392 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:32:11,495 - anomaly_detection - INFO - Detected 311 anomalies
2025-06-01 12:32:11,506 - anomaly_detection - INFO - Indexing 311 anomalies to security-anomalies
2025-06-01 12:32:11,534 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 12:32:11,535 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:32:11,535 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:32:11,698 - anomaly_detection - INFO - Detected 312 anomalies
2025-06-01 12:32:11,698 - anomaly_detection - INFO - Indexing 312 anomalies to security-anomalies
2025-06-01 12:32:11,724 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 12:32:11,725 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:32:11,725 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:35:14,005 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:35:14,005 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:35:14,076 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.070s]
2025-06-01 12:35:14,623 - anomaly_detection - INFO - Loaded 6253 records from Elasticsearch
2025-06-01 12:35:14,702 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:35:14,800 - anomaly_detection - INFO - Detected 313 anomalies
2025-06-01 12:35:14,810 - anomaly_detection - INFO - Indexing 313 anomalies to security-anomalies
2025-06-01 12:35:14,838 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 12:35:14,838 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:35:14,839 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:35:14,997 - anomaly_detection - INFO - Detected 313 anomalies
2025-06-01 12:35:14,998 - anomaly_detection - INFO - Indexing 313 anomalies to security-anomalies
2025-06-01 12:35:15,023 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 12:35:15,024 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:35:15,024 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:37:11,823 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:37:11,824 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:37:11,917 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.094s]
2025-06-01 12:37:12,244 - anomaly_detection - INFO - Loaded 6265 records from Elasticsearch
2025-06-01 12:37:12,351 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:37:12,452 - anomaly_detection - INFO - Detected 314 anomalies
2025-06-01 12:37:12,463 - anomaly_detection - INFO - Indexing 314 anomalies to security-anomalies
2025-06-01 12:37:12,489 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 12:37:12,490 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:37:12,491 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:37:12,652 - anomaly_detection - INFO - Detected 314 anomalies
2025-06-01 12:37:12,652 - anomaly_detection - INFO - Indexing 314 anomalies to security-anomalies
2025-06-01 12:37:12,678 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 12:37:12,679 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:37:12,679 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:40:15,122 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:40:15,145 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:40:15,615 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.417s]
2025-06-01 12:40:19,300 - anomaly_detection - INFO - Loaded 6282 records from Elasticsearch
2025-06-01 12:40:19,435 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:40:19,562 - anomaly_detection - INFO - Detected 315 anomalies
2025-06-01 12:40:19,574 - anomaly_detection - INFO - Indexing 315 anomalies to security-anomalies
2025-06-01 12:40:19,661 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.064s]
2025-06-01 12:40:19,667 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:40:19,667 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:40:19,839 - anomaly_detection - INFO - Detected 315 anomalies
2025-06-01 12:40:19,839 - anomaly_detection - INFO - Indexing 315 anomalies to security-anomalies
2025-06-01 12:40:19,894 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.034s]
2025-06-01 12:40:19,895 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:40:19,896 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:42:12,797 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:42:12,856 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:42:13,266 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.325s]
2025-06-01 12:42:17,429 - anomaly_detection - INFO - Loaded 6282 records from Elasticsearch
2025-06-01 12:42:17,608 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:42:17,719 - anomaly_detection - INFO - Detected 313 anomalies
2025-06-01 12:42:17,730 - anomaly_detection - INFO - Indexing 313 anomalies to security-anomalies
2025-06-01 12:42:17,773 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.017s]
2025-06-01 12:42:17,773 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:42:17,774 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:42:17,949 - anomaly_detection - INFO - Detected 315 anomalies
2025-06-01 12:42:17,949 - anomaly_detection - INFO - Indexing 315 anomalies to security-anomalies
2025-06-01 12:42:17,984 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.013s]
2025-06-01 12:42:17,985 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:42:17,985 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:45:04,350 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 12:45:04,351 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 12:45:04,500 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.133s]
2025-06-01 12:45:04,561 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 12:45:04,617 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 12:45:04,621 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.002s]
2025-06-01 12:45:04,622 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 12:45:04,622 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 12:45:04,628 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.003s]
2025-06-01 12:45:04,628 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 12:45:04,629 - risk_scoring - INFO - Calculating risk scores
2025-06-01 12:45:04,630 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 12:45:04,632 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 12:45:04,646 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.013s]
2025-06-01 12:45:04,646 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 12:45:04,646 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 12:45:19,996 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:45:19,996 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:45:20,066 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.069s]
2025-06-01 12:45:20,379 - anomaly_detection - INFO - Loaded 6286 records from Elasticsearch
2025-06-01 12:45:20,469 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:45:20,575 - anomaly_detection - INFO - Detected 315 anomalies
2025-06-01 12:45:20,586 - anomaly_detection - INFO - Indexing 315 anomalies to security-anomalies
2025-06-01 12:45:20,617 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.011s]
2025-06-01 12:45:20,618 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:45:20,618 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:45:20,788 - anomaly_detection - INFO - Detected 315 anomalies
2025-06-01 12:45:20,788 - anomaly_detection - INFO - Indexing 315 anomalies to security-anomalies
2025-06-01 12:45:20,821 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.012s]
2025-06-01 12:45:20,822 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:45:20,822 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:46:23,084 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 12:46:23,085 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 12:46:23,433 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.337s]
2025-06-01 12:46:23,559 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 12:46:23,614 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 12:46:23,623 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.005s]
2025-06-01 12:46:23,623 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 12:46:23,624 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 12:46:23,634 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.006s]
2025-06-01 12:46:23,635 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 12:46:23,635 - risk_scoring - INFO - Calculating risk scores
2025-06-01 12:46:23,637 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 12:46:23,640 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 12:46:23,708 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.067s]
2025-06-01 12:46:23,708 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 12:46:23,708 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 12:47:18,103 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:47:18,104 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:47:18,162 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.057s]
2025-06-01 12:47:18,469 - anomaly_detection - INFO - Loaded 6306 records from Elasticsearch
2025-06-01 12:47:18,561 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:47:18,669 - anomaly_detection - INFO - Detected 316 anomalies
2025-06-01 12:47:18,680 - anomaly_detection - INFO - Indexing 316 anomalies to security-anomalies
2025-06-01 12:47:18,718 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.016s]
2025-06-01 12:47:18,720 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:47:18,720 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:47:18,889 - anomaly_detection - INFO - Detected 315 anomalies
2025-06-01 12:47:18,889 - anomaly_detection - INFO - Indexing 315 anomalies to security-anomalies
2025-06-01 12:47:18,917 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 12:47:18,918 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:47:18,918 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:50:20,882 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:50:20,883 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:50:20,943 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.059s]
2025-06-01 12:50:21,359 - anomaly_detection - INFO - Loaded 6288 records from Elasticsearch
2025-06-01 12:50:21,442 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:50:21,547 - anomaly_detection - INFO - Detected 313 anomalies
2025-06-01 12:50:21,559 - anomaly_detection - INFO - Indexing 313 anomalies to security-anomalies
2025-06-01 12:50:21,591 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 12:50:21,592 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:50:21,592 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:50:21,763 - anomaly_detection - INFO - Detected 313 anomalies
2025-06-01 12:50:21,763 - anomaly_detection - INFO - Indexing 313 anomalies to security-anomalies
2025-06-01 12:50:21,804 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.017s]
2025-06-01 12:50:21,805 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:50:21,805 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:52:19,004 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:52:19,004 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:52:19,055 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.050s]
2025-06-01 12:52:19,398 - anomaly_detection - INFO - Loaded 6074 records from Elasticsearch
2025-06-01 12:52:19,473 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:52:19,577 - anomaly_detection - INFO - Detected 304 anomalies
2025-06-01 12:52:19,588 - anomaly_detection - INFO - Indexing 304 anomalies to security-anomalies
2025-06-01 12:52:19,618 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.009s]
2025-06-01 12:52:19,619 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:52:19,619 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:52:19,775 - anomaly_detection - INFO - Detected 301 anomalies
2025-06-01 12:52:19,775 - anomaly_detection - INFO - Indexing 301 anomalies to security-anomalies
2025-06-01 12:52:19,803 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 12:52:19,804 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:52:19,804 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:55:21,872 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:55:21,873 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:55:21,921 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.048s]
2025-06-01 12:55:22,214 - anomaly_detection - INFO - Loaded 5760 records from Elasticsearch
2025-06-01 12:55:22,287 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:55:22,387 - anomaly_detection - INFO - Detected 288 anomalies
2025-06-01 12:55:22,397 - anomaly_detection - INFO - Indexing 288 anomalies to security-anomalies
2025-06-01 12:55:22,423 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 12:55:22,424 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:55:22,424 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:55:22,567 - anomaly_detection - INFO - Detected 288 anomalies
2025-06-01 12:55:22,567 - anomaly_detection - INFO - Indexing 288 anomalies to security-anomalies
2025-06-01 12:55:22,593 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 12:55:22,594 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:55:22,594 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 12:57:19,904 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 12:57:19,904 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 12:57:19,962 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.058s]
2025-06-01 12:57:20,298 - anomaly_detection - INFO - Loaded 5558 records from Elasticsearch
2025-06-01 12:57:20,381 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 12:57:20,496 - anomaly_detection - INFO - Detected 275 anomalies
2025-06-01 12:57:20,508 - anomaly_detection - INFO - Indexing 275 anomalies to security-anomalies
2025-06-01 12:57:20,542 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.013s]
2025-06-01 12:57:20,543 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:57:20,543 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 12:57:20,693 - anomaly_detection - INFO - Detected 274 anomalies
2025-06-01 12:57:20,694 - anomaly_detection - INFO - Indexing 274 anomalies to security-anomalies
2025-06-01 12:57:20,720 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 12:57:20,721 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 12:57:20,721 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 13:00:04,745 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 13:00:04,746 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 13:00:04,853 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.099s]
2025-06-01 13:00:04,896 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 13:00:04,945 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 13:00:04,950 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 13:00:04,950 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 13:00:04,951 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 13:00:04,955 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.001s]
2025-06-01 13:00:04,955 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 13:00:04,955 - risk_scoring - INFO - Calculating risk scores
2025-06-01 13:00:04,956 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 13:00:04,958 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 13:00:04,967 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.009s]
2025-06-01 13:00:04,967 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 13:00:04,967 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 13:00:22,684 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 13:00:22,685 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 13:00:22,730 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.045s]
2025-06-01 13:00:23,055 - anomaly_detection - INFO - Loaded 5255 records from Elasticsearch
2025-06-01 13:00:23,122 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 13:00:23,220 - anomaly_detection - INFO - Detected 262 anomalies
2025-06-01 13:00:23,229 - anomaly_detection - INFO - Indexing 262 anomalies to security-anomalies
2025-06-01 13:00:23,255 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.007s]
2025-06-01 13:00:23,256 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 13:00:23,256 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 13:00:23,377 - anomaly_detection - INFO - Detected 263 anomalies
2025-06-01 13:00:23,378 - anomaly_detection - INFO - Indexing 263 anomalies to security-anomalies
2025-06-01 13:00:23,402 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 13:00:23,403 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 13:00:23,403 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 13:01:23,809 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 13:01:23,810 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 13:01:23,940 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.113s]
2025-06-01 13:01:24,005 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 13:01:24,057 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 13:01:24,062 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.001s]
2025-06-01 13:01:24,062 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 13:01:24,062 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 13:01:24,066 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.001s]
2025-06-01 13:01:24,066 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 13:01:24,067 - risk_scoring - INFO - Calculating risk scores
2025-06-01 13:01:24,068 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 13:01:24,070 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 13:01:24,081 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.011s]
2025-06-01 13:01:24,081 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 13:01:24,082 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 13:02:20,784 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 13:02:20,785 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 13:02:20,847 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.062s]
2025-06-01 13:02:21,221 - anomaly_detection - INFO - Loaded 5054 records from Elasticsearch
2025-06-01 13:02:21,307 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 13:02:21,410 - anomaly_detection - INFO - Detected 252 anomalies
2025-06-01 13:02:21,419 - anomaly_detection - INFO - Indexing 252 anomalies to security-anomalies
2025-06-01 13:02:21,444 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 13:02:21,444 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 13:02:21,444 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 13:02:21,572 - anomaly_detection - INFO - Detected 253 anomalies
2025-06-01 13:02:21,572 - anomaly_detection - INFO - Indexing 253 anomalies to security-anomalies
2025-06-01 13:02:21,597 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 13:02:21,597 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 13:02:21,598 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 13:05:23,491 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 13:05:23,492 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 13:05:23,538 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.046s]
2025-06-01 13:05:23,854 - anomaly_detection - INFO - Loaded 4750 records from Elasticsearch
2025-06-01 13:05:23,920 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 13:05:24,033 - anomaly_detection - INFO - Detected 236 anomalies
2025-06-01 13:05:24,043 - anomaly_detection - INFO - Indexing 236 anomalies to security-anomalies
2025-06-01 13:05:24,068 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 13:05:24,069 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 13:05:24,069 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 13:05:24,184 - anomaly_detection - INFO - Detected 238 anomalies
2025-06-01 13:05:24,184 - anomaly_detection - INFO - Indexing 238 anomalies to security-anomalies
2025-06-01 13:05:24,208 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 13:05:24,209 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 13:05:24,209 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 13:07:21,698 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 13:07:21,698 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 13:07:21,747 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.048s]
2025-06-01 13:07:21,949 - anomaly_detection - INFO - Loaded 4548 records from Elasticsearch
2025-06-01 13:07:22,006 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 13:07:22,101 - anomaly_detection - INFO - Detected 226 anomalies
2025-06-01 13:07:22,108 - anomaly_detection - INFO - Indexing 226 anomalies to security-anomalies
2025-06-01 13:07:22,131 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.008s]
2025-06-01 13:07:22,132 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 13:07:22,132 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 13:07:22,224 - anomaly_detection - INFO - Detected 227 anomalies
2025-06-01 13:07:22,224 - anomaly_detection - INFO - Indexing 227 anomalies to security-anomalies
2025-06-01 13:07:22,245 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 13:07:22,245 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 13:07:22,246 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 13:10:24,308 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 13:10:24,309 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 13:10:24,357 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.048s]
2025-06-01 13:10:24,583 - anomaly_detection - INFO - Loaded 4245 records from Elasticsearch
2025-06-01 13:10:24,640 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 13:10:24,740 - anomaly_detection - INFO - Detected 213 anomalies
2025-06-01 13:10:24,748 - anomaly_detection - INFO - Indexing 213 anomalies to security-anomalies
2025-06-01 13:10:24,769 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.006s]
2025-06-01 13:10:24,770 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 13:10:24,770 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 13:10:24,857 - anomaly_detection - INFO - Detected 209 anomalies
2025-06-01 13:10:24,858 - anomaly_detection - INFO - Indexing 209 anomalies to security-anomalies
2025-06-01 13:10:24,877 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-06-01 13:10:24,877 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 13:10:24,878 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 13:12:22,346 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 13:12:22,346 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 13:12:22,383 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.037s]
2025-06-01 13:12:22,605 - anomaly_detection - INFO - Loaded 4043 records from Elasticsearch
2025-06-01 13:12:22,655 - anomaly_detection - INFO - Detecting anomalies using isolation_forest with contamination 0.05
2025-06-01 13:12:22,745 - anomaly_detection - INFO - Detected 200 anomalies
2025-06-01 13:12:22,752 - anomaly_detection - INFO - Indexing 200 anomalies to security-anomalies
2025-06-01 13:12:22,778 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.011s]
2025-06-01 13:12:22,779 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 13:12:22,779 - anomaly_detection - INFO - Detecting anomalies using local_outlier_factor with contamination 0.05
2025-06-01 13:12:22,854 - anomaly_detection - INFO - Detected 202 anomalies
2025-06-01 13:12:22,855 - anomaly_detection - INFO - Indexing 202 anomalies to security-anomalies
2025-06-01 13:12:22,873 - elastic_transport.transport - INFO - POST http://localhost:9200/_bulk [status:200 duration:0.005s]
2025-06-01 13:12:22,874 - anomaly_detection - INFO - Successfully indexed all anomalies
2025-06-01 13:12:22,874 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 13:12:59,393 - __main__ - INFO - Server shutting down gracefully...
2025-06-01 16:21:02,725 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 16:21:02,729 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 16:21:03,000 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.223s]
2025-06-01 16:21:03,095 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 16:21:03,342 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 16:21:03,349 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.003s]
2025-06-01 16:21:03,349 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 16:21:03,350 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 16:21:03,355 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.002s]
2025-06-01 16:21:03,355 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 16:21:03,357 - risk_scoring - INFO - Calculating risk scores
2025-06-01 16:21:03,364 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 16:21:03,376 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 16:21:03,405 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.028s]
2025-06-01 16:21:03,406 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 16:21:03,406 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 16:21:22,630 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 16:21:22,630 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 16:21:22,636 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.005s]
2025-06-01 16:21:22,636 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-06-01 16:21:22,637 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-06-01 16:21:22,642 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
2025-06-01 16:22:21,838 - risk_scoring - INFO - Starting risk scoring cycle
2025-06-01 16:22:21,852 - risk_scoring - INFO - Loading anomalies from security-anomalies for the last 1d
2025-06-01 16:22:22,091 - elastic_transport.transport - INFO - POST http://localhost:9200/security-anomalies/_search [status:200 duration:0.208s]
2025-06-01 16:22:22,176 - risk_scoring - INFO - Loaded 10000 anomalies from Elasticsearch
2025-06-01 16:22:22,426 - risk_scoring - INFO - Loading vulnerabilities from security-vulnerabilities for the last 7d
2025-06-01 16:22:22,434 - elastic_transport.transport - INFO - POST http://localhost:9200/security-vulnerabilities/_search [status:404 duration:0.003s]
2025-06-01 16:22:22,435 - risk_scoring - ERROR - Error loading vulnerabilities from Elasticsearch: NotFoundError(404, 'index_not_found_exception', 'no such index [security-vulnerabilities]', security-vulnerabilities, index_or_alias)
2025-06-01 16:22:22,436 - risk_scoring - INFO - Loading compliance issues from security-compliance for the last 7d
2025-06-01 16:22:22,445 - elastic_transport.transport - INFO - POST http://localhost:9200/security-compliance/_search [status:200 duration:0.003s]
2025-06-01 16:22:22,445 - risk_scoring - INFO - Loaded 0 compliance issues from Elasticsearch
2025-06-01 16:22:22,446 - risk_scoring - INFO - Calculating risk scores
2025-06-01 16:22:22,448 - risk_scoring - INFO - Calculating risk scores for 1 assets
2025-06-01 16:22:22,452 - risk_scoring - INFO - Indexing 1 risk scores to security-risk-scores
2025-06-01 16:22:22,473 - elastic_transport.transport - INFO - PUT http://localhost:9200/_bulk?refresh=true [status:200 duration:0.020s]
2025-06-01 16:22:22,474 - risk_scoring - INFO - Successfully indexed 1 risk scores, errors: []
2025-06-01 16:22:22,474 - risk_scoring - INFO - Risk scoring cycle completed, sleeping for 15 minutes
2025-06-01 16:23:20,620 - anomaly_detection - INFO - Starting anomaly detection cycle
2025-06-01 16:23:20,620 - anomaly_detection - INFO - Loading data from metricbeat-* for the last 1h
2025-06-01 16:23:20,624 - elastic_transport.transport - INFO - POST http://localhost:9200/metricbeat-*/_search [status:200 duration:0.004s]
2025-06-01 16:23:20,624 - anomaly_detection - INFO - Loaded 0 records from Elasticsearch
2025-06-01 16:23:20,625 - anomaly_detection - WARNING - No data found in metricbeat-* for the last 1h
2025-06-01 16:23:20,630 - anomaly_detection - INFO - Anomaly detection cycle completed, sleeping for 5 minutes
